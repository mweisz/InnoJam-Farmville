<!DOCTYPE html><html><head><title>Coverage</title><script>

headings = [];

onload = function(){
  headings = document.querySelectorAll('h2');
};

onscroll = function(e){
  var heading = find(window.scrollY);
  if (!heading) return;
  var links = document.querySelectorAll('#menu a')
    , link;

  for (var i = 0, len = links.length; i < len; ++i) {
    link = links[i];
    link.className = link.getAttribute('href') == '#' + heading.id
      ? 'active'
      : '';
  }
};

function find(y) {
  var i = headings.length
    , heading;

  while (i--) {
    heading = headings[i];
    if (y >= heading.offsetTop) {
      return heading;
    }
  }
}
</script>
<style>

body {
  font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
  color: #2C2C2C;
  border-top: 2px solid #ddd;
}

#coverage {
  padding: 60px;
}

h1 a {
  color: inherit;
  font-weight: inherit;
}

h1 a:hover {
  text-decoration: none;
}

.onload h1 {
  opacity: 1;
}

h2 {
  width: 80%;
  margin-top: 80px;
  margin-bottom: 0;
  font-weight: 100;
  letter-spacing: 1px;
  border-bottom: 1px solid #eee;
}

a {
  color: #8A6343;
  font-weight: bold;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

ul {
  margin-top: 20px;
  padding: 0 15px;
  width: 100%;
}

ul li {
  float: left;
  width: 40%;
  margin-top: 5px;
  margin-right: 60px;
  list-style: none;
  border-bottom: 1px solid #eee;
  padding: 5px 0;
  font-size: 12px;
}

ul::after {
  content: '.';
  height: 0;
  display: block;
  visibility: hidden;
  clear: both;
}

code {
  font: 12px monaco, monospace;
}

pre {
  margin: 30px;
  padding: 30px;
  border: 1px solid #eee;
  border-bottom-color: #ddd;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 0 10px #eee;
  -moz-box-shadow: inset 0 0 10px #eee;
  box-shadow: inset 0 0 10px #eee;
  overflow-x: auto;
}

img {
  margin: 30px;
  padding: 1px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  max-width: 100%;
}

footer {
  background: #eee;
  width: 100%;
  padding: 50px 0;
  text-align: right;
  border-top: 1px solid #ddd;
}

footer span {
  display: block;
  margin-right: 30px;
  color: #888;
  font-size: 12px;
}

#menu {
  position: fixed;
  font-size: 12px;
  overflow-y: auto;
  top: 0;
  right: 0;
  margin: 0;
  height: 100%;
  padding: 15px 0;
  text-align: right;
  border-left: 1px solid #eee;
  -moz-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-font-smoothing: antialiased;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#menu::after {
  display: block;
  content: '';
  padding-top: 80px;
}

#logo {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(255,255,255,.1);
  font-size: 11px;
  display: block;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  -webkit-border-radius: 20px;
  -moz-border-radius: 20px;
  border-radius: 20px;
  -webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
  -moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
  box-shadow: 0 0 3px rgba(0,0,0,.2);
  color: inherit;
}

#menu li a {
  display: block;
  color: white;
  padding: 0 35px 0 25px;
  -webkit-transition: background 300ms;
  -moz-transition: background 300ms;
}

#menu li {
  position: relative;
  list-style: none;
}

#menu a:hover,
#menu a.active {
  text-decoration: none;
  background: rgba(255,255,255,.1);
}

#menu li:hover .cov {
  opacity: 1;
}

#menu li .dirname {
  opacity: .60;
  padding-right: 2px;
}

#menu li .basename {
  opacity: 1;
}

#menu .cov {
  background: rgba(0,0,0,.4);
  position: absolute;
  top: 0;
  right: 8px;
  font-size: 9px;
  opacity: .6;
  text-align: left;
  width: 17px;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  border-radius: 10px;
  padding: 2px 3px;
  text-align: center;
}

#stats:nth-child(2n) {
  display: inline-block;
  margin-top: 15px;
  border: 1px solid #eee;
  padding: 10px;
  -webkit-box-shadow: inset 0 0 2px #eee;
  -moz-box-shadow: inset 0 0 2px #eee;
  box-shadow: inset 0 0 2px #eee;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
}

#stats div {
  float: left;
  padding: 0 5px;
}

#stats::after {
  display: block;
  content: '';
  clear: both;
}

#stats .sloc::after {
  content: ' SLOC';
  color: #b6b6b6;
}

#stats .percentage::after {
  content: ' coverage';
  color: #b6b6b6;
}

#stats .hits,
#stats .misses {
  display: none;
}

.high {
  color: #00d4b4;
}
.medium {
  color: #e87d0d;
}
.low {
  color: #d4081a;
}
.terrible {
  color: #d4081a;
  font-weight: bold;
}

table {
  width: 80%;
  margin-top: 10px;
  border-collapse: collapse;
  border: 1px solid #cbcbcb;
  color: #363636;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}

table thead {
  display: none;
}

table td.line,
table td.hits {
  width: 20px;
  background: #eaeaea;
  text-align: center;
  font-size: 11px;
  padding: 0 10px;
  color: #949494;
}

table td.hits {
  width: 10px;
  padding: 2px 5px;
  color: rgba(0,0,0,.2);
  background: #f0f0f0;
}

tr.miss td.line,
tr.miss td.hits {
  background: #e6c3c7;
}

tr.miss td {
  background: #f8d5d8;
}

td.source {
  padding-left: 15px;
  line-height: 15px;
  white-space: pre;
  font: 12px monaco, monospace;
}

code .comment { color: #ddd }
code .init { color: #2F6FAD }
code .string { color: #5890AD }
code .keyword { color: #8A6343 }
code .number { color: #2F6FAD }
</style></head><body><div id="coverage"><h1 id="overview">Coverage</h1><div id="menu"><li><a href="#overview">overview</a></li><li><span class="cov high">100</span><a href="#Client.js"><span class="basename">Client.js</span></a></li><li><span class="cov high">81</span><a href="#index.js"><span class="basename">index.js</span></a></li><li><span class="cov high">83</span><a href="#protocol/Connection.js"><span class="dirname">protocol/</span><span class="basename">Connection.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/ExecuteTask.js"><span class="dirname">protocol/</span><span class="basename">ExecuteTask.js</span></a></li><li><span class="cov high">82</span><a href="#protocol/Lob.js"><span class="dirname">protocol/</span><span class="basename">Lob.js</span></a></li><li><span class="cov high">87</span><a href="#protocol/Parser.js"><span class="dirname">protocol/</span><span class="basename">Parser.js</span></a></li><li><span class="cov high">96</span><a href="#protocol/Reader.js"><span class="dirname">protocol/</span><span class="basename">Reader.js</span></a></li><li><span class="cov medium">74</span><a href="#protocol/Result.js"><span class="dirname">protocol/</span><span class="basename">Result.js</span></a></li><li><span class="cov high">77</span><a href="#protocol/ResultSet.js"><span class="dirname">protocol/</span><span class="basename">ResultSet.js</span></a></li><li><span class="cov high">90</span><a href="#protocol/ResultSetTransform.js"><span class="dirname">protocol/</span><span class="basename">ResultSetTransform.js</span></a></li><li><span class="cov high">76</span><a href="#protocol/Statement.js"><span class="dirname">protocol/</span><span class="basename">Statement.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/Stringifier.js"><span class="dirname">protocol/</span><span class="basename">Stringifier.js</span></a></li><li><span class="cov high">94</span><a href="#protocol/Transaction.js"><span class="dirname">protocol/</span><span class="basename">Transaction.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/Writer.js"><span class="dirname">protocol/</span><span class="basename">Writer.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/auth/Manager.js"><span class="dirname">protocol/auth/</span><span class="basename">Manager.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/auth/SAML.js"><span class="dirname">protocol/auth/</span><span class="basename">SAML.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/auth/SCRAMSHA256.js"><span class="dirname">protocol/auth/</span><span class="basename">SCRAMSHA256.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/auth/SessionCookie.js"><span class="dirname">protocol/auth/</span><span class="basename">SessionCookie.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/auth/index.js"><span class="dirname">protocol/auth/</span><span class="basename">index.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ClientDistributionMode.js"><span class="dirname">protocol/common/</span><span class="basename">ClientDistributionMode.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/CommandOption.js"><span class="dirname">protocol/common/</span><span class="basename">CommandOption.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/CommitOption.js"><span class="dirname">protocol/common/</span><span class="basename">CommitOption.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ConnectOption.js"><span class="dirname">protocol/common/</span><span class="basename">ConnectOption.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ConnectOptionType.js"><span class="dirname">protocol/common/</span><span class="basename">ConnectOptionType.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/Constants.js"><span class="dirname">protocol/common/</span><span class="basename">Constants.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/DataFormatVersion.js"><span class="dirname">protocol/common/</span><span class="basename">DataFormatVersion.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/DistributionProtocolVersion.js"><span class="dirname">protocol/common/</span><span class="basename">DistributionProtocolVersion.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ErrorLevel.js"><span class="dirname">protocol/common/</span><span class="basename">ErrorLevel.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/FunctionCode.js"><span class="dirname">protocol/common/</span><span class="basename">FunctionCode.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/IoType.js"><span class="dirname">protocol/common/</span><span class="basename">IoType.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/LobOptions.js"><span class="dirname">protocol/common/</span><span class="basename">LobOptions.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/LobSourceType.js"><span class="dirname">protocol/common/</span><span class="basename">LobSourceType.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/MessageType.js"><span class="dirname">protocol/common/</span><span class="basename">MessageType.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/NormalizedTypeCode.js"><span class="dirname">protocol/common/</span><span class="basename">NormalizedTypeCode.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ParameterMode.js"><span class="dirname">protocol/common/</span><span class="basename">ParameterMode.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/PartKind.js"><span class="dirname">protocol/common/</span><span class="basename">PartKind.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ReadFunction.js"><span class="dirname">protocol/common/</span><span class="basename">ReadFunction.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/ResultSetAttributes.js"><span class="dirname">protocol/common/</span><span class="basename">ResultSetAttributes.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/SegmentKind.js"><span class="dirname">protocol/common/</span><span class="basename">SegmentKind.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/SessionContext.js"><span class="dirname">protocol/common/</span><span class="basename">SessionContext.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/StatementContext.js"><span class="dirname">protocol/common/</span><span class="basename">StatementContext.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/StatementContextType.js"><span class="dirname">protocol/common/</span><span class="basename">StatementContextType.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/TopologyInformation.js"><span class="dirname">protocol/common/</span><span class="basename">TopologyInformation.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/TransactionFlag.js"><span class="dirname">protocol/common/</span><span class="basename">TransactionFlag.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/TypeCode.js"><span class="dirname">protocol/common/</span><span class="basename">TypeCode.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/common/index.js"><span class="dirname">protocol/common/</span><span class="basename">index.js</span></a></li><li><span class="cov high">94</span><a href="#protocol/data/Binary.js"><span class="dirname">protocol/data/</span><span class="basename">Binary.js</span></a></li><li><span class="cov high">93</span><a href="#protocol/data/Default.js"><span class="dirname">protocol/data/</span><span class="basename">Default.js</span></a></li><li><span class="cov high">89</span><a href="#protocol/data/Fields.js"><span class="dirname">protocol/data/</span><span class="basename">Fields.js</span></a></li><li><span class="cov high">96</span><a href="#protocol/data/Int32.js"><span class="dirname">protocol/data/</span><span class="basename">Int32.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/data/MultilineOptions.js"><span class="dirname">protocol/data/</span><span class="basename">MultilineOptions.js</span></a></li><li><span class="cov high">95</span><a href="#protocol/data/Options.js"><span class="dirname">protocol/data/</span><span class="basename">Options.js</span></a></li><li><span class="cov high">89</span><a href="#protocol/data/ParameterMetadata.js"><span class="dirname">protocol/data/</span><span class="basename">ParameterMetadata.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/data/Parameters.js"><span class="dirname">protocol/data/</span><span class="basename">Parameters.js</span></a></li><li><span class="cov high">86</span><a href="#protocol/data/ReadLobReply.js"><span class="dirname">protocol/data/</span><span class="basename">ReadLobReply.js</span></a></li><li><span class="cov high">97</span><a href="#protocol/data/ReadLobRequest.js"><span class="dirname">protocol/data/</span><span class="basename">ReadLobRequest.js</span></a></li><li><span class="cov high">91</span><a href="#protocol/data/ResultSetMetadata.js"><span class="dirname">protocol/data/</span><span class="basename">ResultSetMetadata.js</span></a></li><li><span class="cov high">92</span><a href="#protocol/data/SqlError.js"><span class="dirname">protocol/data/</span><span class="basename">SqlError.js</span></a></li><li><span class="cov high">94</span><a href="#protocol/data/Text.js"><span class="dirname">protocol/data/</span><span class="basename">Text.js</span></a></li><li><span class="cov high">88</span><a href="#protocol/data/Text20.js"><span class="dirname">protocol/data/</span><span class="basename">Text20.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/data/TransactionFlags.js"><span class="dirname">protocol/data/</span><span class="basename">TransactionFlags.js</span></a></li><li><span class="cov high">92</span><a href="#protocol/data/WriteLobReply.js"><span class="dirname">protocol/data/</span><span class="basename">WriteLobReply.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/data/index.js"><span class="dirname">protocol/data/</span><span class="basename">index.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/index.js"><span class="dirname">protocol/</span><span class="basename">index.js</span></a></li><li><span class="cov high">95</span><a href="#protocol/part/AbstractOptions.js"><span class="dirname">protocol/part/</span><span class="basename">AbstractOptions.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/part/ConnectOptions.js"><span class="dirname">protocol/part/</span><span class="basename">ConnectOptions.js</span></a></li><li><span class="cov high">75</span><a href="#protocol/part/StatementContext.js"><span class="dirname">protocol/part/</span><span class="basename">StatementContext.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/part/index.js"><span class="dirname">protocol/part/</span><span class="basename">index.js</span></a></li><li><span class="cov high">98</span><a href="#protocol/reply/Part.js"><span class="dirname">protocol/reply/</span><span class="basename">Part.js</span></a></li><li><span class="cov high">89</span><a href="#protocol/reply/Segment.js"><span class="dirname">protocol/reply/</span><span class="basename">Segment.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/reply/index.js"><span class="dirname">protocol/reply/</span><span class="basename">index.js</span></a></li><li><span class="cov high">100</span><a href="#protocol/request/Part.js"><span class="dirname">protocol/request/</span><span class="basename">Part.js</span></a></li><li><span class="cov high">89</span><a href="#protocol/request/Segment.js"><span class="dirname">protocol/request/</span><span class="basename">Segment.js</span></a></li><li><span class="cov high">95</span><a href="#protocol/request/index.js"><span class="dirname">protocol/request/</span><span class="basename">index.js</span></a></li><li><span class="cov high">91</span><a href="#protocol/tcp.js"><span class="dirname">protocol/</span><span class="basename">tcp.js</span></a></li><li><span class="cov high">86</span><a href="#util/Queue.js"><span class="dirname">util/</span><span class="basename">Queue.js</span></a></li><li><span class="cov high">95</span><a href="#util/bignum.js"><span class="dirname">util/</span><span class="basename">bignum.js</span></a></li><li><span class="cov high">100</span><a href="#util/calendar.js"><span class="dirname">util/</span><span class="basename">calendar.js</span></a></li><li><span class="cov high">83</span><a href="#util/index.js"><span class="dirname">util/</span><span class="basename">index.js</span></a></li><li><span class="cov high">100</span><a href="#util/zeropad.js"><span class="dirname">util/</span><span class="basename">zeropad.js</span></a></li><a id="logo" href="http://visionmedia.github.io/mocha/">m</a></div><div id="stats" class="high"><div class="percentage">92%</div><div class="sloc">4212</div><div class="hits">3896</div><div class="misses">316</div></div><div id="files"><div class="file"><h2 id="Client.js">Client.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">156</div><div class="hits">156</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('./util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var protocol = require('./protocol');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var Connection = protocol.Connection;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var Result = protocol.Result;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var Statement = protocol.Statement;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">module.exports = Client;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">util.inherits(Client, EventEmitter);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">function Client(options) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">26</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">26</td><td class="source">  this._settings = util.extend({</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    fetchSize: 1024,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">    holdCursorsOverCommit: true,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    scrollableCursor: true,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    autoReconnect: false</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  }, options);</td></tr><tr class="hit"><td class="line">36</td><td class="hits">26</td><td class="source">  this._connection = this._createConnection(this._settings);</td></tr><tr class="hit"><td class="line">37</td><td class="hits">26</td><td class="source">  this._addListeners(this._connection);</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">Object.defineProperties(Client.prototype, {</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  connectOptions: {</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    get: function getConnectOptions() {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">      return this._connection.connectOptions;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  clientId: {</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    get: function getClientId() {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">      return this._connection.clientId;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  readyState: {</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">    get: function getreadyState() {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">2</td><td class="source">      return this._connection.readyState;</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">Client.prototype.setAutoCommit = function setAutoCommit(autoCommit) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">  this._connection.autoCommit = autoCommit;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">Client.prototype.commit = function commit(cb) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">3</td><td class="source">  function done(err, reply) {</td></tr><tr class="hit"><td class="line">64</td><td class="hits">3</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">65</td><td class="hits">3</td><td class="source">      if (err) {</td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">        return cb(err);</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">68</td><td class="hits">2</td><td class="source">      if (!reply.transactionFlags.committed) {</td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">        err = new Error('Commit has not been confirmed by the server');</td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">        err.code = 'EHDBCOMMIT';</td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">        return cb(err);</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">      cb(null);</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">76</td><td class="hits">3</td><td class="source">  this._connection.commit(done);</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">79</td><td class="hits">1</td><td class="source">Client.prototype.rollback = function rollback(cb) {</td></tr><tr class="hit"><td class="line">80</td><td class="hits">3</td><td class="source">  function done(err, reply) {</td></tr><tr class="hit"><td class="line">81</td><td class="hits">3</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">82</td><td class="hits">3</td><td class="source">      if (err) {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">        return cb(err);</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">85</td><td class="hits">2</td><td class="source">      if (!reply.transactionFlags.rolledBack) {</td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">        err = new Error('Rollback has not been confirmed by the server');</td></tr><tr class="hit"><td class="line">87</td><td class="hits">1</td><td class="source">        err.code = 'EHDBROLLBACK';</td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">        return cb(err);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">90</td><td class="hits">1</td><td class="source">      cb(null);</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">93</td><td class="hits">3</td><td class="source">  this._connection.rollback(done);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">96</td><td class="hits">1</td><td class="source">Client.prototype.get = function (key) {</td></tr><tr class="hit"><td class="line">97</td><td class="hits">5</td><td class="source">  if (util.isUndefined(key)) {</td></tr><tr class="hit"><td class="line">98</td><td class="hits">1</td><td class="source">    return this._settings;</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">100</td><td class="hits">4</td><td class="source">  return this._settings[key];</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">Client.prototype.set = function (key, value) {</td></tr><tr class="hit"><td class="line">104</td><td class="hits">2</td><td class="source">  if (!value &amp;&amp; util.isObject(key)) {</td></tr><tr class="hit"><td class="line">105</td><td class="hits">1</td><td class="source">    this._settings = util.extend(this._settings, key);</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">107</td><td class="hits">1</td><td class="source">    this._settings[key] = value;</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">109</td><td class="hits">2</td><td class="source">  return this;</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">112</td><td class="hits">1</td><td class="source">Client.prototype.connect = function connect(options, cb) {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">11</td><td class="source">  if (util.isFunction(options)) {</td></tr><tr class="hit"><td class="line">114</td><td class="hits">9</td><td class="source">    cb = options;</td></tr><tr class="hit"><td class="line">115</td><td class="hits">9</td><td class="source">    options = {};</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">118</td><td class="hits">11</td><td class="source">  var settings = this._settings;</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">120</td><td class="hits">11</td><td class="source">  function addOption(name) {</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">122</td><td class="hits">121</td><td class="source">    if (name in settings) {</td></tr><tr class="hit"><td class="line">123</td><td class="hits">23</td><td class="source">      this[name] = settings[name];</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">127</td><td class="hits">11</td><td class="source">  var openOptions = {</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">    host: settings.host,</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">    port: settings.port</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">131</td><td class="hits">11</td><td class="source">  ['pfx', 'key', 'cert', 'ca', 'passphrase', 'rejectUnauthorized',</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">    'secureProtocol'</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  ].forEach(addOption, openOptions);</td></tr><tr class="hit"><td class="line">134</td><td class="hits">11</td><td class="source">  util.extend(openOptions, options);</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">136</td><td class="hits">11</td><td class="source">  var connectOptions = {};</td></tr><tr class="hit"><td class="line">137</td><td class="hits">11</td><td class="source">  ['user', 'password', 'assertion', 'sessionCookie'].forEach(addOption,</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    connectOptions);</td></tr><tr class="hit"><td class="line">139</td><td class="hits">11</td><td class="source">  util.extend(connectOptions, options);</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">  // SAML assertion can only be used once</td></tr><tr class="hit"><td class="line">142</td><td class="hits">11</td><td class="source">  if (this._settings.assertion) {</td></tr><tr class="hit"><td class="line">143</td><td class="hits">1</td><td class="source">    this._settings.assertion = undefined;</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">146</td><td class="hits">11</td><td class="source">  var self = this;</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">148</td><td class="hits">11</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">149</td><td class="hits">10</td><td class="source">    if (!err) {</td></tr><tr class="hit"><td class="line">150</td><td class="hits">9</td><td class="source">      self.emit('connect');</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">152</td><td class="hits">10</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">153</td><td class="hits">8</td><td class="source">      cb(err);</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">157</td><td class="hits">11</td><td class="source">  function onopen(err) {</td></tr><tr class="hit"><td class="line">158</td><td class="hits">9</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">159</td><td class="hits">1</td><td class="source">      return done(err);</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">161</td><td class="hits">8</td><td class="source">    self._connection.connect(connectOptions, done);</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">164</td><td class="hits">11</td><td class="source">  if (this._connection.readyState === 'new') {</td></tr><tr class="hit"><td class="line">165</td><td class="hits">8</td><td class="source">    this._connection.open(openOptions, onopen);</td></tr><tr class="hit"><td class="line">166</td><td class="hits">3</td><td class="source">  } else if (this._connection.readyState === 'closed') {</td></tr><tr class="hit"><td class="line">167</td><td class="hits">1</td><td class="source">    this._connection = this._createConnection(this._settings);</td></tr><tr class="hit"><td class="line">168</td><td class="hits">1</td><td class="source">    this._addListeners(this._connection);</td></tr><tr class="hit"><td class="line">169</td><td class="hits">1</td><td class="source">    this._connection.open(openOptions, onopen);</td></tr><tr class="hit"><td class="line">170</td><td class="hits">2</td><td class="source">  } else if (this._connection.readyState === 'disconnected') {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">1</td><td class="source">    this._connection.connect(connectOptions, done);</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">173</td><td class="hits">1</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">174</td><td class="hits">1</td><td class="source">      util.setImmediate(function deferError() {</td></tr><tr class="hit"><td class="line">175</td><td class="hits">1</td><td class="source">        var msg = util.format('Cannot connect in state &quot;%s&quot;', self.readyState);</td></tr><tr class="hit"><td class="line">176</td><td class="hits">1</td><td class="source">        var err = new Error(msg);</td></tr><tr class="hit"><td class="line">177</td><td class="hits">1</td><td class="source">        err.code = 'EHDBCONNECT';</td></tr><tr class="hit"><td class="line">178</td><td class="hits">1</td><td class="source">        cb(err);</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">182</td><td class="hits">11</td><td class="source">  return this;</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">185</td><td class="hits">1</td><td class="source">Client.prototype.disconnect = function disconnect(cb) {</td></tr><tr class="hit"><td class="line">186</td><td class="hits">5</td><td class="source">  var self = this;</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">188</td><td class="hits">5</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">189</td><td class="hits">5</td><td class="source">    if (!err) {</td></tr><tr class="hit"><td class="line">190</td><td class="hits">5</td><td class="source">      self.emit('disconnect');</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">192</td><td class="hits">5</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">193</td><td class="hits">5</td><td class="source">      cb(err);</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">196</td><td class="hits">5</td><td class="source">  this._connection.disconnect(done);</td></tr><tr class="hit"><td class="line">197</td><td class="hits">5</td><td class="source">  return this;</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">199</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">200</td><td class="hits">1</td><td class="source">Client.prototype.close = function close() {</td></tr><tr class="hit"><td class="line">201</td><td class="hits">6</td><td class="source">  this._connection.close();</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">};</td></tr><tr class="hit"><td class="line">203</td><td class="hits">1</td><td class="source">Client.prototype.end = Client.prototype.close;</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">205</td><td class="hits">1</td><td class="source">Client.prototype.prepare = function prepare(command, cb) {</td></tr><tr class="hit"><td class="line">206</td><td class="hits">8</td><td class="source">  var options;</td></tr><tr class="hit"><td class="line">207</td><td class="hits">8</td><td class="source">  if (util.isString(command)) {</td></tr><tr class="hit"><td class="line">208</td><td class="hits">7</td><td class="source">    options = {</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">      command: command</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">211</td><td class="hits">1</td><td class="source">  } else if (util.isObject(command)) {</td></tr><tr class="hit"><td class="line">212</td><td class="hits">1</td><td class="source">    options = command;</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">215</td><td class="hits">8</td><td class="source">  var statement = new Statement(this._connection);</td></tr><tr class="hit"><td class="line">216</td><td class="hits">8</td><td class="source">  this._connection.prepare(options, function onreply(err, reply) {</td></tr><tr class="hit"><td class="line">217</td><td class="hits">8</td><td class="source">    statement.handle(err, reply, cb);</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">219</td><td class="hits">8</td><td class="source">  return this;</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">222</td><td class="hits">1</td><td class="source">Client.prototype.destroy = function destroy(err) {</td></tr><tr class="hit"><td class="line">223</td><td class="hits">2</td><td class="source">  this._connection.destroy(err);</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">226</td><td class="hits">1</td><td class="source">Client.prototype.exec = function exec(command, options, cb) {</td></tr><tr class="hit"><td class="line">227</td><td class="hits">8</td><td class="source">  var defaults = {</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">    autoFetch: true</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">230</td><td class="hits">8</td><td class="source">  executeDirect.call(this, defaults, command, options, cb);</td></tr><tr class="hit"><td class="line">231</td><td class="hits">8</td><td class="source">  return this;</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">234</td><td class="hits">1</td><td class="source">Client.prototype.execute = function execute(command, options, cb) {</td></tr><tr class="hit"><td class="line">235</td><td class="hits">3</td><td class="source">  var defaults = {</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">    autoFetch: false</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">238</td><td class="hits">3</td><td class="source">  executeDirect.call(this, defaults, command, options, cb);</td></tr><tr class="hit"><td class="line">239</td><td class="hits">3</td><td class="source">  return this;</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">242</td><td class="hits">1</td><td class="source">Client.prototype._createConnection = function _createConnection(settings) {</td></tr><tr class="hit"><td class="line">243</td><td class="hits">4</td><td class="source">  return new Connection(settings);</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">246</td><td class="hits">1</td><td class="source">Client.prototype._addListeners = function _addListeners(connection) {</td></tr><tr class="hit"><td class="line">247</td><td class="hits">27</td><td class="source">  var self = this;</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">249</td><td class="hits">27</td><td class="source">  function cleanup() {</td></tr><tr class="hit"><td class="line">250</td><td class="hits">9</td><td class="source">    connection.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">251</td><td class="hits">9</td><td class="source">    connection.removeListener('close', onclose);</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">254</td><td class="hits">27</td><td class="source">  function onerror(err) {</td></tr><tr class="hit"><td class="line">255</td><td class="hits">3</td><td class="source">    self.emit('error', err);</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">257</td><td class="hits">27</td><td class="source">  connection.on('error', onerror);</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">259</td><td class="hits">27</td><td class="source">  function onclose(hadError) {</td></tr><tr class="hit"><td class="line">260</td><td class="hits">9</td><td class="source">    cleanup();</td></tr><tr class="hit"><td class="line">261</td><td class="hits">9</td><td class="source">    self.emit('close', hadError);</td></tr><tr class="hit"><td class="line">262</td><td class="hits">9</td><td class="source">    if (hadError &amp;&amp; self.get('autoReconnect')) {</td></tr><tr class="hit"><td class="line">263</td><td class="hits">1</td><td class="source">      self.connect();</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">266</td><td class="hits">27</td><td class="source">  connection.on('close', onclose);</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">268</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">269</td><td class="hits">1</td><td class="source">Client.prototype._createResult = function _createResult(connection, options) {</td></tr><tr class="hit"><td class="line">270</td><td class="hits">7</td><td class="source">  return new Result(connection, options);</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">273</td><td class="hits">1</td><td class="source">function executeDirect(defaults, command, options, cb) {</td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">  /* jshint validthis: true */</td></tr><tr class="hit"><td class="line">275</td><td class="hits">11</td><td class="source">  if (util.isFunction(options)) {</td></tr><tr class="hit"><td class="line">276</td><td class="hits">6</td><td class="source">    cb = options;</td></tr><tr class="hit"><td class="line">277</td><td class="hits">6</td><td class="source">    options = defaults;</td></tr><tr class="hit"><td class="line">278</td><td class="hits">5</td><td class="source">  } else if (util.isObject(options)) {</td></tr><tr class="hit"><td class="line">279</td><td class="hits">1</td><td class="source">    options = util.extend(defaults, options);</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">281</td><td class="hits">4</td><td class="source">    var autoFetch = !!options;</td></tr><tr class="hit"><td class="line">282</td><td class="hits">4</td><td class="source">    options = defaults;</td></tr><tr class="hit"><td class="line">283</td><td class="hits">4</td><td class="source">    options.autoFetch = autoFetch;</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">285</td><td class="hits">11</td><td class="source">  var executeOptions = {</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">    command: command,</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">288</td><td class="hits">11</td><td class="source">  var result = this._createResult(this._connection, options);</td></tr><tr><td class="line">289</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">290</td><td class="hits">11</td><td class="source">  function onreply(err, reply) {</td></tr><tr class="hit"><td class="line">291</td><td class="hits">11</td><td class="source">    result.handle(err, reply, cb);</td></tr><tr><td class="line">292</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">293</td><td class="hits">11</td><td class="source">  this._connection.executeDirect(executeOptions, onreply);</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="index.js">index.js</h2><div id="stats" class="high"><div class="percentage">81%</div><div class="sloc">16</div><div class="hits">13</div><div class="misses">3</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = exports.util = require('./util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Client = exports.Client = require('./Client');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var protocol = require('./protocol');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">util.extend(exports, protocol);</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.createJSONStringifier = createJSONStringifier;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.createClient = createClient;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.connect = connect;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function connect(options, cb) {</td></tr><tr class="miss"><td class="line">26</td><td class="hits">0</td><td class="source">  var client = createClient(options);</td></tr><tr class="miss"><td class="line">27</td><td class="hits">0</td><td class="source">  client.connect(cb);</td></tr><tr class="miss"><td class="line">28</td><td class="hits">0</td><td class="source">  return client;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">function createClient(options) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">4</td><td class="source">  return new Client(options);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function createJSONStringifier() {</td></tr><tr class="hit"><td class="line">36</td><td class="hits">4</td><td class="source">  return new protocol.Stringifier({</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    header: '[',</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">    footer: ']',</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    seperator: ',',</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">    stringify: JSON.stringify</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Connection.js">protocol/Connection.js</h2><div id="stats" class="high"><div class="percentage">83%</div><div class="sloc">337</div><div class="hits">281</div><div class="misses">56</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var os = require('os');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var tcp = require('./tcp');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var auth = require('./auth');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var Transaction = require('./Transaction');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var request = require('./request');</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var reply = require('./reply');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var createExecuteTask = require('./ExecuteTask').create;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">var ReplySegment = reply.Segment;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">var part = require('./part');</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">var MessageType = common.MessageType;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">var MessageTypeName = common.MessageTypeName;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">var SegmentKind = common.SegmentKind;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">var PartKind = common.PartKind;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">var bignum = util.bignum;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">var debug = util.debuglog('hdb');</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">var trace = util.tracelog();</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">var MAX_PACKET_SIZE = common.MAX_PACKET_SIZE;</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">var PACKET_HEADER_LENGTH = common.PACKET_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">var SEGMENT_HEADER_LENGTH = common.SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">var PART_HEADER_LENGTH = common.PART_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">var MAX_AVAILABLE_SIZE = MAX_PACKET_SIZE -</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  PACKET_HEADER_LENGTH - SEGMENT_HEADER_LENGTH - PART_HEADER_LENGTH;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">module.exports = Connection;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">util.inherits(Connection, EventEmitter);</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">function Connection(settings) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">4</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">50</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  // public</td></tr><tr class="hit"><td class="line">52</td><td class="hits">4</td><td class="source">  this.clientId = [process.pid || 'nodejs', os.hostname()].join('@');</td></tr><tr class="hit"><td class="line">53</td><td class="hits">4</td><td class="source">  this.connectOptions = new part.ConnectOptions();</td></tr><tr class="hit"><td class="line">54</td><td class="hits">4</td><td class="source">  this.protocolVersion = undefined;</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  // private</td></tr><tr class="hit"><td class="line">56</td><td class="hits">4</td><td class="source">  this._settings = settings || {};</td></tr><tr class="hit"><td class="line">57</td><td class="hits">4</td><td class="source">  this._socket = undefined;</td></tr><tr class="hit"><td class="line">58</td><td class="hits">4</td><td class="source">  this._queue = new util.Queue().pause();</td></tr><tr class="hit"><td class="line">59</td><td class="hits">4</td><td class="source">  this._state = new ConnectionState();</td></tr><tr class="hit"><td class="line">60</td><td class="hits">4</td><td class="source">  this._statementContext = undefined;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">4</td><td class="source">  this._transaction = new Transaction();</td></tr><tr class="hit"><td class="line">62</td><td class="hits">4</td><td class="source">  this._transaction.once('error', function onerror(err) {</td></tr><tr class="miss"><td class="line">63</td><td class="hits">0</td><td class="source">    self.destroy(err);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">Object.defineProperties(Connection.prototype, {</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  autoCommit: {</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    get: function getAutoCommit() {</td></tr><tr class="hit"><td class="line">70</td><td class="hits">29</td><td class="source">      return this._transaction.autoCommit;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    set: function setAutoCommit(autoCommit) {</td></tr><tr class="miss"><td class="line">73</td><td class="hits">0</td><td class="source">      this._transaction.setAutoCommit(autoCommit);</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  holdCursorsOverCommit: {</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    get: function getHoldCursorsOverCommit() {</td></tr><tr class="hit"><td class="line">78</td><td class="hits">21</td><td class="source">      return !!this._settings.holdCursorsOverCommit;</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    set: function setHoldCursorsOverCommit(holdCursorsOverCommit) {</td></tr><tr class="miss"><td class="line">81</td><td class="hits">0</td><td class="source">      this._settings.holdCursorsOverCommit = holdCursorsOverCommit;</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  scrollableCursor: {</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">    get: function setScrollableCursor() {</td></tr><tr class="hit"><td class="line">86</td><td class="hits">21</td><td class="source">      return !!this._settings.scrollableCursor;</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    },</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">    set: function setScrollableCursor(scrollableCursor) {</td></tr><tr class="miss"><td class="line">89</td><td class="hits">0</td><td class="source">      this._settings.scrollableCursor = scrollableCursor;</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  readyState: {</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">    get: function getReadyState() {</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">      // no state ==&gt; socket must be closed</td></tr><tr class="hit"><td class="line">95</td><td class="hits">4</td><td class="source">      if (!this._state) {</td></tr><tr class="miss"><td class="line">96</td><td class="hits">0</td><td class="source">        return 'closed';</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">      // no socket ==&gt; open has not been called</td></tr><tr class="hit"><td class="line">99</td><td class="hits">4</td><td class="source">      if (!this._socket) {</td></tr><tr class="hit"><td class="line">100</td><td class="hits">4</td><td class="source">        return 'new';</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">      // socket is closed ==&gt; socket ended but not closed</td></tr><tr class="miss"><td class="line">103</td><td class="hits">0</td><td class="source">      if (this._socket.readyState === 'closed') {</td></tr><tr class="miss"><td class="line">104</td><td class="hits">0</td><td class="source">        return 'closed';</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">      // no protocol version ==&gt; open not yet finished</td></tr><tr class="miss"><td class="line">107</td><td class="hits">0</td><td class="source">      if (!this.protocolVersion) {</td></tr><tr class="miss"><td class="line">108</td><td class="hits">0</td><td class="source">        return 'opening';</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">110</td><td class="hits">0</td><td class="source">      switch (this._state.messageType) {</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">      case MessageType.AUTHENTICATE:</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">      case MessageType.CONNECT:</td></tr><tr class="miss"><td class="line">113</td><td class="hits">0</td><td class="source">        return 'connecting';</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">      case MessageType.DISCONNECT:</td></tr><tr class="miss"><td class="line">115</td><td class="hits">0</td><td class="source">        return 'disconnecting';</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">117</td><td class="hits">0</td><td class="source">      if (this._state.sessionId === -1) {</td></tr><tr class="miss"><td class="line">118</td><td class="hits">0</td><td class="source">        return 'disconnected';</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">120</td><td class="hits">0</td><td class="source">      return 'connected';</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">125</td><td class="hits">1</td><td class="source">Connection.prototype.open = function open(options, cb) {</td></tr><tr class="hit"><td class="line">126</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">128</td><td class="hits">4</td><td class="source">  if (this._socket) {</td></tr><tr class="miss"><td class="line">129</td><td class="hits">0</td><td class="source">    util.setImmediate(function deferError() {</td></tr><tr class="miss"><td class="line">130</td><td class="hits">0</td><td class="source">      cb(new Error('Call open only once'));</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">    });</td></tr><tr class="miss"><td class="line">132</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">135</td><td class="hits">4</td><td class="source">  function done(err, protocolVersion) {</td></tr><tr class="hit"><td class="line">136</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">137</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">139</td><td class="hits">4</td><td class="source">    self.protocolVersion = protocolVersion;</td></tr><tr class="hit"><td class="line">140</td><td class="hits">4</td><td class="source">    self._addListeners(self._socket);</td></tr><tr class="hit"><td class="line">141</td><td class="hits">4</td><td class="source">    self.emit('open');</td></tr><tr class="hit"><td class="line">142</td><td class="hits">4</td><td class="source">    cb();</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">144</td><td class="hits">4</td><td class="source">  this._socket = this._connect(options, done);</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">147</td><td class="hits">1</td><td class="source">Connection.prototype._connect = function _connect(options, cb) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">4</td><td class="source">  var socket = tcp.connect(options, function connectListener() {</td></tr><tr class="hit"><td class="line">149</td><td class="hits">4</td><td class="source">    socket.write(initializationRequestBuffer);</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">152</td><td class="hits">4</td><td class="source">  function cleanup() {</td></tr><tr class="hit"><td class="line">153</td><td class="hits">4</td><td class="source">    socket.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">154</td><td class="hits">4</td><td class="source">    socket.removeListener('data', ondata);</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">157</td><td class="hits">4</td><td class="source">  function onerror(err) {</td></tr><tr class="miss"><td class="line">158</td><td class="hits">0</td><td class="source">    cleanup();</td></tr><tr class="miss"><td class="line">159</td><td class="hits">0</td><td class="source">    cb(err);</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">161</td><td class="hits">4</td><td class="source">  socket.on('error', onerror);</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">163</td><td class="hits">4</td><td class="source">  function ondata(chunk) {</td></tr><tr class="hit"><td class="line">164</td><td class="hits">4</td><td class="source">    cleanup();</td></tr><tr class="hit"><td class="line">165</td><td class="hits">4</td><td class="source">    if (!chunk || chunk.length &lt; InitializationReply.LENGTH) {</td></tr><tr class="miss"><td class="line">166</td><td class="hits">0</td><td class="source">      var err = new Error('Invalid initialization reply');</td></tr><tr class="miss"><td class="line">167</td><td class="hits">0</td><td class="source">      err.code = 'EHDBINIT';</td></tr><tr class="miss"><td class="line">168</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">170</td><td class="hits">4</td><td class="source">    var reply = InitializationReply.read(chunk, 0);</td></tr><tr class="hit"><td class="line">171</td><td class="hits">4</td><td class="source">    cb(null, reply.protocolVersion);</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">173</td><td class="hits">4</td><td class="source">  socket.on('data', ondata);</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">175</td><td class="hits">4</td><td class="source">  return socket;</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">178</td><td class="hits">1</td><td class="source">Connection.prototype._addListeners = function _addListeners(socket) {</td></tr><tr class="hit"><td class="line">179</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">180</td><td class="hits">4</td><td class="source">  var packet = new MessageBuffer();</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">182</td><td class="hits">4</td><td class="source">  function cleanup() {</td></tr><tr class="hit"><td class="line">183</td><td class="hits">4</td><td class="source">    socket.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">184</td><td class="hits">4</td><td class="source">    socket.removeListener('data', ondata);</td></tr><tr class="hit"><td class="line">185</td><td class="hits">4</td><td class="source">    socket.removeListener('close', onclose);</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">  // register listerners on socket</td></tr><tr class="hit"><td class="line">189</td><td class="hits">4</td><td class="source">  function ondata(chunk) {</td></tr><tr class="hit"><td class="line">190</td><td class="hits">85</td><td class="source">    packet.push(chunk);</td></tr><tr class="hit"><td class="line">191</td><td class="hits">85</td><td class="source">    if (packet.isReady()) {</td></tr><tr class="hit"><td class="line">192</td><td class="hits">63</td><td class="source">      if (self._state.sessionId !== packet.header.sessionId) {</td></tr><tr class="hit"><td class="line">193</td><td class="hits">4</td><td class="source">        self._state.sessionId = packet.header.sessionId;</td></tr><tr class="hit"><td class="line">194</td><td class="hits">4</td><td class="source">        self._state.packetCount = -1;</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">196</td><td class="hits">63</td><td class="source">      var buffer = packet.getData();</td></tr><tr class="hit"><td class="line">197</td><td class="hits">63</td><td class="source">      packet.clear();</td></tr><tr class="hit"><td class="line">198</td><td class="hits">63</td><td class="source">      var cb = self._state.receive;</td></tr><tr class="hit"><td class="line">199</td><td class="hits">63</td><td class="source">      self._state.receive = undefined;</td></tr><tr class="hit"><td class="line">200</td><td class="hits">63</td><td class="source">      self._state.messageType = undefined;</td></tr><tr class="hit"><td class="line">201</td><td class="hits">63</td><td class="source">      self.receive(buffer, cb);</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">204</td><td class="hits">4</td><td class="source">  socket.on('data', ondata);</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">206</td><td class="hits">4</td><td class="source">  function onerror(err) {</td></tr><tr class="miss"><td class="line">207</td><td class="hits">0</td><td class="source">    self.emit('error', err);</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">209</td><td class="hits">4</td><td class="source">  socket.on('error', onerror);</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">211</td><td class="hits">4</td><td class="source">  function onclose(hadError) {</td></tr><tr class="hit"><td class="line">212</td><td class="hits">4</td><td class="source">    cleanup();</td></tr><tr class="hit"><td class="line">213</td><td class="hits">4</td><td class="source">    self._cleanup();</td></tr><tr class="hit"><td class="line">214</td><td class="hits">4</td><td class="source">    self.emit('close', hadError);</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">216</td><td class="hits">4</td><td class="source">  socket.on('close', onclose);</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">219</td><td class="hits">1</td><td class="source">Connection.prototype._cleanup = function _cleanup() {</td></tr><tr class="hit"><td class="line">220</td><td class="hits">4</td><td class="source">  this._socket = undefined;</td></tr><tr class="hit"><td class="line">221</td><td class="hits">4</td><td class="source">  this._state = undefined;</td></tr><tr class="hit"><td class="line">222</td><td class="hits">4</td><td class="source">  this._queue.abort();</td></tr><tr class="hit"><td class="line">223</td><td class="hits">4</td><td class="source">  this._queue = undefined;</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">226</td><td class="hits">1</td><td class="source">Connection.prototype.send = function send(message, receive) {</td></tr><tr class="hit"><td class="line">227</td><td class="hits">63</td><td class="source">  if (this._statementContext) {</td></tr><tr class="hit"><td class="line">228</td><td class="hits">1</td><td class="source">    message.unshift(PartKind.STATEMENT_CONTEXT, this._statementContext.getOptions());</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">231</td><td class="hits">63</td><td class="source">  debug('send', message);</td></tr><tr class="hit"><td class="line">232</td><td class="hits">63</td><td class="source">  trace('REQUEST', message);</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">234</td><td class="hits">63</td><td class="source">  var size = MAX_PACKET_SIZE - PACKET_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">235</td><td class="hits">63</td><td class="source">  var buffer = message.toBuffer(size);</td></tr><tr class="hit"><td class="line">236</td><td class="hits">63</td><td class="source">  var packet = new Buffer(PACKET_HEADER_LENGTH + buffer.length);</td></tr><tr class="hit"><td class="line">237</td><td class="hits">63</td><td class="source">  buffer.copy(packet, PACKET_HEADER_LENGTH);</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">239</td><td class="hits">63</td><td class="source">  var state = this._state;</td></tr><tr class="hit"><td class="line">240</td><td class="hits">63</td><td class="source">  state.messageType = message.type;</td></tr><tr class="hit"><td class="line">241</td><td class="hits">63</td><td class="source">  state.receive = receive;</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">  // Increase packet count</td></tr><tr class="hit"><td class="line">243</td><td class="hits">63</td><td class="source">  state.packetCount++;</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">  // Session identifier</td></tr><tr class="hit"><td class="line">245</td><td class="hits">63</td><td class="source">  bignum.writeUInt64LE(packet, state.sessionId, 0);</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">  // Packet sequence number in this session</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source">  // Packets with the same sequence number belong to one request / reply pair</td></tr><tr class="hit"><td class="line">248</td><td class="hits">63</td><td class="source">  packet.writeUInt32LE(state.packetCount, 8);</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">  // Used space in this packet</td></tr><tr class="hit"><td class="line">250</td><td class="hits">63</td><td class="source">  packet.writeUInt32LE(buffer.length, 12);</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">  // Total space in this packet</td></tr><tr class="hit"><td class="line">252</td><td class="hits">63</td><td class="source">  packet.writeUInt32LE(size, 16);</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source">  // Number of segments in this packet</td></tr><tr class="hit"><td class="line">254</td><td class="hits">63</td><td class="source">  packet.writeUInt16LE(1, 20);</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">  // Filler</td></tr><tr class="hit"><td class="line">256</td><td class="hits">63</td><td class="source">  packet.fill(0x00, 22, PACKET_HEADER_LENGTH);</td></tr><tr><td class="line">257</td><td class="hits"></td><td class="source">  // Write request packet to socket</td></tr><tr class="hit"><td class="line">258</td><td class="hits">63</td><td class="source">  if (this._socket) {</td></tr><tr class="hit"><td class="line">259</td><td class="hits">63</td><td class="source">    this._socket.write(packet);</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">263</td><td class="hits">1</td><td class="source">Connection.prototype.setStatementContext = function setStatementContext(options) {</td></tr><tr class="hit"><td class="line">264</td><td class="hits">63</td><td class="source">  if (options &amp;&amp; options.length) {</td></tr><tr class="hit"><td class="line">265</td><td class="hits">1</td><td class="source">    if (!this._statementContext) {</td></tr><tr class="hit"><td class="line">266</td><td class="hits">1</td><td class="source">      this._statementContext = new part.StatementContext();</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">268</td><td class="hits">1</td><td class="source">    this._statementContext.setOptions(options);</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">270</td><td class="hits">62</td><td class="source">    this._statementContext = undefined;</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">274</td><td class="hits">1</td><td class="source">Connection.prototype.getAvailableSize = function getAvailableSize() {</td></tr><tr class="hit"><td class="line">275</td><td class="hits">20</td><td class="source">  var availableSize = MAX_AVAILABLE_SIZE;</td></tr><tr class="hit"><td class="line">276</td><td class="hits">20</td><td class="source">  if (this._statementContext) {</td></tr><tr class="miss"><td class="line">277</td><td class="hits">0</td><td class="source">    availableSize -= this._statementContext.size;</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">279</td><td class="hits">20</td><td class="source">  return availableSize;</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">282</td><td class="hits">1</td><td class="source">Connection.prototype.setTransactionFlags = function setTransactionFlags(flags) {</td></tr><tr class="hit"><td class="line">283</td><td class="hits">63</td><td class="source">  if (flags) {</td></tr><tr class="hit"><td class="line">284</td><td class="hits">5</td><td class="source">    this._transaction.setFlags(flags);</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">288</td><td class="hits">1</td><td class="source">Connection.prototype.receive = function receive(buffer, cb) {</td></tr><tr class="hit"><td class="line">289</td><td class="hits">63</td><td class="source">  var error, segment, reply;</td></tr><tr class="hit"><td class="line">290</td><td class="hits">63</td><td class="source">  try {</td></tr><tr class="hit"><td class="line">291</td><td class="hits">63</td><td class="source">    segment = ReplySegment.create(buffer, 0);</td></tr><tr class="hit"><td class="line">292</td><td class="hits">63</td><td class="source">    trace(segment.kind === SegmentKind.ERROR ? 'ERROR' : 'REPLY', segment);</td></tr><tr class="hit"><td class="line">293</td><td class="hits">63</td><td class="source">    reply = segment.getReply();</td></tr><tr class="hit"><td class="line">294</td><td class="hits">63</td><td class="source">    this.setStatementContext(reply.statementContext);</td></tr><tr class="hit"><td class="line">295</td><td class="hits">63</td><td class="source">    this.setTransactionFlags(reply.transactionFlags);</td></tr><tr class="hit"><td class="line">296</td><td class="hits">63</td><td class="source">    if (reply.kind === SegmentKind.ERROR) {</td></tr><tr class="miss"><td class="line">297</td><td class="hits">0</td><td class="source">      error = reply.error;</td></tr><tr class="hit"><td class="line">298</td><td class="hits">63</td><td class="source">    } else if (this._transaction.error) {</td></tr><tr class="miss"><td class="line">299</td><td class="hits">0</td><td class="source">      error = this._transaction.error;</td></tr><tr><td class="line">300</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">301</td><td class="hits">63</td><td class="source">    debug('receive', reply);</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source">  } catch (exception) {</td></tr><tr class="miss"><td class="line">303</td><td class="hits">0</td><td class="source">    error = exception;</td></tr><tr class="miss"><td class="line">304</td><td class="hits">0</td><td class="source">    error.code = 'EHDBMSGPARSE';</td></tr><tr class="miss"><td class="line">305</td><td class="hits">0</td><td class="source">    debug('receive', error);</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">307</td><td class="hits">63</td><td class="source">  if (error &amp;&amp; error.fatal) {</td></tr><tr class="miss"><td class="line">308</td><td class="hits">0</td><td class="source">    this.destroy(error);</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">310</td><td class="hits">63</td><td class="source">  if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">311</td><td class="hits">63</td><td class="source">    cb(error, reply);</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">315</td><td class="hits">1</td><td class="source">Connection.prototype.enqueue = function enqueue(task, cb) {</td></tr><tr class="hit"><td class="line">316</td><td class="hits">42</td><td class="source">  var queueable;</td></tr><tr class="hit"><td class="line">317</td><td class="hits">42</td><td class="source">  if (util.isFunction(task)) {</td></tr><tr class="miss"><td class="line">318</td><td class="hits">0</td><td class="source">    queueable = this._queue.createTask(task, cb);</td></tr><tr class="miss"><td class="line">319</td><td class="hits">0</td><td class="source">    queueable.name = task.name;</td></tr><tr class="hit"><td class="line">320</td><td class="hits">42</td><td class="source">  } else if (util.isObject(task)) {</td></tr><tr class="hit"><td class="line">321</td><td class="hits">42</td><td class="source">    if (task instanceof request.Segment) {</td></tr><tr class="hit"><td class="line">322</td><td class="hits">34</td><td class="source">      task = this.send.bind(this, task);</td></tr><tr class="hit"><td class="line">323</td><td class="hits">34</td><td class="source">      queueable = this._queue.createTask(task, cb);</td></tr><tr class="hit"><td class="line">324</td><td class="hits">34</td><td class="source">      queueable.name = MessageTypeName[task.type];</td></tr><tr class="hit"><td class="line">325</td><td class="hits">8</td><td class="source">    } else if (util.isFunction(task.run)) {</td></tr><tr class="hit"><td class="line">326</td><td class="hits">8</td><td class="source">      queueable = task;</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">328</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">329</td><td class="hits">42</td><td class="source">  if (queueable) {</td></tr><tr class="hit"><td class="line">330</td><td class="hits">42</td><td class="source">    this._queue.push(queueable);</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">334</td><td class="hits">1</td><td class="source">Connection.prototype.connect = function connect(options, cb) {</td></tr><tr class="hit"><td class="line">335</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr><td class="line">336</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">337</td><td class="hits">4</td><td class="source">  var manager;</td></tr><tr class="hit"><td class="line">338</td><td class="hits">4</td><td class="source">  try {</td></tr><tr class="hit"><td class="line">339</td><td class="hits">4</td><td class="source">    manager = auth.createManager(options);</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">  } catch (err) {</td></tr><tr class="miss"><td class="line">341</td><td class="hits">0</td><td class="source">    return util.setImmediate(function deferError() {</td></tr><tr class="miss"><td class="line">342</td><td class="hits">0</td><td class="source">      cb(err);</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">345</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">346</td><td class="hits">4</td><td class="source">  function connReceive(err, reply) {</td></tr><tr class="hit"><td class="line">347</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">348</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">349</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">350</td><td class="hits">4</td><td class="source">    if (util.isArray(reply.connectOptions)) {</td></tr><tr class="miss"><td class="line">351</td><td class="hits">0</td><td class="source">      self.connectOptions.setOptions(reply.connectOptions);</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">353</td><td class="hits">4</td><td class="source">    manager.finalize(reply.authentication);</td></tr><tr class="hit"><td class="line">354</td><td class="hits">4</td><td class="source">    self._settings.user = manager.userFromServer;</td></tr><tr class="hit"><td class="line">355</td><td class="hits">4</td><td class="source">    if (manager.sessionCookie) {</td></tr><tr class="miss"><td class="line">356</td><td class="hits">0</td><td class="source">      self._settings.sessionCookie = manager.sessionCookie;</td></tr><tr><td class="line">357</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">358</td><td class="hits">4</td><td class="source">    self._queue.resume();</td></tr><tr class="hit"><td class="line">359</td><td class="hits">4</td><td class="source">    cb(null, reply);</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">361</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">362</td><td class="hits">4</td><td class="source">  function authReceive(err, reply) {</td></tr><tr class="hit"><td class="line">363</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">364</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">365</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">366</td><td class="hits">4</td><td class="source">    try {</td></tr><tr class="hit"><td class="line">367</td><td class="hits">4</td><td class="source">      manager.initialize(reply.authentication);</td></tr><tr><td class="line">368</td><td class="hits"></td><td class="source">    } catch (err) {</td></tr><tr class="miss"><td class="line">369</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">371</td><td class="hits">4</td><td class="source">    self.send(request.connect({</td></tr><tr><td class="line">372</td><td class="hits"></td><td class="source">      authentication: manager.finalData(),</td></tr><tr><td class="line">373</td><td class="hits"></td><td class="source">      clientId: self.clientId,</td></tr><tr><td class="line">374</td><td class="hits"></td><td class="source">      connectOptions: self.connectOptions.getOptions()</td></tr><tr><td class="line">375</td><td class="hits"></td><td class="source">    }), connReceive);</td></tr><tr><td class="line">376</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">377</td><td class="hits">4</td><td class="source">  this.send(request.authenticate({</td></tr><tr><td class="line">378</td><td class="hits"></td><td class="source">    authentication: manager.initialData()</td></tr><tr><td class="line">379</td><td class="hits"></td><td class="source">  }), authReceive);</td></tr><tr><td class="line">380</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">381</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">382</td><td class="hits">1</td><td class="source">Connection.prototype.disconnect = function disconnect(cb) {</td></tr><tr class="hit"><td class="line">383</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">385</td><td class="hits">4</td><td class="source">  function done(err, reply) {</td></tr><tr class="hit"><td class="line">386</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">387</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">389</td><td class="hits">4</td><td class="source">    self._statementContext = undefined;</td></tr><tr class="hit"><td class="line">390</td><td class="hits">4</td><td class="source">    self._state = new ConnectionState();</td></tr><tr class="hit"><td class="line">391</td><td class="hits">4</td><td class="source">    cb(null, reply);</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">393</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">394</td><td class="hits">4</td><td class="source">  function enqueueDisconnect() {</td></tr><tr class="hit"><td class="line">395</td><td class="hits">4</td><td class="source">    self.enqueue(request.disconnect(), done);</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">398</td><td class="hits">4</td><td class="source">  if (this._queue.empty &amp;&amp; !this._queue.busy) {</td></tr><tr class="hit"><td class="line">399</td><td class="hits">4</td><td class="source">    return enqueueDisconnect();</td></tr><tr><td class="line">400</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">401</td><td class="hits">0</td><td class="source">  this._queue.once('drain', enqueueDisconnect);</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">403</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">404</td><td class="hits">1</td><td class="source">Connection.prototype.executeDirect = function executeDirect(options, cb) {</td></tr><tr class="hit"><td class="line">405</td><td class="hits">7</td><td class="source">  options.autoCommit = this.autoCommit;</td></tr><tr class="hit"><td class="line">406</td><td class="hits">7</td><td class="source">  options.holdCursorsOverCommit = this.holdCursorsOverCommit;</td></tr><tr class="hit"><td class="line">407</td><td class="hits">7</td><td class="source">  options.scrollableCursor = this.scrollableCursor;</td></tr><tr class="hit"><td class="line">408</td><td class="hits">7</td><td class="source">  this.enqueue(request.executeDirect(options), cb);</td></tr><tr><td class="line">409</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">410</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">411</td><td class="hits">1</td><td class="source">Connection.prototype.prepare = function prepare(options, cb) {</td></tr><tr class="hit"><td class="line">412</td><td class="hits">6</td><td class="source">  options.holdCursorsOverCommit = this.holdCursorsOverCommit;</td></tr><tr class="hit"><td class="line">413</td><td class="hits">6</td><td class="source">  options.scrollableCursor = this.scrollableCursor;</td></tr><tr class="hit"><td class="line">414</td><td class="hits">6</td><td class="source">  this.enqueue(request.prepare(options), cb);</td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">416</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">417</td><td class="hits">1</td><td class="source">Connection.prototype.readLob = function readLob(options, cb) {</td></tr><tr class="hit"><td class="line">418</td><td class="hits">10</td><td class="source">  if (options.locatorId) {</td></tr><tr class="hit"><td class="line">419</td><td class="hits">10</td><td class="source">    options = {</td></tr><tr><td class="line">420</td><td class="hits"></td><td class="source">      readLobRequest: options</td></tr><tr><td class="line">421</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">422</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">423</td><td class="hits">10</td><td class="source">  options.autoCommit = this.autoCommit;</td></tr><tr class="hit"><td class="line">424</td><td class="hits">10</td><td class="source">  this.enqueue(request.readLob(options), cb);</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">427</td><td class="hits">1</td><td class="source">Connection.prototype.execute = function execute(options, cb) {</td></tr><tr class="hit"><td class="line">428</td><td class="hits">8</td><td class="source">  options.autoCommit = this.autoCommit;</td></tr><tr class="hit"><td class="line">429</td><td class="hits">8</td><td class="source">  options.holdCursorsOverCommit = this.holdCursorsOverCommit;</td></tr><tr class="hit"><td class="line">430</td><td class="hits">8</td><td class="source">  options.scrollableCursor = this.scrollableCursor;</td></tr><tr class="hit"><td class="line">431</td><td class="hits">8</td><td class="source">  if (!options.parameters) {</td></tr><tr class="miss"><td class="line">432</td><td class="hits">0</td><td class="source">    return this.enqueue(request.execute({</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source">      autoCommit: this.autoCommit,</td></tr><tr><td class="line">434</td><td class="hits"></td><td class="source">      holdCursorsOverCommit: this.holdCursorsOverCommit,</td></tr><tr><td class="line">435</td><td class="hits"></td><td class="source">      scrollableCursor: this.scrollableCursor,</td></tr><tr><td class="line">436</td><td class="hits"></td><td class="source">      statementId: options.statementId,</td></tr><tr><td class="line">437</td><td class="hits"></td><td class="source">      parameters: new Buffer(0)</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source">    }), cb);</td></tr><tr><td class="line">439</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">440</td><td class="hits">8</td><td class="source">  this.enqueue(createExecuteTask(this, options, cb));</td></tr><tr><td class="line">441</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">443</td><td class="hits">1</td><td class="source">Connection.prototype.fetchNext = function fetchNext(options, cb) {</td></tr><tr class="hit"><td class="line">444</td><td class="hits">4</td><td class="source">  options.autoCommit = this.autoCommit;</td></tr><tr class="hit"><td class="line">445</td><td class="hits">4</td><td class="source">  this.enqueue(request.fetchNext(options), cb);</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">447</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">448</td><td class="hits">1</td><td class="source">Connection.prototype.closeResultSet = function closeResultSet(options, cb) {</td></tr><tr class="miss"><td class="line">449</td><td class="hits">0</td><td class="source">  this.enqueue(request.closeResultSet(options), cb);</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">452</td><td class="hits">1</td><td class="source">Connection.prototype.dropStatement = function dropStatement(options, cb) {</td></tr><tr class="hit"><td class="line">453</td><td class="hits">3</td><td class="source">  this.enqueue(request.dropStatementId(options), cb);</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">456</td><td class="hits">1</td><td class="source">Connection.prototype.commit = function commit(options, cb) {</td></tr><tr class="miss"><td class="line">457</td><td class="hits">0</td><td class="source">  if (util.isFunction(options)) {</td></tr><tr class="miss"><td class="line">458</td><td class="hits">0</td><td class="source">    cb = options;</td></tr><tr class="miss"><td class="line">459</td><td class="hits">0</td><td class="source">    options = {};</td></tr><tr><td class="line">460</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">461</td><td class="hits">0</td><td class="source">  this.enqueue(request.commit(options), cb);</td></tr><tr><td class="line">462</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">463</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">464</td><td class="hits">1</td><td class="source">Connection.prototype.rollback = function rollback(options, cb) {</td></tr><tr class="miss"><td class="line">465</td><td class="hits">0</td><td class="source">  if (util.isFunction(options)) {</td></tr><tr class="miss"><td class="line">466</td><td class="hits">0</td><td class="source">    cb = options;</td></tr><tr class="miss"><td class="line">467</td><td class="hits">0</td><td class="source">    options = {};</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">469</td><td class="hits">0</td><td class="source">  this.enqueue(request.rollback(options), cb);</td></tr><tr><td class="line">470</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">471</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">472</td><td class="hits">1</td><td class="source">Connection.prototype.close = function close() {</td></tr><tr class="hit"><td class="line">473</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr><td class="line">474</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">475</td><td class="hits">4</td><td class="source">  function closeConnection() {</td></tr><tr class="hit"><td class="line">476</td><td class="hits">4</td><td class="source">    debug('close');</td></tr><tr class="hit"><td class="line">477</td><td class="hits">4</td><td class="source">    self.destroy();</td></tr><tr><td class="line">478</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">479</td><td class="hits">4</td><td class="source">  if (this._queue.empty &amp;&amp; !this._queue.busy) {</td></tr><tr class="miss"><td class="line">480</td><td class="hits">0</td><td class="source">    return closeConnection();</td></tr><tr><td class="line">481</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">482</td><td class="hits">4</td><td class="source">  this._queue.once('drain', closeConnection);</td></tr><tr><td class="line">483</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">484</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">485</td><td class="hits">1</td><td class="source">Connection.prototype.destroy = function destroy(err) {</td></tr><tr class="hit"><td class="line">486</td><td class="hits">4</td><td class="source">  if (this._socket) {</td></tr><tr class="hit"><td class="line">487</td><td class="hits">4</td><td class="source">    this._socket.destroy(err);</td></tr><tr><td class="line">488</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">489</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">490</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">491</td><td class="hits">1</td><td class="source">Connection.prototype.setAutoCommit = function setAutoCommit(autoCommit) {</td></tr><tr class="miss"><td class="line">492</td><td class="hits">0</td><td class="source">  this._transaction.autoCommit = autoCommit;</td></tr><tr><td class="line">493</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">495</td><td class="hits">1</td><td class="source">function ConnectionState() {</td></tr><tr class="hit"><td class="line">496</td><td class="hits">8</td><td class="source">  this.sessionId = -1;</td></tr><tr class="hit"><td class="line">497</td><td class="hits">8</td><td class="source">  this.packetCount = -1;</td></tr><tr class="hit"><td class="line">498</td><td class="hits">8</td><td class="source">  this.messageType = undefined;</td></tr><tr class="hit"><td class="line">499</td><td class="hits">8</td><td class="source">  this.receive = undefined;</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">501</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">502</td><td class="hits">1</td><td class="source">function Version(major, minor) {</td></tr><tr class="hit"><td class="line">503</td><td class="hits">8</td><td class="source">  this.major = major;</td></tr><tr class="hit"><td class="line">504</td><td class="hits">8</td><td class="source">  this.minor = minor;</td></tr><tr><td class="line">505</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">506</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">507</td><td class="hits">1</td><td class="source">Version.read = function readVersion(buffer, offset) {</td></tr><tr class="hit"><td class="line">508</td><td class="hits">8</td><td class="source">  return new Version(</td></tr><tr><td class="line">509</td><td class="hits"></td><td class="source">    buffer.readInt8(offset),</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source">    buffer.readInt16LE(offset + 1)</td></tr><tr><td class="line">511</td><td class="hits"></td><td class="source">  );</td></tr><tr><td class="line">512</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">513</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">514</td><td class="hits">1</td><td class="source">function InitializationReply(productVersion, protocolVersion) {</td></tr><tr class="hit"><td class="line">515</td><td class="hits">4</td><td class="source">  this.productVersion = productVersion;</td></tr><tr class="hit"><td class="line">516</td><td class="hits">4</td><td class="source">  this.protocolVersion = protocolVersion;</td></tr><tr><td class="line">517</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">518</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">519</td><td class="hits">1</td><td class="source">InitializationReply.LENGTH = 8;</td></tr><tr><td class="line">520</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">521</td><td class="hits">1</td><td class="source">InitializationReply.read = function readInitializationReply(buffer) {</td></tr><tr class="hit"><td class="line">522</td><td class="hits">4</td><td class="source">  var productVersion = Version.read(buffer, 0);</td></tr><tr class="hit"><td class="line">523</td><td class="hits">4</td><td class="source">  var protocolVersion = Version.read(buffer, 3);</td></tr><tr class="hit"><td class="line">524</td><td class="hits">4</td><td class="source">  return new InitializationReply(productVersion, protocolVersion);</td></tr><tr><td class="line">525</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">527</td><td class="hits">1</td><td class="source">var initializationRequestBuffer = new Buffer([</td></tr><tr><td class="line">528</td><td class="hits"></td><td class="source">  0xff, 0xff, 0xff, 0xff, 4, 20, 0x00, 4, 1, 0x00, 0x00, 1, 1, 1</td></tr><tr><td class="line">529</td><td class="hits"></td><td class="source">]);</td></tr><tr><td class="line">530</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">531</td><td class="hits">1</td><td class="source">function MessageBuffer() {</td></tr><tr class="hit"><td class="line">532</td><td class="hits">4</td><td class="source">  this.length = 0;</td></tr><tr class="hit"><td class="line">533</td><td class="hits">4</td><td class="source">  this.header = undefined;</td></tr><tr class="hit"><td class="line">534</td><td class="hits">4</td><td class="source">  this.data = undefined;</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">536</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">537</td><td class="hits">1</td><td class="source">MessageBuffer.prototype.isReady = function () {</td></tr><tr class="hit"><td class="line">538</td><td class="hits">85</td><td class="source">  return this.header &amp;&amp; this.length &gt;= this.header.length;</td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">541</td><td class="hits">1</td><td class="source">MessageBuffer.prototype.push = function push(chunk) {</td></tr><tr class="hit"><td class="line">542</td><td class="hits">85</td><td class="source">  if (!chunk || !chunk.length) {</td></tr><tr class="miss"><td class="line">543</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">544</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">545</td><td class="hits">85</td><td class="source">  this.length += chunk.length;</td></tr><tr class="hit"><td class="line">546</td><td class="hits">85</td><td class="source">  if (!this.data) {</td></tr><tr class="hit"><td class="line">547</td><td class="hits">63</td><td class="source">    this.data = chunk;</td></tr><tr class="hit"><td class="line">548</td><td class="hits">22</td><td class="source">  } else if (Buffer.isBuffer(this.data)) {</td></tr><tr class="hit"><td class="line">549</td><td class="hits">7</td><td class="source">    this.data = [this.data, chunk];</td></tr><tr><td class="line">550</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">551</td><td class="hits">15</td><td class="source">    this.data.push(chunk);</td></tr><tr><td class="line">552</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">553</td><td class="hits">85</td><td class="source">  if (!this.header &amp;&amp; this.length &gt;= PACKET_HEADER_LENGTH) {</td></tr><tr class="hit"><td class="line">554</td><td class="hits">63</td><td class="source">    this.readHeader();</td></tr><tr><td class="line">555</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">556</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">557</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">558</td><td class="hits">1</td><td class="source">MessageBuffer.prototype.getData = function getData() {</td></tr><tr class="hit"><td class="line">559</td><td class="hits">126</td><td class="source">  if (util.isArray(this.data)) {</td></tr><tr class="hit"><td class="line">560</td><td class="hits">7</td><td class="source">    return Buffer.concat(this.data, this.length);</td></tr><tr><td class="line">561</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">562</td><td class="hits">119</td><td class="source">  return this.data;</td></tr><tr><td class="line">563</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">565</td><td class="hits">1</td><td class="source">MessageBuffer.prototype.readHeader = function readHeader() {</td></tr><tr class="hit"><td class="line">566</td><td class="hits">63</td><td class="source">  var buffer = this.getData();</td></tr><tr class="hit"><td class="line">567</td><td class="hits">63</td><td class="source">  this.header = {</td></tr><tr><td class="line">568</td><td class="hits"></td><td class="source">    sessionId: bignum.readUInt64LE(buffer, 0),</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source">    packetCount: buffer.readUInt32LE(8),</td></tr><tr><td class="line">570</td><td class="hits"></td><td class="source">    length: buffer.readUInt32LE(12)</td></tr><tr><td class="line">571</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">572</td><td class="hits">63</td><td class="source">  this.data = buffer.slice(PACKET_HEADER_LENGTH);</td></tr><tr class="hit"><td class="line">573</td><td class="hits">63</td><td class="source">  this.length -= PACKET_HEADER_LENGTH;</td></tr><tr><td class="line">574</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">575</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">576</td><td class="hits">1</td><td class="source">MessageBuffer.prototype.clear = function clear() {</td></tr><tr class="hit"><td class="line">577</td><td class="hits">63</td><td class="source">  this.length = 0;</td></tr><tr class="hit"><td class="line">578</td><td class="hits">63</td><td class="source">  this.header = undefined;</td></tr><tr class="hit"><td class="line">579</td><td class="hits">63</td><td class="source">  this.data = undefined;</td></tr><tr><td class="line">580</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/ExecuteTask.js">protocol/ExecuteTask.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">122</div><div class="hits">122</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var request = require('./request');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Writer = require('./Writer');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var FunctionCode = common.FunctionCode;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var STATEMENT_ID_PART_LENGTH = 24;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports = module.exports = ExecuteTask;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">function ExecuteTask(connection, options, callback) {</td></tr><tr class="hit"><td class="line">27</td><td class="hits">21</td><td class="source">  this.connection = connection;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">21</td><td class="source">  this.autoCommit = options.autoCommit;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">21</td><td class="source">  this.needFinializeTransaction = false;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">21</td><td class="source">  this.holdCursorsOverCommit = options.holdCursorsOverCommit;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">21</td><td class="source">  this.scrollableCursor = options.scrollableCursor;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">21</td><td class="source">  this.statementId = options.statementId;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">21</td><td class="source">  this.functionCode = options.functionCode;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">21</td><td class="source">  this.writer = new Writer(options.parameters.types);</td></tr><tr class="hit"><td class="line">35</td><td class="hits">21</td><td class="source">  var values = options.parameters.values;</td></tr><tr class="hit"><td class="line">36</td><td class="hits">21</td><td class="source">  if (values.length &amp;&amp; util.isArray(values[0])) {</td></tr><tr class="hit"><td class="line">37</td><td class="hits">5</td><td class="source">    this.parameterValues = values;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">16</td><td class="source">    this.parameterValues = [values];</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">41</td><td class="hits">21</td><td class="source">  this.callback = callback;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">21</td><td class="source">  this.reply = undefined;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">exports.create = function createExecuteTask(connection, options, cb) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">21</td><td class="source">  return new ExecuteTask(connection, options, cb);</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.run = function run(next) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">14</td><td class="source">  var self = this;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">14</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">14</td><td class="source">    self.end(err);</td></tr><tr class="hit"><td class="line">54</td><td class="hits">14</td><td class="source">    next();</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">14</td><td class="source">  function finalize(err) {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">13</td><td class="source">    if (!self.needFinializeTransaction) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">8</td><td class="source">      return done(err);</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">61</td><td class="hits">5</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">      return self.sendRollback(function () {</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">        // ignore roolback error</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">        done(err);</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">      });</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">67</td><td class="hits">4</td><td class="source">    self.sendCommit(done);</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">70</td><td class="hits">14</td><td class="source">  function execute() {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">25</td><td class="source">    if (!self.parameterValues.length) {</td></tr><tr class="hit"><td class="line">72</td><td class="hits">10</td><td class="source">      return finalize();</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">74</td><td class="hits">15</td><td class="source">    self.sendExecute(function receive(err, reply) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">15</td><td class="source">      if (err) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">2</td><td class="source">        return finalize(err);</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">78</td><td class="hits">13</td><td class="source">      self.pushReply(reply);</td></tr><tr class="hit"><td class="line">79</td><td class="hits">13</td><td class="source">      if (!self.writer.finished &amp;&amp; reply.writeLobReply) {</td></tr><tr class="hit"><td class="line">80</td><td class="hits">5</td><td class="source">        self.writer.update(reply.writeLobReply);</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">82</td><td class="hits">13</td><td class="source">      writeLob();</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">14</td><td class="source">  function writeLob() {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">25</td><td class="source">    if (self.writer.finished || self.writer.hasParameters) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">12</td><td class="source">      return execute();</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">90</td><td class="hits">13</td><td class="source">    self.sendWriteLobRequest(function receive(err, reply) {</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">      /* jshint unused:false */</td></tr><tr class="hit"><td class="line">92</td><td class="hits">13</td><td class="source">      if (err) {</td></tr><tr class="hit"><td class="line">93</td><td class="hits">1</td><td class="source">        return finalize(err);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">95</td><td class="hits">12</td><td class="source">      writeLob();</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  // validate function code</td></tr><tr class="hit"><td class="line">100</td><td class="hits">14</td><td class="source">  if (self.parameterValues.length &gt; 1) {</td></tr><tr class="hit"><td class="line">101</td><td class="hits">4</td><td class="source">    switch (self.functionCode) {</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    case FunctionCode.DDL:</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">    case FunctionCode.INSERT:</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">    case FunctionCode.UPDATE:</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">    case FunctionCode.DELETE:</td></tr><tr class="hit"><td class="line">106</td><td class="hits">3</td><td class="source">      break;</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">    default:</td></tr><tr class="hit"><td class="line">108</td><td class="hits">1</td><td class="source">      return done(createInvalidFunctionCodeError());</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">112</td><td class="hits">13</td><td class="source">  execute();</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">115</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.end = function end(err) {</td></tr><tr class="hit"><td class="line">116</td><td class="hits">14</td><td class="source">  this.callback(err, this.reply);</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">119</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.pushReply = function pushReply(reply) {</td></tr><tr class="hit"><td class="line">120</td><td class="hits">16</td><td class="source">  if (!this.reply) {</td></tr><tr class="hit"><td class="line">121</td><td class="hits">12</td><td class="source">    this.reply = reply;</td></tr><tr class="hit"><td class="line">122</td><td class="hits">12</td><td class="source">    return;</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">124</td><td class="hits">4</td><td class="source">  if (reply.rowsAffected) {</td></tr><tr class="hit"><td class="line">125</td><td class="hits">4</td><td class="source">    if (this.reply.rowsAffected) {</td></tr><tr class="hit"><td class="line">126</td><td class="hits">3</td><td class="source">      this.reply.rowsAffected = [].concat(</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">        this.reply.rowsAffected, reply.rowsAffected);</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">129</td><td class="hits">1</td><td class="source">      this.reply.rowsAffected = reply.rowsAffected;</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">134</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.getParameters = function getParameters(availableSize, cb) {</td></tr><tr class="hit"><td class="line">135</td><td class="hits">17</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">136</td><td class="hits">17</td><td class="source">  var bytesWritten = 0;</td></tr><tr class="hit"><td class="line">137</td><td class="hits">17</td><td class="source">  var args = [];</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">139</td><td class="hits">17</td><td class="source">  function handleParameters(err, buffer) {</td></tr><tr class="hit"><td class="line">140</td><td class="hits">19</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">141</td><td class="hits">1</td><td class="source">      return cb(err);</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">143</td><td class="hits">18</td><td class="source">    bytesWritten += buffer.length;</td></tr><tr class="hit"><td class="line">144</td><td class="hits">18</td><td class="source">    args.push(buffer);</td></tr><tr class="hit"><td class="line">145</td><td class="hits">18</td><td class="source">    if (!self.writer.finished) {</td></tr><tr class="hit"><td class="line">146</td><td class="hits">5</td><td class="source">      if (self.autoCommit) {</td></tr><tr class="hit"><td class="line">147</td><td class="hits">4</td><td class="source">        self.needFinializeTransaction = true;</td></tr><tr class="hit"><td class="line">148</td><td class="hits">4</td><td class="source">        self.autoCommit = false;</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">150</td><td class="hits">5</td><td class="source">      return cb(null, args);</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">152</td><td class="hits">13</td><td class="source">    next();</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">155</td><td class="hits">17</td><td class="source">  function next() {</td></tr><tr class="hit"><td class="line">156</td><td class="hits">30</td><td class="source">    if (!self.parameterValues.length) {</td></tr><tr class="hit"><td class="line">157</td><td class="hits">7</td><td class="source">      return cb(null, args);</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">159</td><td class="hits">23</td><td class="source">    if (!self.writer.hasParameters) {</td></tr><tr class="hit"><td class="line">160</td><td class="hits">22</td><td class="source">      try {</td></tr><tr class="hit"><td class="line">161</td><td class="hits">22</td><td class="source">        self.writer.setValues(self.parameterValues.shift());</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">      } catch (err) {</td></tr><tr class="hit"><td class="line">163</td><td class="hits">2</td><td class="source">        return cb(err);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">166</td><td class="hits">21</td><td class="source">    var remainingSize = availableSize - bytesWritten;</td></tr><tr class="hit"><td class="line">167</td><td class="hits">21</td><td class="source">    if (self.writer.length &gt; remainingSize) {</td></tr><tr class="hit"><td class="line">168</td><td class="hits">2</td><td class="source">      if (self.autoCommit) {</td></tr><tr class="hit"><td class="line">169</td><td class="hits">1</td><td class="source">        self.needFinializeTransaction = true;</td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">        self.autoCommit = false;</td></tr><tr><td class="line">171</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">172</td><td class="hits">2</td><td class="source">      return cb(null, args);</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">174</td><td class="hits">19</td><td class="source">    self.writer.getParameters(remainingSize, handleParameters);</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">177</td><td class="hits">17</td><td class="source">  next();</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">180</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.sendExecute = function sendExecute(cb) {</td></tr><tr class="hit"><td class="line">181</td><td class="hits">16</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">182</td><td class="hits">16</td><td class="source">  var availableSize = self.connection.getAvailableSize();</td></tr><tr class="hit"><td class="line">183</td><td class="hits">16</td><td class="source">  availableSize -= STATEMENT_ID_PART_LENGTH;</td></tr><tr class="hit"><td class="line">184</td><td class="hits">16</td><td class="source">  self.getParameters(availableSize, function send(err, parameters) {</td></tr><tr class="hit"><td class="line">185</td><td class="hits">16</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">186</td><td class="hits">2</td><td class="source">      return cb(err);</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">188</td><td class="hits">14</td><td class="source">    self.connection.send(request.execute({</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">      autoCommit: self.autoCommit,</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">      holdCursorsOverCommit: self.holdCursorsOverCommit,</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">      scrollableCursor: self.scrollableCursor,</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">      statementId: self.statementId,</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">      parameters: parameters</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">    }), cb);</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">198</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.sendWriteLobRequest = function sendWriteLobRequest(cb) {</td></tr><tr class="hit"><td class="line">199</td><td class="hits">14</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">200</td><td class="hits">14</td><td class="source">  var availableSize = self.connection.getAvailableSize();</td></tr><tr class="hit"><td class="line">201</td><td class="hits">14</td><td class="source">  self.writer.getWriteLobRequest(availableSize, function send(err, buffer) {</td></tr><tr class="hit"><td class="line">202</td><td class="hits">14</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">203</td><td class="hits">1</td><td class="source">      return cb(err);</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">205</td><td class="hits">13</td><td class="source">    self.connection.send(request.writeLob({</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">      writeLobRequest: buffer</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">    }), cb);</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">211</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.sendCommit = function sendCommit(cb) {</td></tr><tr class="hit"><td class="line">212</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">213</td><td class="hits">4</td><td class="source">  self.connection.send(request.commit({</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source">    holdCursorsOverCommit: self.holdCursorsOverCommit</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">  }), cb);</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">218</td><td class="hits">1</td><td class="source">ExecuteTask.prototype.sendRollback = function sendRollback(cb) {</td></tr><tr class="hit"><td class="line">219</td><td class="hits">1</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">220</td><td class="hits">1</td><td class="source">  self.connection.send(request.rollback({</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source">    holdCursorsOverCommit: self.holdCursorsOverCommit</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">  }), cb);</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">225</td><td class="hits">1</td><td class="source">function createInvalidFunctionCodeError() {</td></tr><tr class="hit"><td class="line">226</td><td class="hits">1</td><td class="source">  return new Error(</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">    'Invalid functionCode in batch execute. ' +</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">    'Only DDL or DML statements are supported.'</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">  );</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Lob.js">protocol/Lob.js</h2><div id="stats" class="high"><div class="percentage">82%</div><div class="sloc">70</div><div class="hits">58</div><div class="misses">12</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var debug = util.debuglog('hdb_lob');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">module.exports = Lob;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">util.inherits(Lob, EventEmitter);</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">Lob.DEFAULT_READ_SIZE = Math.pow(2, 17);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">Lob.MAX_READ_SIZE = Math.pow(2, 18);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">function Lob(readLob, ld, options) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">4</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  // public</td></tr><tr class="hit"><td class="line">30</td><td class="hits">4</td><td class="source">  this.locatorId = ld.locatorId;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">4</td><td class="source">  this.finished = false;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  // private</td></tr><tr class="hit"><td class="line">33</td><td class="hits">4</td><td class="source">  this._readLob = readLob;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">4</td><td class="source">  this._running = undefined;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">4</td><td class="source">  this._offset = 0;</td></tr><tr class="hit"><td class="line">36</td><td class="hits">4</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">37</td><td class="hits">4</td><td class="source">  this._readSize = options.readSize || Lob.DEFAULT_READ_SIZE;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">4</td><td class="source">  this._data = undefined;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">4</td><td class="source">  if (ld.chunk) {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">4</td><td class="source">    this._data = ld;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">Lob.prototype.pause = function pause() {</td></tr><tr class="miss"><td class="line">45</td><td class="hits">0</td><td class="source">  this._running = false;</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">Lob.prototype.resume = function resume() {</td></tr><tr class="hit"><td class="line">49</td><td class="hits">4</td><td class="source">  if (this._running || this.finished) {</td></tr><tr class="miss"><td class="line">50</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">52</td><td class="hits">4</td><td class="source">  this._running = true;</td></tr><tr class="hit"><td class="line">53</td><td class="hits">4</td><td class="source">  if (util.isObject(this._data)) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">4</td><td class="source">    handleData.call(this, this._data);</td></tr><tr class="hit"><td class="line">55</td><td class="hits">4</td><td class="source">    this._data = undefined;</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">57</td><td class="hits">0</td><td class="source">    sendReadLob.call(this);</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">Lob.prototype.end = function end() {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">4</td><td class="source">  this.finished = true;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">  this._running = false;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">4</td><td class="source">  this._connection = undefined;</td></tr><tr class="hit"><td class="line">65</td><td class="hits">4</td><td class="source">  process.nextTick(emitEnd.bind(this));</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">function emitEnd() {</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">70</td><td class="hits">4</td><td class="source">  debug('emit &quot;end&quot;');</td></tr><tr class="hit"><td class="line">71</td><td class="hits">4</td><td class="source">  this.emit('end');</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">Lob.prototype.read = function read(cb) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">4</td><td class="source">  if (!util.isUndefined(this._running)) {</td></tr><tr class="miss"><td class="line">76</td><td class="hits">0</td><td class="source">    var err = new Error('Lob invalid state error');</td></tr><tr class="miss"><td class="line">77</td><td class="hits">0</td><td class="source">    return cb(err);</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">80</td><td class="hits">4</td><td class="source">  util.readData(this, cb);</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">Lob.prototype.createReadStream = function createReadStream(options) {</td></tr><tr class="miss"><td class="line">84</td><td class="hits">0</td><td class="source">  if (!util.isUndefined(this._running)) {</td></tr><tr class="miss"><td class="line">85</td><td class="hits">0</td><td class="source">    return null;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">88</td><td class="hits">0</td><td class="source">  return util.createReadStream(this, ['error'], options);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">function sendReadLob() {</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">93</td><td class="hits">10</td><td class="source">  debug('sendReadLob', this.locatorId);</td></tr><tr class="hit"><td class="line">94</td><td class="hits">10</td><td class="source">  this._readLob({</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    locatorId: this.locatorId,</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    offset: this._offset + 1,</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    length: this._readSize</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  }, receiveData.bind(this));</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">101</td><td class="hits">1</td><td class="source">function receiveData(err, reply) {</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">103</td><td class="hits">10</td><td class="source">  debug('receiveData()');</td></tr><tr class="hit"><td class="line">104</td><td class="hits">10</td><td class="source">  if (err) {</td></tr><tr class="miss"><td class="line">105</td><td class="hits">0</td><td class="source">    this._running = false;</td></tr><tr class="miss"><td class="line">106</td><td class="hits">0</td><td class="source">    this.emit('error', err);</td></tr><tr class="miss"><td class="line">107</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">110</td><td class="hits">10</td><td class="source">  var data = reply.readLobReply;</td></tr><tr class="hit"><td class="line">111</td><td class="hits">10</td><td class="source">  if (this._running) {</td></tr><tr class="hit"><td class="line">112</td><td class="hits">10</td><td class="source">    handleData.call(this, data);</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">114</td><td class="hits">0</td><td class="source">    this._data = data;</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">118</td><td class="hits">1</td><td class="source">function handleData(data) {</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">120</td><td class="hits">14</td><td class="source">  var size = data.size || this._readSize;</td></tr><tr class="hit"><td class="line">121</td><td class="hits">14</td><td class="source">  debug('handleData(%d)', size);</td></tr><tr class="hit"><td class="line">122</td><td class="hits">14</td><td class="source">  if (Buffer.isBuffer(data.chunk)) {</td></tr><tr class="hit"><td class="line">123</td><td class="hits">14</td><td class="source">    this._offset += size;</td></tr><tr class="hit"><td class="line">124</td><td class="hits">14</td><td class="source">    this.emit('data', data.chunk);</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">127</td><td class="hits">14</td><td class="source">  if (data.isLast) {</td></tr><tr class="hit"><td class="line">128</td><td class="hits">4</td><td class="source">    return this.end();</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">131</td><td class="hits">10</td><td class="source">  if (this._running) {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">10</td><td class="source">    process.nextTick(sendReadLob.bind(this));</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Parser.js">protocol/Parser.js</h2><div id="stats" class="high"><div class="percentage">87%</div><div class="sloc">72</div><div class="hits">63</div><div class="misses">9</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var ResultSetTransform = require('./ResultSetTransform');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Reader = require('./Reader');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var ReadFunction = common.ReadFunction;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">module.exports = Parser;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function Parser(metadata, lobFactory) {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">15</td><td class="source">  this.metadata = metadata;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">15</td><td class="source">  this.lobFactory = lobFactory;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">15</td><td class="source">  this.honest = !!process.browser;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">Parser.create = function createParser(metadata, lobFactory) {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">13</td><td class="source">  return new Parser(metadata, lobFactory);</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">Parser.parseParameters = function parseParameters(metadata, buffer) {</td></tr><tr class="miss"><td class="line">35</td><td class="hits">0</td><td class="source">  return Parser.create(metadata).parseParams(buffer);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">Parser.prototype.createParseRowFunction = function createParseRowFunction() {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">12</td><td class="source">  return this.createParseFunction('columnDisplayName');</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">Parser.prototype.createParseParamsFunction = function createParseParamsFunction() {</td></tr><tr class="miss"><td class="line">43</td><td class="hits">0</td><td class="source">  return this.createParseFunction('name');</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">Parser.prototype.createParseFunction = function createParseFunction(name) {</td></tr><tr class="hit"><td class="line">47</td><td class="hits">14</td><td class="source">  name = name || 'columnDisplayName';</td></tr><tr class="hit"><td class="line">48</td><td class="hits">14</td><td class="source">  if (!this.honest) {</td></tr><tr class="hit"><td class="line">49</td><td class="hits">13</td><td class="source">    return this.createEvilParseFunction(name);</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">  return this.createHonestParseFunction(name);</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">Parser.prototype.createEvilParseFunction = function createParseFunction(name) {</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  /*jshint evil:true */</td></tr><tr class="hit"><td class="line">56</td><td class="hits">13</td><td class="source">  return new Function(createFunctionBody(this.metadata, name));</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">Parser.prototype.createHonestParseFunction = function createHonestParseFunction(</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  name) {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">  function mapColumnMetadata(column, index) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">    var arg;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">    if (column.dataType === TypeCode.DECIMAL) {</td></tr><tr class="miss"><td class="line">65</td><td class="hits">0</td><td class="source">      arg = column.fraction;</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">    var key;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">    if (typeof name === 'string') {</td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">      key = column[name];</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"><td class="line">71</td><td class="hits">0</td><td class="source">      key = index;</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">    return {</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">      key: key,</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">      fname: ReadFunction[column.dataType],</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">      arg: arg</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">79</td><td class="hits">1</td><td class="source">  var columns = this.metadata.map(mapColumnMetadata);</td></tr><tr class="hit"><td class="line">80</td><td class="hits">1</td><td class="source">  return function parseRow() {</td></tr><tr class="hit"><td class="line">81</td><td class="hits">1</td><td class="source">    var column;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">1</td><td class="source">    var obj = {};</td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">    for (var i = 0; i &lt; columns.length; i++) {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">1</td><td class="source">      column = columns[i];</td></tr><tr class="hit"><td class="line">85</td><td class="hits">1</td><td class="source">      obj[column.key] = this[column.fname](column.arg);</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">87</td><td class="hits">1</td><td class="source">    return obj;</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">Parser.prototype.parseParams = function parseParams(buffer) {</td></tr><tr class="miss"><td class="line">92</td><td class="hits">0</td><td class="source">  var reader = new Reader(buffer, this.lobFactory);</td></tr><tr class="miss"><td class="line">93</td><td class="hits">0</td><td class="source">  var parseParamsFunction = this.createParseParamsFunction();</td></tr><tr class="miss"><td class="line">94</td><td class="hits">0</td><td class="source">  return parseParamsFunction.call(reader);</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">97</td><td class="hits">1</td><td class="source">Parser.prototype.parse = function parse(buffer) {</td></tr><tr class="hit"><td class="line">98</td><td class="hits">1</td><td class="source">  var reader = new Reader(buffer, this.lobFactory);</td></tr><tr class="hit"><td class="line">99</td><td class="hits">1</td><td class="source">  var parseRow = this.createParseRowFunction().bind(reader);</td></tr><tr class="hit"><td class="line">100</td><td class="hits">1</td><td class="source">  var rows = [];</td></tr><tr class="hit"><td class="line">101</td><td class="hits">1</td><td class="source">  while (reader.hasMore()) {</td></tr><tr class="hit"><td class="line">102</td><td class="hits">32</td><td class="source">    rows.push(parseRow());</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">104</td><td class="hits">1</td><td class="source">  return rows;</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">107</td><td class="hits">1</td><td class="source">Parser.prototype.createTransform = function createTransform(rs, options) {</td></tr><tr class="hit"><td class="line">108</td><td class="hits">11</td><td class="source">  return new ResultSetTransform(this.createParseRowFunction(), rs, options);</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">111</td><td class="hits">1</td><td class="source">function createFunctionBody(metadata, nameProperty) {</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">113</td><td class="hits">13</td><td class="source">  function addParseColumnLine(column, index) {</td></tr><tr class="hit"><td class="line">114</td><td class="hits">52</td><td class="source">    var fn = ReadFunction[column.dataType];</td></tr><tr class="hit"><td class="line">115</td><td class="hits">52</td><td class="source">    if (column.dataType === TypeCode.DECIMAL) {</td></tr><tr class="miss"><td class="line">116</td><td class="hits">0</td><td class="source">      fn += '(' + column.fraction + ')';</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">118</td><td class="hits">52</td><td class="source">      fn += '()';</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">120</td><td class="hits">52</td><td class="source">    var key;</td></tr><tr class="hit"><td class="line">121</td><td class="hits">52</td><td class="source">    if (typeof nameProperty === 'string') {</td></tr><tr class="hit"><td class="line">122</td><td class="hits">52</td><td class="source">      key = column[nameProperty];</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"><td class="line">124</td><td class="hits">0</td><td class="source">      key = index;</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">126</td><td class="hits">52</td><td class="source">    return '&quot;' + key + '&quot;: this.' + fn;</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">128</td><td class="hits">13</td><td class="source">  var functionBody = 'return {\n';</td></tr><tr class="hit"><td class="line">129</td><td class="hits">13</td><td class="source">  functionBody += metadata.map(addParseColumnLine).join(',\n');</td></tr><tr class="hit"><td class="line">130</td><td class="hits">13</td><td class="source">  functionBody += '\n};';</td></tr><tr class="hit"><td class="line">131</td><td class="hits">13</td><td class="source">  return functionBody;</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Reader.js">protocol/Reader.js</h2><div id="stats" class="high"><div class="percentage">96%</div><div class="sloc">181</div><div class="hits">174</div><div class="misses">7</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var bignum = util.bignum;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var LobOptions = common.LobOptions;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var LobSourceType = common.LobSourceType;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">module.exports = Reader;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function Reader(buffer, lobFactoy) {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">33</td><td class="source">  this.buffer = buffer;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">33</td><td class="source">  this.offset = 0;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">33</td><td class="source">  this.lobFactoy = lobFactoy;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">Reader.prototype.hasMore = function hasMore() {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">512</td><td class="source">  return this.offset &lt; this.buffer.length;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">Reader.prototype.readTinyInt = function readTinyInt() {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">35</td><td class="source">  if (this.buffer[this.offset++] === 0x00) {</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">38</td><td class="hits">34</td><td class="source">  var value = this.buffer.readUInt8(this.offset, true);</td></tr><tr class="hit"><td class="line">39</td><td class="hits">34</td><td class="source">  this.offset += 1;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">34</td><td class="source">  return value;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">Reader.prototype.readSmallInt = function readSmallInt() {</td></tr><tr class="hit"><td class="line">44</td><td class="hits">35</td><td class="source">  if (this.buffer[this.offset++] === 0x00) {</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">47</td><td class="hits">34</td><td class="source">  var value = this.buffer.readInt16LE(this.offset, true);</td></tr><tr class="hit"><td class="line">48</td><td class="hits">34</td><td class="source">  this.offset += 2;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">34</td><td class="source">  return value;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">Reader.prototype.readInt = function readInt() {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">429</td><td class="source">  if (this.buffer[this.offset++] === 0x00) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">56</td><td class="hits">428</td><td class="source">  var value = this.buffer.readInt32LE(this.offset, true);</td></tr><tr class="hit"><td class="line">57</td><td class="hits">428</td><td class="source">  this.offset += 4;</td></tr><tr class="hit"><td class="line">58</td><td class="hits">428</td><td class="source">  return value;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">Reader.prototype.readBigInt = function readBigInt() {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">35</td><td class="source">  if (this.buffer[this.offset++] === 0x00) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">65</td><td class="hits">34</td><td class="source">  var value = bignum.readInt64LE(this.buffer, this.offset);</td></tr><tr class="hit"><td class="line">66</td><td class="hits">34</td><td class="source">  this.offset += 8;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">34</td><td class="source">  return value;</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">Reader.prototype.readString = function readString() {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">1265</td><td class="source">  return this.readBytes('utf-8');</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">Reader.prototype.readBinary = function readBinary() {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">4</td><td class="source">  return this.readBytes();</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">78</td><td class="hits">1</td><td class="source">Reader.prototype.readBytes = function readBytes(encoding) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">1269</td><td class="source">  var length = this.buffer[this.offset++];</td></tr><tr class="hit"><td class="line">80</td><td class="hits">1269</td><td class="source">  switch (length) {</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">  case 0xff:</td></tr><tr class="hit"><td class="line">82</td><td class="hits">386</td><td class="source">    return null;</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  case 0xf6:</td></tr><tr class="hit"><td class="line">84</td><td class="hits">1</td><td class="source">    length = this.buffer.readInt16LE(this.offset, true);</td></tr><tr class="hit"><td class="line">85</td><td class="hits">1</td><td class="source">    this.offset += 2;</td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">    break;</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  case 0xf7:</td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">    length = this.buffer.readInt32LE(this.offset, true);</td></tr><tr class="hit"><td class="line">89</td><td class="hits">1</td><td class="source">    this.offset += 4;</td></tr><tr class="hit"><td class="line">90</td><td class="hits">1</td><td class="source">    break;</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">92</td><td class="hits">883</td><td class="source">  var value;</td></tr><tr class="hit"><td class="line">93</td><td class="hits">883</td><td class="source">  if (encoding) {</td></tr><tr class="hit"><td class="line">94</td><td class="hits">880</td><td class="source">    value = this.buffer.toString(encoding, this.offset, this.offset + length);</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">3</td><td class="source">    value = new Buffer(length);</td></tr><tr class="hit"><td class="line">97</td><td class="hits">3</td><td class="source">    this.buffer.copy(value, 0, this.offset, this.offset + length);</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">99</td><td class="hits">883</td><td class="source">  this.offset += length;</td></tr><tr class="hit"><td class="line">100</td><td class="hits">883</td><td class="source">  return value;</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">Reader.prototype.readDate = function readDate() {</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">105</td><td class="hits">7</td><td class="source">  var high = this.buffer[this.offset + 1];</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  // msb not set ==&gt; null</td></tr><tr class="hit"><td class="line">107</td><td class="hits">7</td><td class="source">  if (!(high &amp; 0x80)) {</td></tr><tr class="hit"><td class="line">108</td><td class="hits">3</td><td class="source">    this.offset += 4;</td></tr><tr class="hit"><td class="line">109</td><td class="hits">3</td><td class="source">    return null;</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">111</td><td class="hits">4</td><td class="source">  var year = this.buffer[this.offset];</td></tr><tr class="hit"><td class="line">112</td><td class="hits">4</td><td class="source">  this.offset += 2;</td></tr><tr class="hit"><td class="line">113</td><td class="hits">4</td><td class="source">  var month = this.buffer[this.offset] + 1;</td></tr><tr class="hit"><td class="line">114</td><td class="hits">4</td><td class="source">  this.offset += 1;</td></tr><tr class="hit"><td class="line">115</td><td class="hits">4</td><td class="source">  var day = this.buffer[this.offset];</td></tr><tr class="hit"><td class="line">116</td><td class="hits">4</td><td class="source">  this.offset += 1;</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">  // msb set ==&gt; not null</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">  // unset msb and second most sb</td></tr><tr class="hit"><td class="line">119</td><td class="hits">4</td><td class="source">  high &amp;= 0x3f;</td></tr><tr class="hit"><td class="line">120</td><td class="hits">4</td><td class="source">  year |= high &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">121</td><td class="hits">4</td><td class="source">  return util.lpad4(year) + '-' +</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">    util.lpad2(month) + '-' +</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">    util.lpad2(day);</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">126</td><td class="hits">1</td><td class="source">Reader.prototype.readTime = function readTime() {</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">128</td><td class="hits">6</td><td class="source">  var hour = this.buffer[this.offset];</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">  // msb not set ==&gt; null</td></tr><tr class="hit"><td class="line">130</td><td class="hits">6</td><td class="source">  if (!(hour &amp; 0x80)) {</td></tr><tr class="hit"><td class="line">131</td><td class="hits">3</td><td class="source">    this.offset += 4;</td></tr><tr class="hit"><td class="line">132</td><td class="hits">3</td><td class="source">    return null;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">134</td><td class="hits">3</td><td class="source">  var min = this.buffer[this.offset + 1];</td></tr><tr class="hit"><td class="line">135</td><td class="hits">3</td><td class="source">  this.offset += 2;</td></tr><tr class="hit"><td class="line">136</td><td class="hits">3</td><td class="source">  var msec = this.buffer.readUInt16LE(this.offset, true);</td></tr><tr class="hit"><td class="line">137</td><td class="hits">3</td><td class="source">  this.offset += 2;</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">  // msb set ==&gt; not null</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source">  // unset msb</td></tr><tr class="hit"><td class="line">140</td><td class="hits">3</td><td class="source">  hour &amp;= 0x7f;</td></tr><tr class="hit"><td class="line">141</td><td class="hits">3</td><td class="source">  return util.lpad2(hour) + ':' +</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">    util.lpad2(min) + ':' +</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">    util.lpad2(msec / 1000);</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">146</td><td class="hits">1</td><td class="source">Reader.prototype.readTimestamp = function readTimestamp() {</td></tr><tr class="hit"><td class="line">147</td><td class="hits">4</td><td class="source">  var date = this.readDate();</td></tr><tr class="hit"><td class="line">148</td><td class="hits">4</td><td class="source">  var time = this.readTime();</td></tr><tr class="hit"><td class="line">149</td><td class="hits">4</td><td class="source">  if (date) {</td></tr><tr class="hit"><td class="line">150</td><td class="hits">2</td><td class="source">    if (time) {</td></tr><tr class="hit"><td class="line">151</td><td class="hits">1</td><td class="source">      return date + 'T' + time;</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">153</td><td class="hits">1</td><td class="source">    return date + 'T00:00:00';</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">155</td><td class="hits">2</td><td class="source">  if (time) {</td></tr><tr class="hit"><td class="line">156</td><td class="hits">1</td><td class="source">    return '0001-01-01T' + time;</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">158</td><td class="hits">1</td><td class="source">  return null;</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">161</td><td class="hits">1</td><td class="source">Reader.prototype.readDayDate = function readDayDate() {</td></tr><tr class="hit"><td class="line">162</td><td class="hits">3</td><td class="source">  var value = this.buffer.readInt32LE(this.offset, true);</td></tr><tr class="hit"><td class="line">163</td><td class="hits">3</td><td class="source">  this.offset += 4;</td></tr><tr class="hit"><td class="line">164</td><td class="hits">3</td><td class="source">  if (value === 3652062 || value === 0) {</td></tr><tr class="hit"><td class="line">165</td><td class="hits">2</td><td class="source">    return null;</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">167</td><td class="hits">1</td><td class="source">  return value - 1;</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">Reader.prototype.readSecondTime = function readSecondTime() {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">3</td><td class="source">  var value = this.buffer.readInt32LE(this.offset, true);</td></tr><tr class="hit"><td class="line">172</td><td class="hits">3</td><td class="source">  this.offset += 4;</td></tr><tr class="hit"><td class="line">173</td><td class="hits">3</td><td class="source">  if (value === 86402 || value === 0) {</td></tr><tr class="hit"><td class="line">174</td><td class="hits">2</td><td class="source">    return null;</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">176</td><td class="hits">1</td><td class="source">  return value - 1;</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">179</td><td class="hits">1</td><td class="source">Reader.prototype.readSecondDate = function readSecondDate() {</td></tr><tr class="hit"><td class="line">180</td><td class="hits">3</td><td class="source">  var value = bignum.readInt64LE(this.buffer, this.offset);</td></tr><tr class="hit"><td class="line">181</td><td class="hits">3</td><td class="source">  this.offset += 8;</td></tr><tr class="hit"><td class="line">182</td><td class="hits">3</td><td class="source">  if (value === 315538070401 || value === 0) {</td></tr><tr class="hit"><td class="line">183</td><td class="hits">2</td><td class="source">    return null;</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">185</td><td class="hits">1</td><td class="source">  return value - 1;</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">188</td><td class="hits">1</td><td class="source">Reader.prototype.readLongDate = function readLongDate() {</td></tr><tr class="hit"><td class="line">189</td><td class="hits">3</td><td class="source">  var value = bignum.readInt64LE(this.buffer, this.offset);</td></tr><tr class="hit"><td class="line">190</td><td class="hits">3</td><td class="source">  this.offset += 8;</td></tr><tr class="hit"><td class="line">191</td><td class="hits">3</td><td class="source">  if (value === '3155380704000000001' || value === 0) {</td></tr><tr class="hit"><td class="line">192</td><td class="hits">2</td><td class="source">    return null;</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">194</td><td class="hits">1</td><td class="source">  if (typeof value === 'string') {</td></tr><tr class="miss"><td class="line">195</td><td class="hits">0</td><td class="source">    var index = value.length - 7;</td></tr><tr class="miss"><td class="line">196</td><td class="hits">0</td><td class="source">    return value.substring(0, index) + util.lpad7(value.substring(index) -</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">      1);</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">199</td><td class="hits">1</td><td class="source">    return value - 1;</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">203</td><td class="hits">1</td><td class="source">Reader.prototype.readBLob = function readBLob() {</td></tr><tr class="hit"><td class="line">204</td><td class="hits">4</td><td class="source">  return this.readLob(1);</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">207</td><td class="hits">1</td><td class="source">Reader.prototype.readCLob = function readCLob() {</td></tr><tr class="miss"><td class="line">208</td><td class="hits">0</td><td class="source">  return this.readLob(2);</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">211</td><td class="hits">1</td><td class="source">Reader.prototype.readNCLob = function readNCLob() {</td></tr><tr class="hit"><td class="line">212</td><td class="hits">32</td><td class="source">  return this.readLob(3);</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">215</td><td class="hits">1</td><td class="source">Reader.prototype.readLob = function readLob(type) {</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">  /* jshint bitwise:false, unused:false */</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">  // offset 0</td></tr><tr class="hit"><td class="line">218</td><td class="hits">36</td><td class="source">  type = this.buffer[this.offset] || type;</td></tr><tr class="hit"><td class="line">219</td><td class="hits">36</td><td class="source">  this.offset += 1;</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">  // offset 1</td></tr><tr class="hit"><td class="line">221</td><td class="hits">36</td><td class="source">  var options = this.buffer[this.offset];</td></tr><tr class="hit"><td class="line">222</td><td class="hits">36</td><td class="source">  this.offset += 1;</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">  // offset 2</td></tr><tr class="hit"><td class="line">224</td><td class="hits">36</td><td class="source">  if (options &amp; LobOptions.NULL_INDICATOR) {</td></tr><tr class="hit"><td class="line">225</td><td class="hits">32</td><td class="source">    return null;</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">  // skip 2 byte filler</td></tr><tr class="hit"><td class="line">228</td><td class="hits">4</td><td class="source">  this.offset += 2;</td></tr><tr><td class="line">229</td><td class="hits"></td><td class="source">  // offset 4</td></tr><tr class="hit"><td class="line">230</td><td class="hits">4</td><td class="source">  var charLength = bignum.readInt64LE(this.buffer, this.offset);</td></tr><tr class="hit"><td class="line">231</td><td class="hits">4</td><td class="source">  this.offset += 8;</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">  // offset 12</td></tr><tr class="hit"><td class="line">233</td><td class="hits">4</td><td class="source">  var byteLength = bignum.readInt64LE(this.buffer, this.offset);</td></tr><tr class="hit"><td class="line">234</td><td class="hits">4</td><td class="source">  this.offset += 8;</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">  // offset 20</td></tr><tr class="hit"><td class="line">236</td><td class="hits">4</td><td class="source">  var locatorId = this.buffer.slice(this.offset, this.offset + 8);</td></tr><tr class="hit"><td class="line">237</td><td class="hits">4</td><td class="source">  this.offset += 8;</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">  // offset 28</td></tr><tr class="hit"><td class="line">239</td><td class="hits">4</td><td class="source">  var chunkLength = this.buffer.readInt32LE(this.offset, true);</td></tr><tr class="hit"><td class="line">240</td><td class="hits">4</td><td class="source">  this.offset += 4;</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">  // offset 32</td></tr><tr class="hit"><td class="line">242</td><td class="hits">4</td><td class="source">  var chunk = null;</td></tr><tr class="hit"><td class="line">243</td><td class="hits">4</td><td class="source">  if (chunkLength &gt; 0) {</td></tr><tr class="hit"><td class="line">244</td><td class="hits">4</td><td class="source">    chunk = this.buffer.slice(this.offset, this.offset + chunkLength);</td></tr><tr class="hit"><td class="line">245</td><td class="hits">4</td><td class="source">    this.offset += chunkLength;</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">247</td><td class="hits">0</td><td class="source">    chunk = new Buffer(0);</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">  //if (!byteLength &amp;&amp; !charLength) { return null; }</td></tr><tr class="hit"><td class="line">250</td><td class="hits">4</td><td class="source">  return this.lobFactoy.createLob(new LobDescriptor(type, locatorId, options,</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">    chunk));</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">253</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">254</td><td class="hits">1</td><td class="source">Reader.prototype.readDouble = function readDouble() {</td></tr><tr class="hit"><td class="line">255</td><td class="hits">5</td><td class="source">  if (this.buffer[this.offset] === 0xff &amp;&amp;</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 1] === 0xff &amp;&amp;</td></tr><tr><td class="line">257</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 2] === 0xff &amp;&amp;</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 3] === 0xff &amp;&amp;</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 4] === 0xff &amp;&amp;</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 5] === 0xff &amp;&amp;</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 6] === 0xff &amp;&amp;</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 7] === 0xff) {</td></tr><tr class="hit"><td class="line">263</td><td class="hits">1</td><td class="source">    this.offset += 8;</td></tr><tr class="hit"><td class="line">264</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">266</td><td class="hits">4</td><td class="source">  var value = this.buffer.readDoubleLE(this.offset, true);</td></tr><tr class="hit"><td class="line">267</td><td class="hits">4</td><td class="source">  this.offset += 8;</td></tr><tr class="hit"><td class="line">268</td><td class="hits">4</td><td class="source">  return value;</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">271</td><td class="hits">1</td><td class="source">Reader.prototype.readFloat = function readFloat() {</td></tr><tr class="hit"><td class="line">272</td><td class="hits">5</td><td class="source">  if (this.buffer[this.offset] === 0xff &amp;&amp;</td></tr><tr><td class="line">273</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 1] === 0xff &amp;&amp;</td></tr><tr><td class="line">274</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 2] === 0xff &amp;&amp;</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">    this.buffer[this.offset + 3] === 0xff) {</td></tr><tr class="hit"><td class="line">276</td><td class="hits">1</td><td class="source">    this.offset += 4;</td></tr><tr class="hit"><td class="line">277</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">279</td><td class="hits">4</td><td class="source">  var value = this.buffer.readFloatLE(this.offset, true);</td></tr><tr class="hit"><td class="line">280</td><td class="hits">4</td><td class="source">  this.offset += 4;</td></tr><tr class="hit"><td class="line">281</td><td class="hits">4</td><td class="source">  return value;</td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">284</td><td class="hits">1</td><td class="source">Reader.prototype.readDecimal = function readDecimal(fraction) {</td></tr><tr class="hit"><td class="line">285</td><td class="hits">2</td><td class="source">  var value;</td></tr><tr class="hit"><td class="line">286</td><td class="hits">2</td><td class="source">  if (fraction &gt; 34) {</td></tr><tr class="hit"><td class="line">287</td><td class="hits">1</td><td class="source">    value = bignum.readDecFloat(this.buffer, this.offset);</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">289</td><td class="hits">1</td><td class="source">    value = bignum.readDecFixed(this.buffer, this.offset, fraction);</td></tr><tr><td class="line">290</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">291</td><td class="hits">2</td><td class="source">  this.offset += 16;</td></tr><tr class="hit"><td class="line">292</td><td class="hits">2</td><td class="source">  return value;</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">295</td><td class="hits">1</td><td class="source">function LobDescriptor(type, locatorId, options, chunk) {</td></tr><tr class="hit"><td class="line">296</td><td class="hits">4</td><td class="source">  this.locatorId = locatorId;</td></tr><tr class="hit"><td class="line">297</td><td class="hits">4</td><td class="source">  this.options = options;</td></tr><tr class="hit"><td class="line">298</td><td class="hits">4</td><td class="source">  if (Buffer.isBuffer(chunk)) {</td></tr><tr class="hit"><td class="line">299</td><td class="hits">4</td><td class="source">    this.chunk = chunk;</td></tr><tr class="hit"><td class="line">300</td><td class="hits">4</td><td class="source">    if (type === LobSourceType.CLOB || type === LobSourceType.NCLOB) {</td></tr><tr class="miss"><td class="line">301</td><td class="hits">0</td><td class="source">      this.size = chunk.toString('utf-8').length;</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">303</td><td class="hits">4</td><td class="source">      this.size = chunk.length;</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">305</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">306</td><td class="hits">0</td><td class="source">    this.chunk = undefined;</td></tr><tr class="miss"><td class="line">307</td><td class="hits">0</td><td class="source">    this.size = 0;</td></tr><tr><td class="line">308</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">311</td><td class="hits">1</td><td class="source">Object.defineProperties(LobDescriptor.prototype, {</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">  isLast: {</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">    get: function isLast() {</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">      /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">315</td><td class="hits">4</td><td class="source">      return !!(this.options &amp; LobOptions.LAST_DATA);</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">318</td><td class="hits"></td><td class="source">});</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Result.js">protocol/Result.js</h2><div id="stats" class="medium"><div class="percentage">74%</div><div class="sloc">131</div><div class="hits">98</div><div class="misses">33</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var ResultSet = require('./ResultSet');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Parser = require('./Parser');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var Lob = require('./Lob');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var FunctionCode = common.FunctionCode;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">module.exports = Result;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">function Result(connection, options) {</td></tr><tr class="hit"><td class="line">27</td><td class="hits">15</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">28</td><td class="hits">15</td><td class="source">  this._connection = connection;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">15</td><td class="source">  this._autoFetch = !!options.autoFetch;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">15</td><td class="source">  this._readSize = options.readSize || Lob.DEFAULT_READ_SIZE;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">15</td><td class="source">  this._resultSetMetadata = undefined;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">15</td><td class="source">  this._parameterMetadata = undefined;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">Result.prototype.setResultSetMetadata = function setResultSetMetadata(</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  metadata) {</td></tr><tr class="hit"><td class="line">37</td><td class="hits">8</td><td class="source">  this._resultSetMetadata = metadata;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">Result.prototype.setParameterMetadata = function setParameterMetadata(</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  metadata) {</td></tr><tr class="hit"><td class="line">42</td><td class="hits">8</td><td class="source">  this._parameterMetadata = metadata;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">Result.prototype.getLobColumnNames = function getLobColumnNames() {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">2</td><td class="source">  if (this._parameterMetadata) {</td></tr><tr class="hit"><td class="line">47</td><td class="hits">2</td><td class="source">    return this._parameterMetadata.filter(isLob).map(getColumName);</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">49</td><td class="hits">0</td><td class="source">  return [];</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">Result.prototype.handle = function handle(err, reply, cb) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">15</td><td class="source">  if (err) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">    return cb(err);</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">14</td><td class="source">  switch (reply.functionCode) {</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  case FunctionCode.SELECT:</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  case FunctionCode.SELECT_FOR_UPDATE:</td></tr><tr class="hit"><td class="line">60</td><td class="hits">9</td><td class="source">    this.handleQuery(cb, this.createResultSets(reply.resultSets));</td></tr><tr class="hit"><td class="line">61</td><td class="hits">9</td><td class="source">    return;</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  case FunctionCode.INSERT:</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  case FunctionCode.UPDATE:</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  case FunctionCode.DELETE:</td></tr><tr class="hit"><td class="line">65</td><td class="hits">3</td><td class="source">    this.handleModify(cb, reply.rowsAffected);</td></tr><tr class="hit"><td class="line">66</td><td class="hits">3</td><td class="source">    return;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  case FunctionCode.DDL:</td></tr><tr class="miss"><td class="line">68</td><td class="hits">0</td><td class="source">    cb(null);</td></tr><tr class="miss"><td class="line">69</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  case FunctionCode.DB_PROCEDURE_CALL:</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  case FunctionCode.DB_PROCEDURE_CALL_WITH_RESULT:</td></tr><tr class="hit"><td class="line">72</td><td class="hits">2</td><td class="source">    this.handleDBCall(cb,</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">      this.createOutputParameters(reply.outputParameters),</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">      this.createResultSets(reply.resultSets));</td></tr><tr class="hit"><td class="line">75</td><td class="hits">2</td><td class="source">    return;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  default:</td></tr><tr class="miss"><td class="line">77</td><td class="hits">0</td><td class="source">    err = new Error('Invalid or unsupported FunctionCode');</td></tr><tr class="miss"><td class="line">78</td><td class="hits">0</td><td class="source">    cb(err);</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">82</td><td class="hits">1</td><td class="source">Result.prototype.handleModify = function handleModify(cb, rowsAffected) {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">3</td><td class="source">  cb(null, rowsAffected);</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">Result.prototype.handleQuery = function handleQuery(cb, resultSets) {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">9</td><td class="source">  function done(err, results) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">9</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">89</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">91</td><td class="hits">9</td><td class="source">    var args = [null];</td></tr><tr class="hit"><td class="line">92</td><td class="hits">9</td><td class="source">    Array.prototype.push.apply(args, results);</td></tr><tr class="hit"><td class="line">93</td><td class="hits">9</td><td class="source">    return cb.apply(null, args);</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">96</td><td class="hits">9</td><td class="source">  if (!this._autoFetch) {</td></tr><tr class="hit"><td class="line">97</td><td class="hits">3</td><td class="source">    return done(null, resultSets);</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">99</td><td class="hits">6</td><td class="source">  fetchAll(resultSets, done);</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">102</td><td class="hits">1</td><td class="source">Result.prototype.handleDBCall = function handleDBCall(cb, params, resultSets) {</td></tr><tr class="hit"><td class="line">103</td><td class="hits">2</td><td class="source">  params = params || {};</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">105</td><td class="hits">2</td><td class="source">  function done(err, results) {</td></tr><tr class="hit"><td class="line">106</td><td class="hits">2</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">107</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">109</td><td class="hits">2</td><td class="source">    var args = [null, params];</td></tr><tr class="hit"><td class="line">110</td><td class="hits">2</td><td class="source">    Array.prototype.push.apply(args, results);</td></tr><tr class="hit"><td class="line">111</td><td class="hits">2</td><td class="source">    return cb.apply(null, args);</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">114</td><td class="hits">2</td><td class="source">  if (!this._autoFetch) {</td></tr><tr class="miss"><td class="line">115</td><td class="hits">0</td><td class="source">    return done(null, resultSets);</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">118</td><td class="hits">2</td><td class="source">  function fetchResults(err) {</td></tr><tr class="hit"><td class="line">119</td><td class="hits">2</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">120</td><td class="hits">0</td><td class="source">      return done(err);</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">122</td><td class="hits">2</td><td class="source">    fetchAll(resultSets, done);</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">125</td><td class="hits">2</td><td class="source">  readLobs(this.getLobColumnNames(), params, fetchResults);</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">128</td><td class="hits">1</td><td class="source">Result.prototype.createLob = function createLob(ld, options) {</td></tr><tr class="miss"><td class="line">129</td><td class="hits">0</td><td class="source">  options = util.extend({</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source">    readSize: this._readSize</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">  }, options);</td></tr><tr class="miss"><td class="line">132</td><td class="hits">0</td><td class="source">  return new Lob(sendReadLob.bind(this), ld, options);</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">135</td><td class="hits">1</td><td class="source">function sendReadLob(req, cb) {</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="miss"><td class="line">137</td><td class="hits">0</td><td class="source">  this._connection.readLob(req, cb);</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">139</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">140</td><td class="hits">1</td><td class="source">function createResultSets(resultSets) {</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">142</td><td class="hits">11</td><td class="source">  resultSets = resultSets || [];</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">  // handle missing resultSet metadata</td></tr><tr class="hit"><td class="line">144</td><td class="hits">11</td><td class="source">  if (this._resultSetMetadata &amp;&amp; resultSets.length) {</td></tr><tr class="hit"><td class="line">145</td><td class="hits">2</td><td class="source">    if (!resultSets[0].metadata) {</td></tr><tr class="hit"><td class="line">146</td><td class="hits">2</td><td class="source">      resultSets[0].metadata = this._resultSetMetadata;</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">149</td><td class="hits">11</td><td class="source">  return resultSets.map(createResultSet, this._connection);</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">151</td><td class="hits">1</td><td class="source">Result.prototype.createResultSets = createResultSets;</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">153</td><td class="hits">1</td><td class="source">function createOutputParameters(outputParameters) {</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">155</td><td class="hits">2</td><td class="source">  if (this._parameterMetadata &amp;&amp; util.isObject(outputParameters)) {</td></tr><tr class="miss"><td class="line">156</td><td class="hits">0</td><td class="source">    var parser = Parser.create(this._parameterMetadata, this);</td></tr><tr class="miss"><td class="line">157</td><td class="hits">0</td><td class="source">    return parser.parseParams(outputParameters.buffer);</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">159</td><td class="hits">2</td><td class="source">  return null;</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">161</td><td class="hits">1</td><td class="source">Result.prototype.createOutputParameters = createOutputParameters;</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">163</td><td class="hits">1</td><td class="source">function createResultSet(rsd) {</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">165</td><td class="hits">11</td><td class="source">  return new ResultSet(this, rsd);</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">168</td><td class="hits">1</td><td class="source">function fetchAll(resultSets, cb) {</td></tr><tr class="hit"><td class="line">169</td><td class="hits">8</td><td class="source">  var results = [];</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">171</td><td class="hits">8</td><td class="source">  function isOpen(rs) {</td></tr><tr class="hit"><td class="line">172</td><td class="hits">8</td><td class="source">    return !rs.closed;</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">175</td><td class="hits">8</td><td class="source">  function handleClose(err) {</td></tr><tr class="miss"><td class="line">176</td><td class="hits">0</td><td class="source">    if (err) {</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">      // ignore errors</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">181</td><td class="hits">8</td><td class="source">  function close(rs) {</td></tr><tr class="hit"><td class="line">182</td><td class="hits">1</td><td class="source">    rs.close(handleClose);</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">185</td><td class="hits">8</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">186</td><td class="hits">8</td><td class="source">    resultSets.filter(isOpen).forEach(close);</td></tr><tr class="hit"><td class="line">187</td><td class="hits">8</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">188</td><td class="hits">0</td><td class="source">      return cb(err);</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">190</td><td class="hits">8</td><td class="source">    cb(null, results);</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">193</td><td class="hits">8</td><td class="source">  function next(i) {</td></tr><tr class="hit"><td class="line">194</td><td class="hits">16</td><td class="source">    if (i === resultSets.length) {</td></tr><tr class="hit"><td class="line">195</td><td class="hits">8</td><td class="source">      return done(null);</td></tr><tr><td class="line">196</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">198</td><td class="hits">8</td><td class="source">    function handleFetch(err, rows) {</td></tr><tr class="hit"><td class="line">199</td><td class="hits">8</td><td class="source">      if (err) {</td></tr><tr class="miss"><td class="line">200</td><td class="hits">0</td><td class="source">        return done(err);</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">202</td><td class="hits">8</td><td class="source">      results.push(rows);</td></tr><tr class="hit"><td class="line">203</td><td class="hits">8</td><td class="source">      process.nextTick(next.bind(null, i + 1));</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">205</td><td class="hits">8</td><td class="source">    resultSets[i].fetch(handleFetch);</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">207</td><td class="hits">8</td><td class="source">  next(0);</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">210</td><td class="hits">1</td><td class="source">function readLobs(keys, params, cb) {</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">212</td><td class="hits">2</td><td class="source">  function next(i) {</td></tr><tr class="hit"><td class="line">213</td><td class="hits">2</td><td class="source">    if (i === keys.length) {</td></tr><tr class="hit"><td class="line">214</td><td class="hits">2</td><td class="source">      return cb(null);</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">217</td><td class="hits">0</td><td class="source">    var name = keys[i];</td></tr><tr class="miss"><td class="line">218</td><td class="hits">0</td><td class="source">    var lob = params[name];</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">220</td><td class="hits">0</td><td class="source">    function processNext() {</td></tr><tr class="miss"><td class="line">221</td><td class="hits">0</td><td class="source">      process.nextTick(next.bind(null, i + 1));</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"><td class="line">223</td><td class="hits">0</td><td class="source">    if (!(lob instanceof Lob)) {</td></tr><tr class="miss"><td class="line">224</td><td class="hits">0</td><td class="source">      return processNext();</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">227</td><td class="hits">0</td><td class="source">    function handleRead(err, buffer) {</td></tr><tr class="miss"><td class="line">228</td><td class="hits">0</td><td class="source">      if (err) {</td></tr><tr class="miss"><td class="line">229</td><td class="hits">0</td><td class="source">        return cb(err);</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">231</td><td class="hits">0</td><td class="source">      params[name] = buffer;</td></tr><tr class="miss"><td class="line">232</td><td class="hits">0</td><td class="source">      process.nextTick(next.bind(null, i + 1));</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"><td class="line">234</td><td class="hits">0</td><td class="source">    lob.read(handleRead);</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">236</td><td class="hits">2</td><td class="source">  next(0);</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">239</td><td class="hits">1</td><td class="source">function isLob(column) {</td></tr><tr class="miss"><td class="line">240</td><td class="hits">0</td><td class="source">  switch (column.dataType) {</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">  case TypeCode.BLOB:</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source">  case TypeCode.LOCATOR:</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">  case TypeCode.CLOB:</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">  case TypeCode.NCLOB:</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">  case TypeCode.NLOCATOR:</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">  case TypeCode.TEXT:</td></tr><tr class="miss"><td class="line">247</td><td class="hits">0</td><td class="source">    return true;</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source">  default:</td></tr><tr class="miss"><td class="line">249</td><td class="hits">0</td><td class="source">    return false;</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">253</td><td class="hits">1</td><td class="source">function getColumName(column) {</td></tr><tr class="miss"><td class="line">254</td><td class="hits">0</td><td class="source">  return column.name;</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/ResultSet.js">protocol/ResultSet.js</h2><div id="stats" class="high"><div class="percentage">77%</div><div class="sloc">205</div><div class="hits">159</div><div class="misses">46</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var Parser = require('./Parser');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var Lob = require('./Lob');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var ResultSetAttributes = common.ResultSetAttributes;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var debug = util.debuglog('hdb_rs');</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">module.exports = ResultSet;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">util.inherits(ResultSet, EventEmitter);</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">ResultSet.MAX_FETCH_SIZE = Math.pow(2, 15) - 1;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">ResultSet.DEFAULT_FETCH_SIZE = Math.pow(2, 10);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">ResultSet.DEFAULT_ROW_LENGTH = Math.pow(2, 6);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">ResultSet.DEFAULT_ARRAY_LENGTH = Math.pow(2, 8);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">function ResultSet(connection, rsd) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">11</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  // public</td></tr><tr class="hit"><td class="line">37</td><td class="hits">11</td><td class="source">  this.id = rsd.id;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">11</td><td class="source">  this.metadata = rsd.metadata;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">11</td><td class="source">  this.closed = false;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">11</td><td class="source">  this.finished = false;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  // private</td></tr><tr class="hit"><td class="line">42</td><td class="hits">11</td><td class="source">  this._connection = connection;</td></tr><tr class="hit"><td class="line">43</td><td class="hits">11</td><td class="source">  this._running = undefined;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">11</td><td class="source">  this._data = rsd.data;</td></tr><tr class="hit"><td class="line">45</td><td class="hits">11</td><td class="source">  this._close = false;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">11</td><td class="source">  this._fetchSize = ResultSet.DEFAULT_FETCH_SIZE;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">11</td><td class="source">  this._rowLength = ResultSet.DEFAULT_ROW_LENGTH;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">11</td><td class="source">  this._readSize = Lob.DEFAULT_READ_SIZE;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">ResultSet.create = function createResultSet(connection, rsd) {</td></tr><tr class="miss"><td class="line">52</td><td class="hits">0</td><td class="source">  return new ResultSet(connection, rsd);</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">Object.defineProperties(ResultSet.prototype, {</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  fetchSize: {</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    get: function getFetchSize() {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">8</td><td class="source">      return this._fetchSize;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  averageRowLength: {</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    get: function getAverageRowLength() {</td></tr><tr class="miss"><td class="line">63</td><td class="hits">0</td><td class="source">      return this._rowLength;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  readSize: {</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    get: function getReadSize() {</td></tr><tr class="miss"><td class="line">68</td><td class="hits">0</td><td class="source">      return this._readSize;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">ResultSet.prototype.setFetchSize = function setFetchSize(fetchSize) {</td></tr><tr class="miss"><td class="line">74</td><td class="hits">0</td><td class="source">  if (fetchSize &gt; ResultSet.MAX_FETCH_SIZE) {</td></tr><tr class="miss"><td class="line">75</td><td class="hits">0</td><td class="source">    this._fetchSize = ResultSet.MAX_FETCH_SIZE;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">77</td><td class="hits">0</td><td class="source">  this._fetchSize = fetchSize;</td></tr><tr class="miss"><td class="line">78</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">81</td><td class="hits">1</td><td class="source">ResultSet.prototype.setAverageRowLength = function setAverageRowLength(length) {</td></tr><tr class="miss"><td class="line">82</td><td class="hits">0</td><td class="source">  this._rowLength = length;</td></tr><tr class="miss"><td class="line">83</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">ResultSet.prototype.setReadSize = function setReadSize(readSize) {</td></tr><tr class="miss"><td class="line">87</td><td class="hits">0</td><td class="source">  if (readSize &gt; Lob.MAX_READ_SIZE) {</td></tr><tr class="miss"><td class="line">88</td><td class="hits">0</td><td class="source">    this._readSize = Lob.MAX_READ_SIZE;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">90</td><td class="hits">0</td><td class="source">  this._readSize = readSize;</td></tr><tr class="miss"><td class="line">91</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">94</td><td class="hits">1</td><td class="source">ResultSet.prototype.pause = function pause() {</td></tr><tr class="miss"><td class="line">95</td><td class="hits">0</td><td class="source">  this._running = false;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">98</td><td class="hits">1</td><td class="source">ResultSet.prototype.resume = function resume() {</td></tr><tr class="hit"><td class="line">99</td><td class="hits">19</td><td class="source">  if (this._running || this.finished) {</td></tr><tr class="hit"><td class="line">100</td><td class="hits">8</td><td class="source">    return;</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">102</td><td class="hits">11</td><td class="source">  this._running = true;</td></tr><tr class="hit"><td class="line">103</td><td class="hits">11</td><td class="source">  if (util.isObject(this._data)) {</td></tr><tr class="hit"><td class="line">104</td><td class="hits">11</td><td class="source">    handleData.call(this, this._data);</td></tr><tr class="hit"><td class="line">105</td><td class="hits">11</td><td class="source">    this._data = undefined;</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">107</td><td class="hits">0</td><td class="source">    sendFetch.call(this);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">111</td><td class="hits">1</td><td class="source">ResultSet.prototype.close = function close(cb) {</td></tr><tr class="hit"><td class="line">112</td><td class="hits">1</td><td class="source">  if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">1</td><td class="source">    this._close = cb;</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">115</td><td class="hits">0</td><td class="source">    this._close = true;</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">119</td><td class="hits">1</td><td class="source">ResultSet.prototype.getLobColumnNames = function getLobColumnNames() {</td></tr><tr class="hit"><td class="line">120</td><td class="hits">9</td><td class="source">  return this.metadata.filter(isLob).map(getColumName);</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">123</td><td class="hits">1</td><td class="source">ResultSet.prototype.fetch = function fetch(cb) {</td></tr><tr class="hit"><td class="line">124</td><td class="hits">9</td><td class="source">  var stream = this.createArrayStream();</td></tr><tr class="hit"><td class="line">125</td><td class="hits">9</td><td class="source">  var collector = new util.stream.Writable({</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    objectMode: true,</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">    highWaterMark: 16</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">129</td><td class="hits">9</td><td class="source">  collector.rows = [];</td></tr><tr class="hit"><td class="line">130</td><td class="hits">9</td><td class="source">  collector.columns = this.getLobColumnNames();</td></tr><tr class="hit"><td class="line">131</td><td class="hits">9</td><td class="source">  if (collector.columns.length) {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">1</td><td class="source">    collector._write = collectLobRows;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">134</td><td class="hits">8</td><td class="source">    collector._write = collectRows;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">137</td><td class="hits">9</td><td class="source">  function done(err, rows) {</td></tr><tr class="hit"><td class="line">138</td><td class="hits">9</td><td class="source">    stream.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">139</td><td class="hits">9</td><td class="source">    collector.removeListener('finish', onfinish);</td></tr><tr class="hit"><td class="line">140</td><td class="hits">9</td><td class="source">    cb(err, rows);</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">143</td><td class="hits">9</td><td class="source">  function onerror(err) {</td></tr><tr class="miss"><td class="line">144</td><td class="hits">0</td><td class="source">    done(err);</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">147</td><td class="hits">9</td><td class="source">  function onfinish() {</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">149</td><td class="hits">9</td><td class="source">    done(null, this.rows);</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">151</td><td class="hits">9</td><td class="source">  stream.on('error', onerror).pipe(collector).on('finish', onfinish);</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">154</td><td class="hits">1</td><td class="source">ResultSet.prototype.createBinaryStream = function createBinaryStream(options) {</td></tr><tr class="hit"><td class="line">155</td><td class="hits">11</td><td class="source">  if (!util.isUndefined(this._running)) {</td></tr><tr class="miss"><td class="line">156</td><td class="hits">0</td><td class="source">    return null;</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">159</td><td class="hits">11</td><td class="source">  options = util.extend({</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source">    highWaterMark: Math.floor(1.5 * this._fetchSize * this._rowLength)</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">  }, options);</td></tr><tr class="hit"><td class="line">162</td><td class="hits">11</td><td class="source">  options.objectMode = false;</td></tr><tr class="hit"><td class="line">163</td><td class="hits">11</td><td class="source">  return util.createReadStream(this, ['error', 'close'], options);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">166</td><td class="hits">1</td><td class="source">ResultSet.prototype.createParser = function createParser(options) {</td></tr><tr class="hit"><td class="line">167</td><td class="hits">11</td><td class="source">  return Parser.create(this.metadata).createTransform(this, options);</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">ResultSet.prototype.createObjectStream = function createObjectStream(options) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">1</td><td class="source">  options = util.extend({}, options);</td></tr><tr class="hit"><td class="line">172</td><td class="hits">1</td><td class="source">  options.arrayMode = false;</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">174</td><td class="hits">1</td><td class="source">  return util.pipe(this.createBinaryStream(), this.createParser(options));</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">177</td><td class="hits">1</td><td class="source">ResultSet.prototype.createArrayStream = function createArrayStream(options) {</td></tr><tr class="hit"><td class="line">178</td><td class="hits">10</td><td class="source">  if (util.isNumber(options) || options === true) {</td></tr><tr class="miss"><td class="line">179</td><td class="hits">0</td><td class="source">    options = {</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">      arrayMode: options</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">182</td><td class="hits">10</td><td class="source">  } else if (util.isObject(options)) {</td></tr><tr class="miss"><td class="line">183</td><td class="hits">0</td><td class="source">    options = util.extend({}, options);</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">185</td><td class="hits">10</td><td class="source">    options = {</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source">      arrayMode: ResultSet.DEFAULT_ARRAY_LENGTH</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">190</td><td class="hits">10</td><td class="source">  return util.pipe(this.createBinaryStream(), this.createParser(options));</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">193</td><td class="hits">1</td><td class="source">ResultSet.prototype.createReadStream = function createReadStream(options) {</td></tr><tr class="miss"><td class="line">194</td><td class="hits">0</td><td class="source">  options = options || {};</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">196</td><td class="hits">0</td><td class="source">  if (options.objectMode === false) {</td></tr><tr class="miss"><td class="line">197</td><td class="hits">0</td><td class="source">    return this.createBinaryStream(options);</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">199</td><td class="hits">0</td><td class="source">  if (options.arrayMode) {</td></tr><tr class="miss"><td class="line">200</td><td class="hits">0</td><td class="source">    return this.createArrayStream(options);</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">202</td><td class="hits">0</td><td class="source">  return this.createObjectStream(options);</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">204</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">205</td><td class="hits">1</td><td class="source">ResultSet.prototype.createLob = function createLob(ld, options) {</td></tr><tr class="hit"><td class="line">206</td><td class="hits">4</td><td class="source">  options = util.extend({</td></tr><tr><td class="line">207</td><td class="hits"></td><td class="source">    readSize: this._readSize</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">  }, options);</td></tr><tr class="hit"><td class="line">209</td><td class="hits">4</td><td class="source">  return new Lob(sendReadLob.bind(this), ld, options);</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">211</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">212</td><td class="hits">1</td><td class="source">function sendClose() {</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="miss"><td class="line">214</td><td class="hits">0</td><td class="source">  debug('sendClose');</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source"> </td></tr><tr class="miss"><td class="line">216</td><td class="hits">0</td><td class="source">  function done(err) {</td></tr><tr class="miss"><td class="line">217</td><td class="hits">0</td><td class="source">    this._connection = undefined;</td></tr><tr class="miss"><td class="line">218</td><td class="hits">0</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">219</td><td class="hits">0</td><td class="source">      debug('close failed: %s', err);</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"><td class="line">221</td><td class="hits">0</td><td class="source">      this.closed = true;</td></tr><tr class="miss"><td class="line">222</td><td class="hits">0</td><td class="source">      emitClose.call(this);</td></tr><tr class="miss"><td class="line">223</td><td class="hits">0</td><td class="source">      this.emit('close');</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"><td class="line">225</td><td class="hits">0</td><td class="source">    if (util.isFunction(this._close)) {</td></tr><tr class="miss"><td class="line">226</td><td class="hits">0</td><td class="source">      this._close(err);</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">229</td><td class="hits">0</td><td class="source">  this._connection.closeResultSet({</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">    resultSetId: this.id</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">  }, done.bind(this));</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">233</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">234</td><td class="hits">1</td><td class="source">function sendFetch() {</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">236</td><td class="hits">4</td><td class="source">  debug('sendFetch(%d)', this.fetchSize);</td></tr><tr class="hit"><td class="line">237</td><td class="hits">4</td><td class="source">  this._connection.fetchNext({</td></tr><tr><td class="line">238</td><td class="hits"></td><td class="source">    resultSetId: this.id,</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">    fetchSize: this.fetchSize</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">  }, receiveData.bind(this));</td></tr><tr><td class="line">241</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">243</td><td class="hits">1</td><td class="source">function sendReadLob(req, cb) {</td></tr><tr><td class="line">244</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">245</td><td class="hits">10</td><td class="source">  this._connection.readLob(req, cb);</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">247</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">248</td><td class="hits">1</td><td class="source">function receiveData(err, reply) {</td></tr><tr><td class="line">249</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">250</td><td class="hits">4</td><td class="source">  debug('receiveData()');</td></tr><tr class="hit"><td class="line">251</td><td class="hits">4</td><td class="source">  if (err) {</td></tr><tr class="miss"><td class="line">252</td><td class="hits">0</td><td class="source">    this._running = false;</td></tr><tr class="miss"><td class="line">253</td><td class="hits">0</td><td class="source">    debug('emit &quot;error&quot;: %s', err);</td></tr><tr class="miss"><td class="line">254</td><td class="hits">0</td><td class="source">    this.emit('error', err);</td></tr><tr class="miss"><td class="line">255</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">257</td><td class="hits">4</td><td class="source">  var data = reply.resultSets[0].data;</td></tr><tr class="hit"><td class="line">258</td><td class="hits">4</td><td class="source">  if (this._running) {</td></tr><tr class="hit"><td class="line">259</td><td class="hits">4</td><td class="source">    handleData.call(this, data);</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">261</td><td class="hits">0</td><td class="source">    this._data = data;</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">263</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">264</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">265</td><td class="hits">1</td><td class="source">function handleData(data) {</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">267</td><td class="hits">15</td><td class="source">  debug('handleData(%d)', data.argumentCount);</td></tr><tr class="hit"><td class="line">268</td><td class="hits">15</td><td class="source">  if (data.argumentCount &amp;&amp; Buffer.isBuffer(data.buffer)) {</td></tr><tr class="hit"><td class="line">269</td><td class="hits">14</td><td class="source">    debug('emit &quot;data&quot;: length=%d', data.buffer.length);</td></tr><tr class="hit"><td class="line">270</td><td class="hits">14</td><td class="source">    this.emit('data', data.buffer);</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">273</td><td class="hits">15</td><td class="source">  if (isLast(data)) {</td></tr><tr class="hit"><td class="line">274</td><td class="hits">11</td><td class="source">    this.finished = true;</td></tr><tr class="hit"><td class="line">275</td><td class="hits">11</td><td class="source">    this._running = false;</td></tr><tr class="hit"><td class="line">276</td><td class="hits">11</td><td class="source">    this.closed = isClosed(data);</td></tr><tr class="hit"><td class="line">277</td><td class="hits">11</td><td class="source">    process.nextTick(emitEnd.bind(this));</td></tr><tr class="hit"><td class="line">278</td><td class="hits">11</td><td class="source">    return;</td></tr><tr><td class="line">279</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">281</td><td class="hits">4</td><td class="source">  if (this._running) {</td></tr><tr class="hit"><td class="line">282</td><td class="hits">4</td><td class="source">    process.nextTick(sendFetch.bind(this));</td></tr><tr><td class="line">283</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">285</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">286</td><td class="hits">1</td><td class="source">function emitEnd() {</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">288</td><td class="hits">11</td><td class="source">  debug('emit &quot;end&quot;');</td></tr><tr class="hit"><td class="line">289</td><td class="hits">11</td><td class="source">  this.emit('end');</td></tr><tr class="hit"><td class="line">290</td><td class="hits">11</td><td class="source">  if (this.closed) {</td></tr><tr class="hit"><td class="line">291</td><td class="hits">10</td><td class="source">    process.nextTick(emitClose.bind(this));</td></tr><tr class="hit"><td class="line">292</td><td class="hits">1</td><td class="source">  } else if (util.isFunction(this._close)) {</td></tr><tr class="miss"><td class="line">293</td><td class="hits">0</td><td class="source">    sendClose.call(this);</td></tr><tr><td class="line">294</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">296</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">297</td><td class="hits">1</td><td class="source">function emitClose() {</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">299</td><td class="hits">10</td><td class="source">  debug('emit &quot;close&quot;');</td></tr><tr class="hit"><td class="line">300</td><td class="hits">10</td><td class="source">  this.emit('close');</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">303</td><td class="hits">1</td><td class="source">function isLast(data) {</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">305</td><td class="hits">15</td><td class="source">  return !!(data.attributes &amp; ResultSetAttributes.LAST);</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">308</td><td class="hits">1</td><td class="source">function isClosed(data) {</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">310</td><td class="hits">11</td><td class="source">  return !!(data.attributes &amp; ResultSetAttributes.CLOSED);</td></tr><tr><td class="line">311</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">313</td><td class="hits">1</td><td class="source">function isLob(column) {</td></tr><tr class="hit"><td class="line">314</td><td class="hits">17</td><td class="source">  switch (column.dataType) {</td></tr><tr><td class="line">315</td><td class="hits"></td><td class="source">  case TypeCode.BLOB:</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">  case TypeCode.LOCATOR:</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source">  case TypeCode.CLOB:</td></tr><tr><td class="line">318</td><td class="hits"></td><td class="source">  case TypeCode.NCLOB:</td></tr><tr><td class="line">319</td><td class="hits"></td><td class="source">  case TypeCode.NLOCATOR:</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">  case TypeCode.TEXT:</td></tr><tr class="hit"><td class="line">321</td><td class="hits">1</td><td class="source">    return true;</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">  default:</td></tr><tr class="hit"><td class="line">323</td><td class="hits">16</td><td class="source">    return false;</td></tr><tr><td class="line">324</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">327</td><td class="hits">1</td><td class="source">function getColumName(column) {</td></tr><tr class="hit"><td class="line">328</td><td class="hits">1</td><td class="source">  return column.columnDisplayName;</td></tr><tr><td class="line">329</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">331</td><td class="hits">1</td><td class="source">function collectRows(rows, encoding, done) {</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">333</td><td class="hits">7</td><td class="source">  for (var i = 0; i &lt; rows.length; i++) {</td></tr><tr class="hit"><td class="line">334</td><td class="hits">225</td><td class="source">    this.rows.push(rows[i]);</td></tr><tr><td class="line">335</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">336</td><td class="hits">7</td><td class="source">  done();</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">339</td><td class="hits">1</td><td class="source">function collectLobRows(rows, encoding, done) {</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">341</td><td class="hits">1</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">342</td><td class="hits">1</td><td class="source">  var i = 0;</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">344</td><td class="hits">1</td><td class="source">  function handleRow(err) {</td></tr><tr class="hit"><td class="line">345</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">346</td><td class="hits">0</td><td class="source">      return done(err);</td></tr><tr><td class="line">347</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">348</td><td class="hits"></td><td class="source">    // next row</td></tr><tr class="hit"><td class="line">349</td><td class="hits">4</td><td class="source">    i += 1;</td></tr><tr class="hit"><td class="line">350</td><td class="hits">4</td><td class="source">    next();</td></tr><tr><td class="line">351</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">353</td><td class="hits">1</td><td class="source">  function next() {</td></tr><tr class="hit"><td class="line">354</td><td class="hits">5</td><td class="source">    if (i === rows.length) {</td></tr><tr class="hit"><td class="line">355</td><td class="hits">1</td><td class="source">      return done(null, rows);</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">357</td><td class="hits">4</td><td class="source">    util.setImmediate(collectLobRow.bind(self, rows[i], handleRow));</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">359</td><td class="hits">1</td><td class="source">  next();</td></tr><tr><td class="line">360</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">361</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">362</td><td class="hits">1</td><td class="source">function collectLobRow(row, done) {</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">364</td><td class="hits">4</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">365</td><td class="hits">4</td><td class="source">  var i = 0;</td></tr><tr><td class="line">366</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">367</td><td class="hits">4</td><td class="source">  function receiveLob(err, buffer) {</td></tr><tr class="hit"><td class="line">368</td><td class="hits">4</td><td class="source">    if (err) {</td></tr><tr class="miss"><td class="line">369</td><td class="hits">0</td><td class="source">      return done(err);</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">371</td><td class="hits"></td><td class="source">    // update lob</td></tr><tr class="hit"><td class="line">372</td><td class="hits">4</td><td class="source">    row[self.columns[i]] = buffer;</td></tr><tr><td class="line">373</td><td class="hits"></td><td class="source">    // next lob</td></tr><tr class="hit"><td class="line">374</td><td class="hits">4</td><td class="source">    i += 1;</td></tr><tr class="hit"><td class="line">375</td><td class="hits">4</td><td class="source">    next();</td></tr><tr><td class="line">376</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">378</td><td class="hits">4</td><td class="source">  function next() {</td></tr><tr class="hit"><td class="line">379</td><td class="hits">8</td><td class="source">    if (i === self.columns.length) {</td></tr><tr class="hit"><td class="line">380</td><td class="hits">4</td><td class="source">      self.rows.push(row);</td></tr><tr class="hit"><td class="line">381</td><td class="hits">4</td><td class="source">      return done(null);</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">383</td><td class="hits">4</td><td class="source">    var lob = row[self.columns[i]];</td></tr><tr class="hit"><td class="line">384</td><td class="hits">4</td><td class="source">    if (lob === null || Buffer.isBuffer(lob)) {</td></tr><tr class="miss"><td class="line">385</td><td class="hits">0</td><td class="source">      return receiveLob(null, lob);</td></tr><tr><td class="line">386</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">387</td><td class="hits">4</td><td class="source">    lob.read(receiveLob);</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">389</td><td class="hits">4</td><td class="source">  next();</td></tr><tr><td class="line">390</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/ResultSetTransform.js">protocol/ResultSetTransform.js</h2><div id="stats" class="high"><div class="percentage">90%</div><div class="sloc">64</div><div class="hits">58</div><div class="misses">6</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Transform = util.stream.Transform;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Reader = require('./Reader');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">module.exports = ResultSetTransform;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">util.inherits(ResultSetTransform, Transform);</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function ResultSetTransform(parseRow, rs, options) {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">11</td><td class="source">  options = options || {};</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  // private</td></tr><tr class="hit"><td class="line">27</td><td class="hits">11</td><td class="source">  this._parseRow = parseRow;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">11</td><td class="source">  this._rs = rs;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">11</td><td class="source">  this._threshold = options.threshold || ResultSetTransform.DEFAULT_TRESHHOLD;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">11</td><td class="source">  this._arrayMode = normalizeArrayMode(options.arrayMode);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">11</td><td class="source">  if (this._arrayMode) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">10</td><td class="source">    this._objectBuffer = new Collector(this, this._arrayMode);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">    this._objectBuffer = this;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  // call Transform constructor</td></tr><tr class="hit"><td class="line">37</td><td class="hits">11</td><td class="source">  options.objectMode = false;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">11</td><td class="source">  options.highWaterMark = options.highWaterMark || this._arrayMode ? 4 : 1024;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">11</td><td class="source">  Transform.call(this, options);</td></tr><tr class="hit"><td class="line">40</td><td class="hits">11</td><td class="source">  this._readableState.objectMode = true;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">ResultSetTransform.DEFAULT_TRESHHOLD = 128;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">ResultSetTransform.prototype._transform = function _transform(chunk, encoding,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  done) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">14</td><td class="source">  var reader = new Reader(chunk, this._rs);</td></tr><tr class="hit"><td class="line">49</td><td class="hits">14</td><td class="source">  var parseRow = this._parseRow.bind(reader);</td></tr><tr class="hit"><td class="line">50</td><td class="hits">14</td><td class="source">  var objectBuffer = this._objectBuffer;</td></tr><tr class="hit"><td class="line">51</td><td class="hits">14</td><td class="source">  var arrayMode = this._arrayMode;</td></tr><tr class="hit"><td class="line">52</td><td class="hits">14</td><td class="source">  var threshold = this._threshold;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">14</td><td class="source">  function run() {</td></tr><tr class="hit"><td class="line">55</td><td class="hits">14</td><td class="source">    var i = 0;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">14</td><td class="source">    try {</td></tr><tr class="hit"><td class="line">57</td><td class="hits">14</td><td class="source">      while (reader.hasMore() &amp;&amp; i++ &lt; threshold) {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">431</td><td class="source">        objectBuffer.push(parseRow());</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">    } catch (err) {</td></tr><tr class="miss"><td class="line">61</td><td class="hits">0</td><td class="source">      return done(err);</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">63</td><td class="hits">14</td><td class="source">    if (reader.hasMore()) {</td></tr><tr class="miss"><td class="line">64</td><td class="hits">0</td><td class="source">      return util.setImmediate(run);</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">66</td><td class="hits">14</td><td class="source">    if (arrayMode === true) {</td></tr><tr class="miss"><td class="line">67</td><td class="hits">0</td><td class="source">      objectBuffer.flush();</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">69</td><td class="hits">14</td><td class="source">    done();</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">71</td><td class="hits">14</td><td class="source">  util.setImmediate(run);</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">ResultSetTransform.prototype._flush = function _flush(done) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">11</td><td class="source">  if (this._arrayMode &gt; 1) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">10</td><td class="source">    this._objectBuffer.flush();</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">78</td><td class="hits">11</td><td class="source">  this.push(null);</td></tr><tr class="hit"><td class="line">79</td><td class="hits">11</td><td class="source">  done();</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">82</td><td class="hits">1</td><td class="source">function Collector(readable, mode) {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">10</td><td class="source">  this.readable = readable;</td></tr><tr class="hit"><td class="line">84</td><td class="hits">10</td><td class="source">  this.rows = [];</td></tr><tr class="hit"><td class="line">85</td><td class="hits">10</td><td class="source">  this.flushLength = mode === true ? -1 : mode;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">Object.defineProperties(Collector.prototype, {</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  empty: {</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    get: function isEmpty() {</td></tr><tr class="miss"><td class="line">91</td><td class="hits">0</td><td class="source">      return !this.rows.length;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">96</td><td class="hits">1</td><td class="source">Collector.prototype.push = function push(row) {</td></tr><tr class="hit"><td class="line">97</td><td class="hits">330</td><td class="source">  this.rows.push(row);</td></tr><tr class="hit"><td class="line">98</td><td class="hits">330</td><td class="source">  if (this.rows.length === this.flushLength) {</td></tr><tr class="miss"><td class="line">99</td><td class="hits">0</td><td class="source">    this.flush();</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">Collector.prototype.flush = function flush() {</td></tr><tr class="hit"><td class="line">104</td><td class="hits">10</td><td class="source">  if (this.rows.length) {</td></tr><tr class="hit"><td class="line">105</td><td class="hits">9</td><td class="source">    this.readable.push(this.rows);</td></tr><tr class="hit"><td class="line">106</td><td class="hits">9</td><td class="source">    this.rows = [];</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">110</td><td class="hits">1</td><td class="source">function normalizeArrayMode(mode) {</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">112</td><td class="hits">11</td><td class="source">  if (util.isBoolean(mode)) {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">1</td><td class="source">    return mode;</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">115</td><td class="hits">10</td><td class="source">  mode = ~~mode;</td></tr><tr class="hit"><td class="line">116</td><td class="hits">10</td><td class="source">  if (mode &gt; 1) {</td></tr><tr class="hit"><td class="line">117</td><td class="hits">10</td><td class="source">    return mode;</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">119</td><td class="hits">0</td><td class="source">  return false;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Statement.js">protocol/Statement.js</h2><div id="stats" class="high"><div class="percentage">76%</div><div class="sloc">80</div><div class="hits">61</div><div class="misses">19</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Result = require('./Result');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var IoType = common.IoType;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var FunctionCode = common.FunctionCode;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">module.exports = Statement;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function Statement(connection) {</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  // public</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">  this.id = undefined;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">8</td><td class="source">  this.functionCode = FunctionCode.NIL;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">  this.parameterMetadata = undefined;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">8</td><td class="source">  this.resultSetMetadata = undefined;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">8</td><td class="source">  this.droped = false;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  // private</td></tr><tr class="hit"><td class="line">32</td><td class="hits">8</td><td class="source">  this._connection = connection;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">Statement.prototype.exec = function exec(values, options, cb) {</td></tr><tr class="hit"><td class="line">36</td><td class="hits">8</td><td class="source">  var defaults = {</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    autoFetch: true</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">39</td><td class="hits">8</td><td class="source">  executeStatement.call(this, defaults, values, options, cb);</td></tr><tr class="hit"><td class="line">40</td><td class="hits">8</td><td class="source">  return this;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">Statement.prototype.execute = function execute(values, options, cb) {</td></tr><tr class="miss"><td class="line">44</td><td class="hits">0</td><td class="source">  var defaults = {</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    autoFetch: false</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  };</td></tr><tr class="miss"><td class="line">47</td><td class="hits">0</td><td class="source">  executeStatement.call(this, defaults, values, options, cb);</td></tr><tr class="miss"><td class="line">48</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">Statement.prototype.drop = function drop(cb) {</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">3</td><td class="source">  function done(err) {</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">55</td><td class="hits">3</td><td class="source">    this._connection = undefined;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">3</td><td class="source">    if (!err) {</td></tr><tr class="hit"><td class="line">57</td><td class="hits">3</td><td class="source">      this.droped = true;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">59</td><td class="hits">3</td><td class="source">    if (util.isFunction(cb)) {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">3</td><td class="source">      cb(err);</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">63</td><td class="hits">3</td><td class="source">  this._connection.dropStatement({</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    statementId: this.id</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  }, done.bind(this));</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">Statement.prototype.getParameterName = function getParameterName(i) {</td></tr><tr class="miss"><td class="line">69</td><td class="hits">0</td><td class="source">  if (util.isArray(this.parameterMetadata) &amp;&amp; i &lt; this.parameterMetadata.length) {</td></tr><tr class="miss"><td class="line">70</td><td class="hits">0</td><td class="source">    return this.parameterMetadata[i].name;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">Statement.prototype.handle = function handle(err, reply, cb) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">8</td><td class="source">  if (err) {</td></tr><tr class="miss"><td class="line">76</td><td class="hits">0</td><td class="source">    this._connection = undefined;</td></tr><tr class="miss"><td class="line">77</td><td class="hits">0</td><td class="source">    return cb(err);</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">80</td><td class="hits">8</td><td class="source">  this.id = reply.statementId;</td></tr><tr class="hit"><td class="line">81</td><td class="hits">8</td><td class="source">  this.functionCode = reply.functionCode;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">8</td><td class="source">  if (util.isArray(reply.resultSets) &amp;&amp; reply.resultSets.length) {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">3</td><td class="source">    this.resultSetMetadata = reply.resultSets[0].metadata;</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">85</td><td class="hits">8</td><td class="source">  this.parameterMetadata = reply.parameterMetadata;</td></tr><tr class="hit"><td class="line">86</td><td class="hits">8</td><td class="source">  cb(null, this);</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">89</td><td class="hits">1</td><td class="source">function normalizeParameters(values) {</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">91</td><td class="hits">8</td><td class="source">  var inputParameterMetadata = this.parameterMetadata.filter(isInputParameter);</td></tr><tr class="hit"><td class="line">92</td><td class="hits">8</td><td class="source">  var length = inputParameterMetadata.length;</td></tr><tr class="hit"><td class="line">93</td><td class="hits">8</td><td class="source">  if (!length) {</td></tr><tr class="miss"><td class="line">94</td><td class="hits">0</td><td class="source">    return null;</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">97</td><td class="hits">8</td><td class="source">  function getDataType(metadata) {</td></tr><tr class="hit"><td class="line">98</td><td class="hits">14</td><td class="source">    return metadata.dataType;</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">101</td><td class="hits">8</td><td class="source">  function getObjectValue(metadata) {</td></tr><tr class="miss"><td class="line">102</td><td class="hits">0</td><td class="source">    if (!util.isUndefined(values[metadata.name])) {</td></tr><tr class="miss"><td class="line">103</td><td class="hits">0</td><td class="source">      return values[metadata.name];</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">    }</td></tr><tr class="miss"><td class="line">105</td><td class="hits">0</td><td class="source">    return null;</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">108</td><td class="hits">8</td><td class="source">  var parameters = {</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    types: inputParameterMetadata.map(getDataType),</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">    values: undefined</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">  };</td></tr><tr class="hit"><td class="line">112</td><td class="hits">8</td><td class="source">  if (util.isArray(values)) {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">8</td><td class="source">    if (!values.length) {</td></tr><tr class="miss"><td class="line">114</td><td class="hits">0</td><td class="source">      throw new Error('Invalid input parameter values');</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">117</td><td class="hits">8</td><td class="source">    parameters.values = values;</td></tr><tr class="hit"><td class="line">118</td><td class="hits">8</td><td class="source">    return parameters;</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">120</td><td class="hits">0</td><td class="source">  parameters.values = inputParameterMetadata.map(getObjectValue);</td></tr><tr class="miss"><td class="line">121</td><td class="hits">0</td><td class="source">  return parameters;</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">124</td><td class="hits">1</td><td class="source">function executeStatement(defaults, values, options, cb) {</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">126</td><td class="hits">8</td><td class="source">  if (util.isFunction(options)) {</td></tr><tr class="hit"><td class="line">127</td><td class="hits">8</td><td class="source">    cb = options;</td></tr><tr class="hit"><td class="line">128</td><td class="hits">8</td><td class="source">    options = defaults;</td></tr><tr class="miss"><td class="line">129</td><td class="hits">0</td><td class="source">  } else if (util.isObject(options)) {</td></tr><tr class="miss"><td class="line">130</td><td class="hits">0</td><td class="source">    options = util.extend(defaults, options);</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">132</td><td class="hits">0</td><td class="source">    var autoFetch = !!options;</td></tr><tr class="miss"><td class="line">133</td><td class="hits">0</td><td class="source">    options = defaults;</td></tr><tr class="miss"><td class="line">134</td><td class="hits">0</td><td class="source">    options.autoFetch = autoFetch;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">137</td><td class="hits">8</td><td class="source">  var result = new Result(this._connection, options);</td></tr><tr class="hit"><td class="line">138</td><td class="hits">8</td><td class="source">  result.setResultSetMetadata(this.resultSetMetadata);</td></tr><tr class="hit"><td class="line">139</td><td class="hits">8</td><td class="source">  result.setParameterMetadata(this.parameterMetadata.filter(isOutputParameter));</td></tr><tr class="hit"><td class="line">140</td><td class="hits">8</td><td class="source">  this._connection.execute({</td></tr><tr><td class="line">141</td><td class="hits"></td><td class="source">    functionCode: this.functionCode,</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">    statementId: this.id,</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">    parameters: normalizeParameters.call(this, values)</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source">  }, function onreply(err, reply) {</td></tr><tr class="hit"><td class="line">145</td><td class="hits">8</td><td class="source">    result.handle(err, reply, cb);</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">149</td><td class="hits">1</td><td class="source">function isInputParameter(metadata) {</td></tr><tr class="hit"><td class="line">150</td><td class="hits">14</td><td class="source">  return metadata.ioType === IoType.INPUT || metadata.ioType === IoType.IN_OUT;</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">153</td><td class="hits">1</td><td class="source">function isOutputParameter(metadata) {</td></tr><tr class="hit"><td class="line">154</td><td class="hits">14</td><td class="source">  return metadata.ioType === IoType.OUTPUT || metadata.ioType === IoType.IN_OUT;</td></tr><tr><td class="line">155</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Stringifier.js">protocol/Stringifier.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">44</div><div class="hits">44</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Transform = util.stream.Transform;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">module.exports = Stringifier;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">util.inherits(Stringifier, Transform);</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function Stringifier(options) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">6</td><td class="source">  options = options || {};</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">6</td><td class="source">  Transform.call(this, options);</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">6</td><td class="source">  this._writableState.objectMode = true;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">6</td><td class="source">  this._header = options.header !== undefined ? options.header : '[';</td></tr><tr class="hit"><td class="line">30</td><td class="hits">6</td><td class="source">  this._footer = options.footer !== undefined ? options.footer : ']';</td></tr><tr class="hit"><td class="line">31</td><td class="hits">6</td><td class="source">  this._seperator = options.seperator !== undefined ? options.seperator : ',';</td></tr><tr class="hit"><td class="line">32</td><td class="hits">6</td><td class="source">  this._stringify = options.stringify || JSON.stringify;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">6</td><td class="source">  this._map = undefined;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">6</td><td class="source">  if (util.isFunction(options.map)) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">2</td><td class="source">    this._map = options.map;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">37</td><td class="hits">6</td><td class="source">  this._first = true;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">Stringifier.prototype._transform = function _transform(thing, encoding, done) {</td></tr><tr class="hit"><td class="line">41</td><td class="hits">13</td><td class="source">  if (util.isArray(thing) &amp;&amp; thing.length) {</td></tr><tr class="hit"><td class="line">42</td><td class="hits">4</td><td class="source">    this.push(this.transformRows(thing));</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">44</td><td class="hits">9</td><td class="source">    this.push(this.transformRow(thing));</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">46</td><td class="hits">13</td><td class="source">  done();</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">Stringifier.prototype._flush = function _flush(done) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">5</td><td class="source">  if (this._first) {</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">    this.push(this._header + this._footer);</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">4</td><td class="source">    this.push(this._footer);</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">55</td><td class="hits">5</td><td class="source">  done(null);</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">Stringifier.prototype.transformRows = function transformRows(rows) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">4</td><td class="source">  if (this._map) {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">2</td><td class="source">    rows = rows.map(this._map);</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">62</td><td class="hits">4</td><td class="source">  var str = this._first ? this._header : this._seperator;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">  this._first = false;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">4</td><td class="source">  for (var i = 0; i &lt; rows.length; i++) {</td></tr><tr class="hit"><td class="line">65</td><td class="hits">8</td><td class="source">    if (i &gt; 0) {</td></tr><tr class="hit"><td class="line">66</td><td class="hits">4</td><td class="source">      str += this._seperator;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">68</td><td class="hits">8</td><td class="source">    str += this._stringify(rows[i]);</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">70</td><td class="hits">4</td><td class="source">  return str;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">Stringifier.prototype.transformRow = function transformRow(row) {</td></tr><tr class="hit"><td class="line">74</td><td class="hits">9</td><td class="source">  if (this._map) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">5</td><td class="source">    row = this._map(row);</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">77</td><td class="hits">9</td><td class="source">  if (this._first) {</td></tr><tr class="hit"><td class="line">78</td><td class="hits">2</td><td class="source">    this._first = false;</td></tr><tr class="hit"><td class="line">79</td><td class="hits">2</td><td class="source">    return this._header + this._stringify(row);</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">81</td><td class="hits">7</td><td class="source">  return this._seperator + this._stringify(row);</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Transaction.js">protocol/Transaction.js</h2><div id="stats" class="high"><div class="percentage">94%</div><div class="sloc">34</div><div class="hits">32</div><div class="misses">2</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var ErrorLevel = require('./common/ErrorLevel');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var debug = util.debuglog('hdbtx');</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">module.exports = Transaction;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">util.inherits(Transaction, EventEmitter);</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function Transaction() {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">8</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">8</td><td class="source">  this.autoCommit = true;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">8</td><td class="source">  this.kind = 'none';</td></tr><tr class="hit"><td class="line">30</td><td class="hits">8</td><td class="source">  this.error = undefined;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">Transaction.prototype.setAutoCommit = function setAutoCommit(autoCommit) {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">  this.autoCommit = autoCommit;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">Transaction.prototype.setFlags = function setFlags(flags) {</td></tr><tr class="hit"><td class="line">38</td><td class="hits">8</td><td class="source">  debug(flags);</td></tr><tr class="hit"><td class="line">39</td><td class="hits">8</td><td class="source">  if (flags.committed) {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">3</td><td class="source">    this.emit('end', true, this.kind);</td></tr><tr class="hit"><td class="line">41</td><td class="hits">3</td><td class="source">    this.kind = 'none';</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">43</td><td class="hits">8</td><td class="source">  if (flags.rolledBack) {</td></tr><tr class="miss"><td class="line">44</td><td class="hits">0</td><td class="source">    this.emit('end', false, this.kind);</td></tr><tr class="miss"><td class="line">45</td><td class="hits">0</td><td class="source">    this.kind = 'none';</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">47</td><td class="hits">8</td><td class="source">  if (flags.writeTransactionStarted) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">3</td><td class="source">    this.kind = 'write';</td></tr><tr class="hit"><td class="line">49</td><td class="hits">3</td><td class="source">    this.emit('new', this.kind);</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">51</td><td class="hits">8</td><td class="source">  if (flags.noWriteTransactionStarted) {</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">    this.kind = 'read';</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">    this.emit('new', this.kind);</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">55</td><td class="hits">8</td><td class="source">  if (flags.sessionClosingTransactionErrror) {</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">    this.error = new Error(</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">      'A transaction error occured that implies the session must be terminated.'</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    );</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">    this.error.code = 'EHDBTX';</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">    this.error.level = ErrorLevel.FATAL;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">    this.error.fatal = true;</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">    this.emit('error', this.error);</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/Writer.js">protocol/Writer.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">377</div><div class="hits">377</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Readable = util.stream.Readable;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('./common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var LobOptions = common.LobOptions;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var NormalizedTypeCode = common.NormalizedTypeCode;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var bignum = util.bignum;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports = module.exports = Writer;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">var REGEX = {</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  DATE: /(\d{4})-(\d{2})-(\d{2})/,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  TIME: /(\d{2}):(\d{2}):(\d{2}(?:\.\d+)?)/,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  TIMESTAMP: /(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.\d+)?)/,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  DECIMAL: /^([+-])?(\d+)(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">function Writer(types) {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">46</td><td class="source">  this._types = types.map(normalizeType);</td></tr><tr class="hit"><td class="line">35</td><td class="hits">46</td><td class="source">  this.reset();</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">function normalizeType(type) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">91</td><td class="source">  return NormalizedTypeCode[type];</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">Writer.prototype.clear = function clear() {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">157</td><td class="source">  this._params = false;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">157</td><td class="source">  this._buffers = [];</td></tr><tr class="hit"><td class="line">45</td><td class="hits">157</td><td class="source">  this._bytesWritten = 0;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">157</td><td class="source">  this._argumentCount = 0;</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">Writer.prototype.reset = function reset() {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">100</td><td class="source">  this._lobs = [];</td></tr><tr class="hit"><td class="line">51</td><td class="hits">100</td><td class="source">  this.clear();</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">Writer.prototype.setValues = function setValues(values) {</td></tr><tr class="hit"><td class="line">55</td><td class="hits">54</td><td class="source">  this.reset();</td></tr><tr class="hit"><td class="line">56</td><td class="hits">54</td><td class="source">  for (var i = 0; i &lt; values.length; i++) {</td></tr><tr class="hit"><td class="line">57</td><td class="hits">102</td><td class="source">    this.add(this._types[i], values[i]);</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">59</td><td class="hits">40</td><td class="source">  this._params = true;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">exports.create = function createWriter(params) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">  var writer = new Writer(params.types);</td></tr><tr class="hit"><td class="line">64</td><td class="hits">4</td><td class="source">  writer.setValues(params.values);</td></tr><tr class="hit"><td class="line">65</td><td class="hits">4</td><td class="source">  return writer;</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">Object.defineProperties(Writer.prototype, {</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  hasParameters: {</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    get: function hasParameters() {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">38</td><td class="source">      return this._params;</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  finished: {</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">    get: function isFinished() {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">57</td><td class="source">      return !this._lobs.length &amp;&amp; !this._buffers.length;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  length: {</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">    get: function getLength() {</td></tr><tr class="hit"><td class="line">81</td><td class="hits">34</td><td class="source">      return this._bytesWritten;</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">Writer.prototype.add = function add(type, value) {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">102</td><td class="source">  if (typeof value === 'undefined' || value === null) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">2</td><td class="source">    this.pushNull(type);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">90</td><td class="hits">100</td><td class="source">    this[type](value);</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">94</td><td class="hits">1</td><td class="source">Writer.prototype.finializeParameters = function finializeParameters(</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  bytesRemaining, cb) {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">25</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">97</td><td class="hits">25</td><td class="source">  var stream, header;</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">99</td><td class="hits">25</td><td class="source">  function finalize() {</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">    /* jshint bitwise:false */</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    // update lob options in header</td></tr><tr class="hit"><td class="line">102</td><td class="hits">7</td><td class="source">    header[1] |= LobOptions.LAST_DATA;</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">    // remove current lob from stack</td></tr><tr class="hit"><td class="line">104</td><td class="hits">7</td><td class="source">    self._lobs.shift();</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">107</td><td class="hits">25</td><td class="source">  function cleanup() {</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">    // remove event listeners</td></tr><tr class="hit"><td class="line">109</td><td class="hits">15</td><td class="source">    stream.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">110</td><td class="hits">15</td><td class="source">    stream.removeListener('end', onend);</td></tr><tr class="hit"><td class="line">111</td><td class="hits">15</td><td class="source">    stream.removeListener('readable', onreadable);</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">114</td><td class="hits">25</td><td class="source">  function onerror(err) {</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">116</td><td class="hits">1</td><td class="source">    cleanup();</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source">    // stop appending on error</td></tr><tr class="hit"><td class="line">118</td><td class="hits">1</td><td class="source">    cb(err);</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">121</td><td class="hits">25</td><td class="source">  function onend() {</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">123</td><td class="hits">6</td><td class="source">    cleanup();</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">    // finalize lob</td></tr><tr class="hit"><td class="line">125</td><td class="hits">6</td><td class="source">    finalize();</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">    // process next lob in stack</td></tr><tr class="hit"><td class="line">127</td><td class="hits">6</td><td class="source">    util.setImmediate(next);</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">130</td><td class="hits">25</td><td class="source">  function onreadable() {</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">132</td><td class="hits">28</td><td class="source">    var chunk = this.read(bytesRemaining);</td></tr><tr class="hit"><td class="line">133</td><td class="hits">28</td><td class="source">    if (chunk === null) {</td></tr><tr class="hit"><td class="line">134</td><td class="hits">15</td><td class="source">      chunk = this.read();</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">136</td><td class="hits">28</td><td class="source">    if (chunk === null) {</td></tr><tr class="hit"><td class="line">137</td><td class="hits">11</td><td class="source">      return;</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">139</td><td class="hits">17</td><td class="source">    if (chunk.length &gt; bytesRemaining) {</td></tr><tr class="hit"><td class="line">140</td><td class="hits">1</td><td class="source">      cleanup();</td></tr><tr class="hit"><td class="line">141</td><td class="hits">1</td><td class="source">      return cb(createReadStreamError());</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">    // update lob length in header</td></tr><tr class="hit"><td class="line">144</td><td class="hits">16</td><td class="source">    var length = header.readInt32LE(2);</td></tr><tr class="hit"><td class="line">145</td><td class="hits">16</td><td class="source">    length += chunk.length;</td></tr><tr class="hit"><td class="line">146</td><td class="hits">16</td><td class="source">    header.writeInt32LE(length, 2);</td></tr><tr><td class="line">147</td><td class="hits"></td><td class="source">    // push chunk</td></tr><tr class="hit"><td class="line">148</td><td class="hits">16</td><td class="source">    self.push(chunk);</td></tr><tr class="hit"><td class="line">149</td><td class="hits">16</td><td class="source">    bytesRemaining -= chunk.length;</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">    // stop appending if there is no remaining space</td></tr><tr class="hit"><td class="line">151</td><td class="hits">16</td><td class="source">    if (bytesRemaining === 0) {</td></tr><tr class="hit"><td class="line">152</td><td class="hits">7</td><td class="source">      cleanup();</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source">      // finalize lob if the stream has already ended</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">      // because of cleanup we don't get end event in this case</td></tr><tr class="hit"><td class="line">155</td><td class="hits">7</td><td class="source">      var state = this._readableState;</td></tr><tr class="hit"><td class="line">156</td><td class="hits">7</td><td class="source">      if (state.ended &amp;&amp; !state.length) {</td></tr><tr class="hit"><td class="line">157</td><td class="hits">1</td><td class="source">        finalize();</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">      // we are done</td></tr><tr class="hit"><td class="line">160</td><td class="hits">7</td><td class="source">      cb(null);</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">164</td><td class="hits">25</td><td class="source">  function next() {</td></tr><tr class="hit"><td class="line">165</td><td class="hits">31</td><td class="source">    if (!self._lobs.length || !bytesRemaining) {</td></tr><tr class="hit"><td class="line">166</td><td class="hits">16</td><td class="source">      return cb(null);</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">    // set reabable stream</td></tr><tr class="hit"><td class="line">169</td><td class="hits">15</td><td class="source">    stream = self._lobs[0];</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">    // set lob header</td></tr><tr class="hit"><td class="line">171</td><td class="hits">15</td><td class="source">    header = stream._header;</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">    // update lob options in header</td></tr><tr class="hit"><td class="line">173</td><td class="hits">15</td><td class="source">    header[1] = LobOptions.DATA_INCLUDED;</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source">    // update lob position in header</td></tr><tr class="hit"><td class="line">175</td><td class="hits">15</td><td class="source">    var position = self._bytesWritten + 1;</td></tr><tr class="hit"><td class="line">176</td><td class="hits">15</td><td class="source">    header.writeInt32LE(position, 6);</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">    // register event handlers</td></tr><tr class="hit"><td class="line">178</td><td class="hits">15</td><td class="source">    stream.on('error', onerror);</td></tr><tr class="hit"><td class="line">179</td><td class="hits">15</td><td class="source">    stream.on('end', onend);</td></tr><tr class="hit"><td class="line">180</td><td class="hits">15</td><td class="source">    stream.on('readable', onreadable);</td></tr><tr class="hit"><td class="line">181</td><td class="hits">15</td><td class="source">    onreadable.call(stream);</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">184</td><td class="hits">25</td><td class="source">  next();</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">187</td><td class="hits">1</td><td class="source">Writer.prototype.getParameters = function getParameters(bytesAvailable, cb) {</td></tr><tr class="hit"><td class="line">188</td><td class="hits">25</td><td class="source">  var self = this;</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">190</td><td class="hits">25</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">191</td><td class="hits">25</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">192</td><td class="hits">2</td><td class="source">      return cb(err);</td></tr><tr><td class="line">193</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">194</td><td class="hits">23</td><td class="source">    var buffer = Buffer.concat(self._buffers, self._bytesWritten);</td></tr><tr class="hit"><td class="line">195</td><td class="hits">23</td><td class="source">    self.clear();</td></tr><tr class="hit"><td class="line">196</td><td class="hits">23</td><td class="source">    cb(null, buffer);</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">198</td><td class="hits">25</td><td class="source">  var bytesRemaining = bytesAvailable - this._bytesWritten;</td></tr><tr class="hit"><td class="line">199</td><td class="hits">25</td><td class="source">  this.finializeParameters(bytesRemaining, done);</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">201</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">202</td><td class="hits">1</td><td class="source">Writer.prototype.finalizeWriteLobRequest = function finalizeWriteLobRequest(</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source">  bytesRemaining, cb) {</td></tr><tr class="hit"><td class="line">204</td><td class="hits">18</td><td class="source">  var self = this;</td></tr><tr class="hit"><td class="line">205</td><td class="hits">18</td><td class="source">  var stream, header;</td></tr><tr><td class="line">206</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">207</td><td class="hits">18</td><td class="source">  function cleanup() {</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">    // remove event listeners</td></tr><tr class="hit"><td class="line">209</td><td class="hits">18</td><td class="source">    stream.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">210</td><td class="hits">18</td><td class="source">    stream.removeListener('end', onend);</td></tr><tr class="hit"><td class="line">211</td><td class="hits">18</td><td class="source">    stream.removeListener('readable', onreadable);</td></tr><tr><td class="line">212</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">213</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">214</td><td class="hits">18</td><td class="source">  function onerror(err) {</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">216</td><td class="hits">1</td><td class="source">    cleanup();</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">    // stop appending on error</td></tr><tr class="hit"><td class="line">218</td><td class="hits">1</td><td class="source">    cb(err);</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">221</td><td class="hits">18</td><td class="source">  function finalize() {</td></tr><tr><td class="line">222</td><td class="hits"></td><td class="source">    /* jshint bitwise:false */</td></tr><tr><td class="line">223</td><td class="hits"></td><td class="source">    // update lob options in header</td></tr><tr class="hit"><td class="line">224</td><td class="hits">7</td><td class="source">    header[8] |= LobOptions.LAST_DATA;</td></tr><tr><td class="line">225</td><td class="hits"></td><td class="source">    // remove current lob from stack</td></tr><tr class="hit"><td class="line">226</td><td class="hits">7</td><td class="source">    self._lobs.shift();</td></tr><tr><td class="line">227</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">228</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">229</td><td class="hits">18</td><td class="source">  function onend() {</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">231</td><td class="hits">6</td><td class="source">    cleanup();</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source">    // finalize lob</td></tr><tr class="hit"><td class="line">233</td><td class="hits">6</td><td class="source">    finalize();</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">    // process next lob in stack</td></tr><tr class="hit"><td class="line">235</td><td class="hits">6</td><td class="source">    util.setImmediate(next);</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">238</td><td class="hits">18</td><td class="source">  function onreadable() {</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">240</td><td class="hits">23</td><td class="source">    var chunk = this.read(bytesRemaining);</td></tr><tr class="hit"><td class="line">241</td><td class="hits">23</td><td class="source">    if (chunk === null) {</td></tr><tr class="hit"><td class="line">242</td><td class="hits">7</td><td class="source">      chunk = this.read();</td></tr><tr><td class="line">243</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">244</td><td class="hits">23</td><td class="source">    if (chunk === null) {</td></tr><tr class="hit"><td class="line">245</td><td class="hits">5</td><td class="source">      return;</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">247</td><td class="hits">18</td><td class="source">    if (chunk.length &gt; bytesRemaining) {</td></tr><tr class="hit"><td class="line">248</td><td class="hits">1</td><td class="source">      cleanup();</td></tr><tr class="hit"><td class="line">249</td><td class="hits">1</td><td class="source">      return cb(createReadStreamError());</td></tr><tr><td class="line">250</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">    // update lob length in buffer</td></tr><tr class="hit"><td class="line">252</td><td class="hits">17</td><td class="source">    var length = header.readInt32LE(17);</td></tr><tr class="hit"><td class="line">253</td><td class="hits">17</td><td class="source">    length += chunk.length;</td></tr><tr class="hit"><td class="line">254</td><td class="hits">17</td><td class="source">    header.writeInt32LE(length, 17);</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">    // push chunk</td></tr><tr class="hit"><td class="line">256</td><td class="hits">17</td><td class="source">    self.push(chunk);</td></tr><tr class="hit"><td class="line">257</td><td class="hits">17</td><td class="source">    bytesRemaining -= chunk.length;</td></tr><tr><td class="line">258</td><td class="hits"></td><td class="source">    // stop appending if there is no remaining space</td></tr><tr class="hit"><td class="line">259</td><td class="hits">17</td><td class="source">    if (bytesRemaining === 0) {</td></tr><tr class="hit"><td class="line">260</td><td class="hits">10</td><td class="source">      cleanup();</td></tr><tr><td class="line">261</td><td class="hits"></td><td class="source">      // finalize lob if the stream has already ended</td></tr><tr><td class="line">262</td><td class="hits"></td><td class="source">      // because of cleanup we don't get end event in this case</td></tr><tr class="hit"><td class="line">263</td><td class="hits">10</td><td class="source">      var state = this._readableState;</td></tr><tr class="hit"><td class="line">264</td><td class="hits">10</td><td class="source">      if (state.ended &amp;&amp; !state.length) {</td></tr><tr class="hit"><td class="line">265</td><td class="hits">1</td><td class="source">        finalize();</td></tr><tr><td class="line">266</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">267</td><td class="hits"></td><td class="source">      // we are done</td></tr><tr class="hit"><td class="line">268</td><td class="hits">10</td><td class="source">      cb(null);</td></tr><tr><td class="line">269</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">270</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">272</td><td class="hits">18</td><td class="source">  function next() {</td></tr><tr class="hit"><td class="line">273</td><td class="hits">24</td><td class="source">    if (!self._lobs.length || !bytesRemaining) {</td></tr><tr class="hit"><td class="line">274</td><td class="hits">6</td><td class="source">      return cb(null);</td></tr><tr><td class="line">275</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">    // set reabable stream</td></tr><tr class="hit"><td class="line">277</td><td class="hits">18</td><td class="source">    stream = self._lobs[0];</td></tr><tr><td class="line">278</td><td class="hits"></td><td class="source">    // set lob header</td></tr><tr class="hit"><td class="line">279</td><td class="hits">18</td><td class="source">    header = new Buffer(21);</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">    // set locatorId</td></tr><tr class="hit"><td class="line">281</td><td class="hits">18</td><td class="source">    stream._locatorId.copy(header, 0);</td></tr><tr><td class="line">282</td><td class="hits"></td><td class="source">    // update lob options in header</td></tr><tr class="hit"><td class="line">283</td><td class="hits">18</td><td class="source">    header[8] = LobOptions.DATA_INCLUDED;</td></tr><tr><td class="line">284</td><td class="hits"></td><td class="source">    // offset 0 means append</td></tr><tr class="hit"><td class="line">285</td><td class="hits">18</td><td class="source">    header.fill(0x00, 9, 17);</td></tr><tr><td class="line">286</td><td class="hits"></td><td class="source">    // length</td></tr><tr class="hit"><td class="line">287</td><td class="hits">18</td><td class="source">    header.writeInt32LE(0, 17);</td></tr><tr><td class="line">288</td><td class="hits"></td><td class="source">    // push header</td></tr><tr class="hit"><td class="line">289</td><td class="hits">18</td><td class="source">    self.push(header);</td></tr><tr class="hit"><td class="line">290</td><td class="hits">18</td><td class="source">    bytesRemaining -= header.length;</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">    // increase count</td></tr><tr class="hit"><td class="line">292</td><td class="hits">18</td><td class="source">    self._argumentCount += 1;</td></tr><tr><td class="line">293</td><td class="hits"></td><td class="source">    // register event handlers</td></tr><tr class="hit"><td class="line">294</td><td class="hits">18</td><td class="source">    stream.on('error', onerror);</td></tr><tr class="hit"><td class="line">295</td><td class="hits">18</td><td class="source">    stream.on('end', onend);</td></tr><tr class="hit"><td class="line">296</td><td class="hits">18</td><td class="source">    stream.on('readable', onreadable);</td></tr><tr class="hit"><td class="line">297</td><td class="hits">18</td><td class="source">    onreadable.call(stream);</td></tr><tr><td class="line">298</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">299</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">300</td><td class="hits">18</td><td class="source">  next();</td></tr><tr><td class="line">301</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">302</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">303</td><td class="hits">1</td><td class="source">Writer.prototype.getWriteLobRequest = function getWriteLobRequest(</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source">  bytesRemaining, cb) {</td></tr><tr class="hit"><td class="line">305</td><td class="hits">18</td><td class="source">  var self = this;</td></tr><tr><td class="line">306</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">307</td><td class="hits">18</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">308</td><td class="hits">18</td><td class="source">    if (err) {</td></tr><tr class="hit"><td class="line">309</td><td class="hits">2</td><td class="source">      return cb(err);</td></tr><tr><td class="line">310</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">311</td><td class="hits">16</td><td class="source">    var part = {</td></tr><tr><td class="line">312</td><td class="hits"></td><td class="source">      argumentCount: self._argumentCount,</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">      buffer: Buffer.concat(self._buffers, self._bytesWritten)</td></tr><tr><td class="line">314</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">315</td><td class="hits">16</td><td class="source">    self.clear();</td></tr><tr class="hit"><td class="line">316</td><td class="hits">16</td><td class="source">    cb(null, part);</td></tr><tr><td class="line">317</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">318</td><td class="hits">18</td><td class="source">  this.clear();</td></tr><tr class="hit"><td class="line">319</td><td class="hits">18</td><td class="source">  this.finalizeWriteLobRequest(bytesRemaining, done);</td></tr><tr><td class="line">320</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">321</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">322</td><td class="hits">1</td><td class="source">Writer.prototype.update = function update(writeLobReply) {</td></tr><tr class="hit"><td class="line">323</td><td class="hits">6</td><td class="source">  var stream, locatorId;</td></tr><tr class="hit"><td class="line">324</td><td class="hits">6</td><td class="source">  for (var i = 0; i &lt; this._lobs.length; i++) {</td></tr><tr class="hit"><td class="line">325</td><td class="hits">6</td><td class="source">    locatorId = writeLobReply[i];</td></tr><tr class="hit"><td class="line">326</td><td class="hits">6</td><td class="source">    stream = this._lobs[i];</td></tr><tr class="hit"><td class="line">327</td><td class="hits">6</td><td class="source">    if (Buffer.isBuffer(locatorId) &amp;&amp; util.isObject(stream)) {</td></tr><tr class="hit"><td class="line">328</td><td class="hits">6</td><td class="source">      stream._header = undefined;</td></tr><tr class="hit"><td class="line">329</td><td class="hits">6</td><td class="source">      stream._locatorId = locatorId;</td></tr><tr><td class="line">330</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">331</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">333</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">334</td><td class="hits">1</td><td class="source">Writer.prototype.push = function push(buffer) {</td></tr><tr class="hit"><td class="line">335</td><td class="hits">140</td><td class="source">  this._bytesWritten += buffer.length;</td></tr><tr class="hit"><td class="line">336</td><td class="hits">140</td><td class="source">  this._buffers.push(buffer);</td></tr><tr><td class="line">337</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">338</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">339</td><td class="hits">1</td><td class="source">Writer.prototype.pushNull = function pushNull(type) {</td></tr><tr><td class="line">340</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">341</td><td class="hits">2</td><td class="source">  var buffer = new Buffer([NormalizedTypeCode[type] | 0x80]);</td></tr><tr class="hit"><td class="line">342</td><td class="hits">2</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">343</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">345</td><td class="hits">1</td><td class="source">Writer.prototype.pushLob = function pushLob(buffer, value) {</td></tr><tr class="hit"><td class="line">346</td><td class="hits">24</td><td class="source">  this.push(buffer);</td></tr><tr class="hit"><td class="line">347</td><td class="hits">24</td><td class="source">  var stream;</td></tr><tr class="hit"><td class="line">348</td><td class="hits">24</td><td class="source">  if (Buffer.isBuffer(value)) {</td></tr><tr class="hit"><td class="line">349</td><td class="hits">12</td><td class="source">    stream = new Readable();</td></tr><tr class="hit"><td class="line">350</td><td class="hits">12</td><td class="source">    stream.push(value);</td></tr><tr class="hit"><td class="line">351</td><td class="hits">12</td><td class="source">    stream.push(null);</td></tr><tr class="hit"><td class="line">352</td><td class="hits">12</td><td class="source">  } else if (value instanceof Readable) {</td></tr><tr class="hit"><td class="line">353</td><td class="hits">9</td><td class="source">    stream = value;</td></tr><tr class="hit"><td class="line">354</td><td class="hits">3</td><td class="source">  } else if (value.readable === true) {</td></tr><tr class="hit"><td class="line">355</td><td class="hits">2</td><td class="source">    stream = new Readable().wrap(value);</td></tr><tr><td class="line">356</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">357</td><td class="hits">1</td><td class="source">    throw createInputError('LOB');</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">359</td><td class="hits">23</td><td class="source">  if (stream) {</td></tr><tr class="hit"><td class="line">360</td><td class="hits">23</td><td class="source">    stream._header = buffer;</td></tr><tr class="hit"><td class="line">361</td><td class="hits">23</td><td class="source">    this._lobs.push(stream);</td></tr><tr><td class="line">362</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">363</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">364</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">365</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.TINYINT] = function writeTinyInt(value) {</td></tr><tr class="hit"><td class="line">366</td><td class="hits">1</td><td class="source">  var buffer = new Buffer(2);</td></tr><tr class="hit"><td class="line">367</td><td class="hits">1</td><td class="source">  buffer[0] = TypeCode.TINYINT;</td></tr><tr class="hit"><td class="line">368</td><td class="hits">1</td><td class="source">  buffer.writeUInt8(value, 1);</td></tr><tr class="hit"><td class="line">369</td><td class="hits">1</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">370</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">371</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">372</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.SMALLINT] = function writeSmallInt(value) {</td></tr><tr class="hit"><td class="line">373</td><td class="hits">3</td><td class="source">  var buffer = new Buffer(3);</td></tr><tr class="hit"><td class="line">374</td><td class="hits">3</td><td class="source">  buffer[0] = TypeCode.SMALLINT;</td></tr><tr class="hit"><td class="line">375</td><td class="hits">3</td><td class="source">  buffer.writeInt16LE(value, 1);</td></tr><tr class="hit"><td class="line">376</td><td class="hits">3</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">377</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">378</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">379</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.INT] = function writeInt(value) {</td></tr><tr class="hit"><td class="line">380</td><td class="hits">15</td><td class="source">  var buffer = new Buffer(5);</td></tr><tr class="hit"><td class="line">381</td><td class="hits">15</td><td class="source">  buffer[0] = TypeCode.INT;</td></tr><tr class="hit"><td class="line">382</td><td class="hits">15</td><td class="source">  buffer.writeInt32LE(value, 1);</td></tr><tr class="hit"><td class="line">383</td><td class="hits">15</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">384</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">386</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.BIGINT] = function writeBigInt(value) {</td></tr><tr class="hit"><td class="line">387</td><td class="hits">2</td><td class="source">  var buffer = new Buffer(9);</td></tr><tr class="hit"><td class="line">388</td><td class="hits">2</td><td class="source">  buffer[0] = TypeCode.BIGINT;</td></tr><tr class="hit"><td class="line">389</td><td class="hits">2</td><td class="source">  bignum.writeInt64LE(buffer, value, 1);</td></tr><tr class="hit"><td class="line">390</td><td class="hits">2</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">391</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">392</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">393</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.REAL] = function writeReal(value) {</td></tr><tr class="hit"><td class="line">394</td><td class="hits">3</td><td class="source">  var buffer = new Buffer(5);</td></tr><tr class="hit"><td class="line">395</td><td class="hits">3</td><td class="source">  buffer[0] = TypeCode.REAL;</td></tr><tr class="hit"><td class="line">396</td><td class="hits">3</td><td class="source">  buffer.writeFloatLE(value, 1);</td></tr><tr class="hit"><td class="line">397</td><td class="hits">3</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">399</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">400</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.DOUBLE] = function writeDouble(value) {</td></tr><tr class="hit"><td class="line">401</td><td class="hits">1</td><td class="source">  var buffer = new Buffer(9);</td></tr><tr class="hit"><td class="line">402</td><td class="hits">1</td><td class="source">  buffer[0] = TypeCode.DOUBLE;</td></tr><tr class="hit"><td class="line">403</td><td class="hits">1</td><td class="source">  buffer.writeDoubleLE(value, 1);</td></tr><tr class="hit"><td class="line">404</td><td class="hits">1</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">405</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">406</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">407</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.DECIMAL] = function writeDecimal(value) {</td></tr><tr class="hit"><td class="line">408</td><td class="hits">4</td><td class="source">  var decimal;</td></tr><tr class="hit"><td class="line">409</td><td class="hits">4</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">410</td><td class="hits">1</td><td class="source">    decimal = stringToDecimal(value);</td></tr><tr class="hit"><td class="line">411</td><td class="hits">3</td><td class="source">  } else if (util.isNumber(value)) {</td></tr><tr class="hit"><td class="line">412</td><td class="hits">2</td><td class="source">    decimal = stringToDecimal(value.toExponential());</td></tr><tr><td class="line">413</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">414</td><td class="hits">1</td><td class="source">    throw createInputError('DECIMAL');</td></tr><tr><td class="line">415</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">416</td><td class="hits">2</td><td class="source">  var buffer = new Buffer(17);</td></tr><tr class="hit"><td class="line">417</td><td class="hits">2</td><td class="source">  buffer[0] = TypeCode.DECIMAL;</td></tr><tr class="hit"><td class="line">418</td><td class="hits">2</td><td class="source">  bignum.writeDec128(buffer, decimal, 1);</td></tr><tr class="hit"><td class="line">419</td><td class="hits">2</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">420</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">421</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">422</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.NSTRING] = function writeNString(value) {</td></tr><tr class="hit"><td class="line">423</td><td class="hits">6</td><td class="source">  this.writeCharacters(value, 'utf8');</td></tr><tr><td class="line">424</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">425</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">426</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.STRING] = function writeString(value) {</td></tr><tr class="hit"><td class="line">427</td><td class="hits">18</td><td class="source">  this.writeCharacters(value, 'ascii');</td></tr><tr><td class="line">428</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">429</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">430</td><td class="hits">1</td><td class="source">Writer.prototype.writeCharacters = function writeCharacters(value, encoding) {</td></tr><tr class="hit"><td class="line">431</td><td class="hits">24</td><td class="source">  var type = encoding === 'ascii' ? TypeCode.STRING : TypeCode.NSTRING;</td></tr><tr class="hit"><td class="line">432</td><td class="hits">24</td><td class="source">  var length = Buffer.byteLength(value, encoding);</td></tr><tr class="hit"><td class="line">433</td><td class="hits">23</td><td class="source">  var buffer;</td></tr><tr class="hit"><td class="line">434</td><td class="hits">23</td><td class="source">  if (length &lt;= 245) {</td></tr><tr class="hit"><td class="line">435</td><td class="hits">21</td><td class="source">    buffer = new Buffer(2 + length);</td></tr><tr class="hit"><td class="line">436</td><td class="hits">21</td><td class="source">    buffer[0] = type;</td></tr><tr class="hit"><td class="line">437</td><td class="hits">21</td><td class="source">    buffer[1] = length;</td></tr><tr class="hit"><td class="line">438</td><td class="hits">21</td><td class="source">    buffer.write(value, 2, length, encoding);</td></tr><tr class="hit"><td class="line">439</td><td class="hits">2</td><td class="source">  } else if (length &lt;= 32767) {</td></tr><tr class="hit"><td class="line">440</td><td class="hits">1</td><td class="source">    buffer = new Buffer(4 + length);</td></tr><tr class="hit"><td class="line">441</td><td class="hits">1</td><td class="source">    buffer[0] = type;</td></tr><tr class="hit"><td class="line">442</td><td class="hits">1</td><td class="source">    buffer[1] = 246;</td></tr><tr class="hit"><td class="line">443</td><td class="hits">1</td><td class="source">    buffer.writeInt16LE(length, 2);</td></tr><tr class="hit"><td class="line">444</td><td class="hits">1</td><td class="source">    buffer.write(value, 4, length, encoding);</td></tr><tr><td class="line">445</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">446</td><td class="hits">1</td><td class="source">    buffer = new Buffer(6 + length);</td></tr><tr class="hit"><td class="line">447</td><td class="hits">1</td><td class="source">    buffer[0] = type;</td></tr><tr class="hit"><td class="line">448</td><td class="hits">1</td><td class="source">    buffer[1] = 247;</td></tr><tr class="hit"><td class="line">449</td><td class="hits">1</td><td class="source">    buffer.writeInt32LE(length, 2);</td></tr><tr class="hit"><td class="line">450</td><td class="hits">1</td><td class="source">    buffer.write(value, 6, length, encoding);</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">452</td><td class="hits">23</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">453</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">455</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.BINARY] = function writeBinary(value) {</td></tr><tr class="hit"><td class="line">456</td><td class="hits">6</td><td class="source">  var length = value.length;</td></tr><tr class="hit"><td class="line">457</td><td class="hits">6</td><td class="source">  var buffer;</td></tr><tr class="hit"><td class="line">458</td><td class="hits">6</td><td class="source">  if (length &lt;= 245) {</td></tr><tr class="hit"><td class="line">459</td><td class="hits">4</td><td class="source">    buffer = new Buffer(2 + length);</td></tr><tr class="hit"><td class="line">460</td><td class="hits">4</td><td class="source">    buffer[0] = TypeCode.BINARY;</td></tr><tr class="hit"><td class="line">461</td><td class="hits">4</td><td class="source">    buffer[1] = length;</td></tr><tr class="hit"><td class="line">462</td><td class="hits">4</td><td class="source">    value.copy(buffer, 2);</td></tr><tr class="hit"><td class="line">463</td><td class="hits">2</td><td class="source">  } else if (length &lt;= 32767) {</td></tr><tr class="hit"><td class="line">464</td><td class="hits">1</td><td class="source">    buffer = new Buffer(4 + length);</td></tr><tr class="hit"><td class="line">465</td><td class="hits">1</td><td class="source">    buffer[0] = TypeCode.BINARY;</td></tr><tr class="hit"><td class="line">466</td><td class="hits">1</td><td class="source">    buffer[1] = 246;</td></tr><tr class="hit"><td class="line">467</td><td class="hits">1</td><td class="source">    buffer.writeInt16LE(length, 2);</td></tr><tr class="hit"><td class="line">468</td><td class="hits">1</td><td class="source">    value.copy(buffer, 4);</td></tr><tr><td class="line">469</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">470</td><td class="hits">1</td><td class="source">    buffer = new Buffer(6 + length);</td></tr><tr class="hit"><td class="line">471</td><td class="hits">1</td><td class="source">    buffer[0] = TypeCode.BINARY;</td></tr><tr class="hit"><td class="line">472</td><td class="hits">1</td><td class="source">    buffer[1] = 247;</td></tr><tr class="hit"><td class="line">473</td><td class="hits">1</td><td class="source">    buffer.writeInt32LE(length, 2);</td></tr><tr class="hit"><td class="line">474</td><td class="hits">1</td><td class="source">    value.copy(buffer, 6);</td></tr><tr><td class="line">475</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">476</td><td class="hits">6</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">477</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">478</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">479</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.BLOB] = function writeBLob(value) {</td></tr><tr class="hit"><td class="line">480</td><td class="hits">17</td><td class="source">  var buffer = new Buffer(10);</td></tr><tr class="hit"><td class="line">481</td><td class="hits">17</td><td class="source">  buffer.fill(0x00);</td></tr><tr class="hit"><td class="line">482</td><td class="hits">17</td><td class="source">  buffer[0] = TypeCode.BLOB;</td></tr><tr class="hit"><td class="line">483</td><td class="hits">17</td><td class="source">  this.pushLob(buffer, value);</td></tr><tr><td class="line">484</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">485</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">486</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.CLOB] = function writeCLob(value) {</td></tr><tr class="hit"><td class="line">487</td><td class="hits">4</td><td class="source">  var buffer = new Buffer(10);</td></tr><tr class="hit"><td class="line">488</td><td class="hits">4</td><td class="source">  buffer.fill(0x00);</td></tr><tr class="hit"><td class="line">489</td><td class="hits">4</td><td class="source">  buffer[0] = TypeCode.CLOB;</td></tr><tr class="hit"><td class="line">490</td><td class="hits">4</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">491</td><td class="hits">1</td><td class="source">    value = new Buffer(value, 'ascii');</td></tr><tr><td class="line">492</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">493</td><td class="hits">4</td><td class="source">  this.pushLob(buffer, value);</td></tr><tr><td class="line">494</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">495</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">496</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.NCLOB] = function writeNCLob(value) {</td></tr><tr class="hit"><td class="line">497</td><td class="hits">3</td><td class="source">  var buffer = new Buffer(10);</td></tr><tr class="hit"><td class="line">498</td><td class="hits">3</td><td class="source">  buffer.fill(0x00);</td></tr><tr class="hit"><td class="line">499</td><td class="hits">3</td><td class="source">  buffer[0] = TypeCode.NCLOB;</td></tr><tr class="hit"><td class="line">500</td><td class="hits">3</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">501</td><td class="hits">1</td><td class="source">    value = new Buffer(value, 'utf8');</td></tr><tr><td class="line">502</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">503</td><td class="hits">3</td><td class="source">  this.pushLob(buffer, value);</td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">505</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">506</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.TIME] = function writeTime(value) {</td></tr><tr><td class="line">507</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">508</td><td class="hits">4</td><td class="source">  var hours, minutes, milliseconds;</td></tr><tr class="hit"><td class="line">509</td><td class="hits">4</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">510</td><td class="hits">3</td><td class="source">    var time = value.match(REGEX.TIME);</td></tr><tr class="hit"><td class="line">511</td><td class="hits">3</td><td class="source">    if (!time) {</td></tr><tr class="hit"><td class="line">512</td><td class="hits">1</td><td class="source">      throw createInputError('TIME');</td></tr><tr><td class="line">513</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">514</td><td class="hits">2</td><td class="source">    hours = ~~time[1];</td></tr><tr class="hit"><td class="line">515</td><td class="hits">2</td><td class="source">    minutes = ~~time[2];</td></tr><tr class="hit"><td class="line">516</td><td class="hits">2</td><td class="source">    milliseconds = Math.floor(time[3] * 1000);</td></tr><tr><td class="line">517</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">518</td><td class="hits">1</td><td class="source">    throw createInputError('TIME');</td></tr><tr><td class="line">519</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">520</td><td class="hits">2</td><td class="source">  var buffer = new Buffer(5);</td></tr><tr class="hit"><td class="line">521</td><td class="hits">2</td><td class="source">  buffer[0] = TypeCode.TIME;</td></tr><tr class="hit"><td class="line">522</td><td class="hits">2</td><td class="source">  buffer[1] = hours | 0x80;</td></tr><tr class="hit"><td class="line">523</td><td class="hits">2</td><td class="source">  buffer[2] = minutes;</td></tr><tr class="hit"><td class="line">524</td><td class="hits">2</td><td class="source">  buffer.writeUInt16LE(milliseconds, 3);</td></tr><tr class="hit"><td class="line">525</td><td class="hits">2</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">526</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">527</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">528</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.DATE] = function writeDate(value) {</td></tr><tr><td class="line">529</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">530</td><td class="hits">4</td><td class="source">  var year, month, day;</td></tr><tr class="hit"><td class="line">531</td><td class="hits">4</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">532</td><td class="hits">3</td><td class="source">    var date = value.match(REGEX.DATE);</td></tr><tr class="hit"><td class="line">533</td><td class="hits">3</td><td class="source">    if (!date) {</td></tr><tr class="hit"><td class="line">534</td><td class="hits">1</td><td class="source">      throw createInputError('DATE');</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">536</td><td class="hits">2</td><td class="source">    year = ~~date[1];</td></tr><tr class="hit"><td class="line">537</td><td class="hits">2</td><td class="source">    month = ~~date[2] - 1;</td></tr><tr class="hit"><td class="line">538</td><td class="hits">2</td><td class="source">    day = ~~date[3];</td></tr><tr><td class="line">539</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">540</td><td class="hits">1</td><td class="source">    throw createInputError('DATE');</td></tr><tr><td class="line">541</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">542</td><td class="hits">2</td><td class="source">  var buffer = new Buffer(5);</td></tr><tr class="hit"><td class="line">543</td><td class="hits">2</td><td class="source">  buffer[0] = TypeCode.DATE;</td></tr><tr class="hit"><td class="line">544</td><td class="hits">2</td><td class="source">  buffer.writeUInt16LE(year, 1);</td></tr><tr class="hit"><td class="line">545</td><td class="hits">2</td><td class="source">  buffer[2] |= 0x80;</td></tr><tr class="hit"><td class="line">546</td><td class="hits">2</td><td class="source">  buffer[3] = month;</td></tr><tr class="hit"><td class="line">547</td><td class="hits">2</td><td class="source">  buffer[4] = day;</td></tr><tr class="hit"><td class="line">548</td><td class="hits">2</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">549</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">550</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">551</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.TIMESTAMP] = function writeTimestamp(value) {</td></tr><tr><td class="line">552</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">553</td><td class="hits">5</td><td class="source">  var year, month, day, hours, minutes, milliseconds;</td></tr><tr class="hit"><td class="line">554</td><td class="hits">5</td><td class="source">  if (util.isString(value)) {</td></tr><tr class="hit"><td class="line">555</td><td class="hits">4</td><td class="source">    var ts = value.match(REGEX.TIMESTAMP);</td></tr><tr class="hit"><td class="line">556</td><td class="hits">4</td><td class="source">    if (!ts) {</td></tr><tr class="hit"><td class="line">557</td><td class="hits">1</td><td class="source">      throw createInputError('TIMESTAMP');</td></tr><tr><td class="line">558</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">559</td><td class="hits">3</td><td class="source">    year = ~~ts[1];</td></tr><tr class="hit"><td class="line">560</td><td class="hits">3</td><td class="source">    month = ~~ts[2] - 1;</td></tr><tr class="hit"><td class="line">561</td><td class="hits">3</td><td class="source">    day = ~~ts[3];</td></tr><tr class="hit"><td class="line">562</td><td class="hits">3</td><td class="source">    hours = ~~ts[4];</td></tr><tr class="hit"><td class="line">563</td><td class="hits">3</td><td class="source">    minutes = ~~ts[5];</td></tr><tr class="hit"><td class="line">564</td><td class="hits">3</td><td class="source">    milliseconds = Math.floor(ts[6] * 1000);</td></tr><tr><td class="line">565</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">566</td><td class="hits">1</td><td class="source">    throw createInputError('TIMESTAMP');</td></tr><tr><td class="line">567</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">568</td><td class="hits">3</td><td class="source">  var buffer = new Buffer(9);</td></tr><tr class="hit"><td class="line">569</td><td class="hits">3</td><td class="source">  buffer[0] = TypeCode.TIMESTAMP;</td></tr><tr class="hit"><td class="line">570</td><td class="hits">3</td><td class="source">  buffer.writeUInt16LE(year, 1);</td></tr><tr class="hit"><td class="line">571</td><td class="hits">3</td><td class="source">  buffer[2] |= 0x80;</td></tr><tr class="hit"><td class="line">572</td><td class="hits">3</td><td class="source">  buffer[3] = month;</td></tr><tr class="hit"><td class="line">573</td><td class="hits">3</td><td class="source">  buffer[4] = day;</td></tr><tr class="hit"><td class="line">574</td><td class="hits">3</td><td class="source">  buffer[5] = hours | 0x80;</td></tr><tr class="hit"><td class="line">575</td><td class="hits">3</td><td class="source">  buffer[6] = minutes;</td></tr><tr class="hit"><td class="line">576</td><td class="hits">3</td><td class="source">  buffer.writeUInt16LE(milliseconds, 7);</td></tr><tr class="hit"><td class="line">577</td><td class="hits">3</td><td class="source">  this.push(buffer);</td></tr><tr><td class="line">578</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">579</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">580</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.DAYDATE] = function writeDayDate(value) {</td></tr><tr><td class="line">581</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">582</td><td class="hits">1</td><td class="source">  throw createNotImplementedError();</td></tr><tr><td class="line">583</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">584</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">585</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.SECONDTIME] = function writeSecondTime(value) {</td></tr><tr><td class="line">586</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">587</td><td class="hits">1</td><td class="source">  throw createNotImplementedError();</td></tr><tr><td class="line">588</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">589</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">590</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.LONGDATE] = function writeLongDate(value) {</td></tr><tr><td class="line">591</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">592</td><td class="hits">1</td><td class="source">  throw createNotImplementedError();</td></tr><tr><td class="line">593</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">594</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">595</td><td class="hits">1</td><td class="source">Writer.prototype[TypeCode.SECONDDATE] = function writeSecondDate(value) {</td></tr><tr><td class="line">596</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">597</td><td class="hits">1</td><td class="source">  throw createNotImplementedError();</td></tr><tr><td class="line">598</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">599</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">600</td><td class="hits">1</td><td class="source">function stringToDecimal(str) {</td></tr><tr><td class="line">601</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">602</td><td class="hits">3</td><td class="source">  var dec = str.match(REGEX.DECIMAL);</td></tr><tr class="hit"><td class="line">603</td><td class="hits">3</td><td class="source">  if (!dec) {</td></tr><tr class="hit"><td class="line">604</td><td class="hits">1</td><td class="source">    throw createInputError('DECIMAL');</td></tr><tr><td class="line">605</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">606</td><td class="hits">2</td><td class="source">  var sign = dec[1] === '-' ? -1 : 1;</td></tr><tr class="hit"><td class="line">607</td><td class="hits">2</td><td class="source">  var mInt = dec[2] || '0';</td></tr><tr class="hit"><td class="line">608</td><td class="hits">2</td><td class="source">  var mFrac = dec[3] || '';</td></tr><tr class="hit"><td class="line">609</td><td class="hits">2</td><td class="source">  var exp = ~~dec[4];</td></tr><tr class="hit"><td class="line">610</td><td class="hits">2</td><td class="source">  return {</td></tr><tr><td class="line">611</td><td class="hits"></td><td class="source">    s: sign,</td></tr><tr><td class="line">612</td><td class="hits"></td><td class="source">    m: mInt + mFrac,</td></tr><tr><td class="line">613</td><td class="hits"></td><td class="source">    e: exp - mFrac.length</td></tr><tr><td class="line">614</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">615</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">616</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">617</td><td class="hits">1</td><td class="source">function createInputError(type) {</td></tr><tr class="hit"><td class="line">618</td><td class="hits">9</td><td class="source">  return new Error(util.format('Wrong input for %s type', type));</td></tr><tr><td class="line">619</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">620</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">621</td><td class="hits">1</td><td class="source">function createNotImplementedError() {</td></tr><tr class="hit"><td class="line">622</td><td class="hits">4</td><td class="source">  return new Error('Not implemented yet');</td></tr><tr><td class="line">623</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">624</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">625</td><td class="hits">1</td><td class="source">function createReadStreamError() {</td></tr><tr class="hit"><td class="line">626</td><td class="hits">2</td><td class="source">  return new Error('Chunk length larger than remaining bytes');</td></tr><tr><td class="line">627</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/auth/Manager.js">protocol/auth/Manager.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">66</div><div class="hits">66</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var SCRAMSHA256 = require('./SCRAMSHA256');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var SAML = require('./SAML');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var SessionCookie = require('./SessionCookie');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">module.exports = Manager;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">function Manager(options) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">11</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">24</td><td class="hits">11</td><td class="source">  this.user = options.user || '';</td></tr><tr class="hit"><td class="line">25</td><td class="hits">11</td><td class="source">  this._authMethod = undefined;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">11</td><td class="source">  this._authMethods = [];</td></tr><tr class="hit"><td class="line">27</td><td class="hits">11</td><td class="source">  if (options.assertion || (!options.user &amp;&amp; options.password)) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">    this._authMethods.push(new SAML(options));</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">30</td><td class="hits">11</td><td class="source">  if (options.sessionCookie) {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">    this._authMethods.push(new SessionCookie(options));</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">33</td><td class="hits">11</td><td class="source">  if (options.user &amp;&amp; options.password) {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">8</td><td class="source">    this._authMethods.push(new SCRAMSHA256(options));</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">36</td><td class="hits">11</td><td class="source">  if (!this._authMethods.length) {</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">    throw noAuthMethodFound();</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">Object.defineProperties(Manager.prototype, {</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  userFromServer: {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    get: function getUserFromServer() {</td></tr><tr class="hit"><td class="line">44</td><td class="hits">11</td><td class="source">      if (this._authMethod &amp;&amp; this._authMethod.user) {</td></tr><tr class="hit"><td class="line">45</td><td class="hits">2</td><td class="source">        return this._authMethod.user;</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">47</td><td class="hits">9</td><td class="source">      return this.user;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  sessionCookie: {</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    get: function getSessionCookie() {</td></tr><tr class="hit"><td class="line">52</td><td class="hits">5</td><td class="source">      if (this._authMethod &amp;&amp; this._authMethod.sessionCookie) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">        return this._authMethod.sessionCookie;</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">Manager.prototype.initialData = function initialData() {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">8</td><td class="source">  var fields = [this.user];</td></tr><tr class="hit"><td class="line">61</td><td class="hits">8</td><td class="source">  this._authMethods.forEach(function initialDataOfMethod(method) {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">8</td><td class="source">    fields.push(method.name, method.initialData());</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">64</td><td class="hits">8</td><td class="source">  return fields;</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">Manager.prototype.initialize = function initialize(fields) {</td></tr><tr class="hit"><td class="line">68</td><td class="hits">8</td><td class="source">  var initializedMethods = [];</td></tr><tr class="hit"><td class="line">69</td><td class="hits">8</td><td class="source">  var name, method, buffer;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">8</td><td class="source">  while (fields.length) {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">8</td><td class="source">    name = fields.shift().toString('ascii');</td></tr><tr class="hit"><td class="line">72</td><td class="hits">8</td><td class="source">    method = this.getMethod(name);</td></tr><tr class="hit"><td class="line">73</td><td class="hits">8</td><td class="source">    buffer = fields.shift();</td></tr><tr class="hit"><td class="line">74</td><td class="hits">8</td><td class="source">    if (method &amp;&amp; buffer) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">7</td><td class="source">      method.initialize(buffer);</td></tr><tr class="hit"><td class="line">76</td><td class="hits">7</td><td class="source">      initializedMethods.push(method);</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">79</td><td class="hits">8</td><td class="source">  if (!initializedMethods.length) {</td></tr><tr class="hit"><td class="line">80</td><td class="hits">1</td><td class="source">    throw noAuthMethodFound();</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">82</td><td class="hits">7</td><td class="source">  this._authMethod = initializedMethods.shift();</td></tr><tr class="hit"><td class="line">83</td><td class="hits">7</td><td class="source">  this._authMethods = undefined;</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">Manager.prototype.finalData = function finalData() {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">6</td><td class="source">  var fields = [this.userFromServer];</td></tr><tr class="hit"><td class="line">88</td><td class="hits">6</td><td class="source">  if (this._authMethod) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">6</td><td class="source">    fields.push(this._authMethod.name, this._authMethod.finalData());</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">91</td><td class="hits">6</td><td class="source">  return fields;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">94</td><td class="hits">1</td><td class="source">Manager.prototype.finalize = function finalize(fields) {</td></tr><tr class="hit"><td class="line">95</td><td class="hits">7</td><td class="source">  var name, buffer;</td></tr><tr class="hit"><td class="line">96</td><td class="hits">7</td><td class="source">  while (fields.length) {</td></tr><tr class="hit"><td class="line">97</td><td class="hits">7</td><td class="source">    name = fields.shift().toString('ascii');</td></tr><tr class="hit"><td class="line">98</td><td class="hits">7</td><td class="source">    buffer = fields.shift();</td></tr><tr class="hit"><td class="line">99</td><td class="hits">7</td><td class="source">    if (this._authMethod.name === name) {</td></tr><tr class="hit"><td class="line">100</td><td class="hits">7</td><td class="source">      this._authMethod.finalize(buffer);</td></tr><tr class="hit"><td class="line">101</td><td class="hits">7</td><td class="source">      break;</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">106</td><td class="hits">1</td><td class="source">Manager.prototype.getMethod = function getMethod(name) {</td></tr><tr class="hit"><td class="line">107</td><td class="hits">8</td><td class="source">  var method;</td></tr><tr class="hit"><td class="line">108</td><td class="hits">8</td><td class="source">  for (var i = 0; i &lt; this._authMethods.length; i++) {</td></tr><tr class="hit"><td class="line">109</td><td class="hits">8</td><td class="source">    method = this._authMethods[i];</td></tr><tr class="hit"><td class="line">110</td><td class="hits">8</td><td class="source">    if (method.name === name) {</td></tr><tr class="hit"><td class="line">111</td><td class="hits">7</td><td class="source">      return method;</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">116</td><td class="hits">1</td><td class="source">function noAuthMethodFound() {</td></tr><tr class="hit"><td class="line">117</td><td class="hits">2</td><td class="source">  var error = new Error('No authentication method found');</td></tr><tr class="hit"><td class="line">118</td><td class="hits">2</td><td class="source">  error.code = 'EHDBNOAUTHMETH';</td></tr><tr class="hit"><td class="line">119</td><td class="hits">2</td><td class="source">  return error;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/auth/SAML.js">protocol/auth/SAML.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">16</div><div class="hits">16</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = SAML;</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">function SAML(options) {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">  this.name = 'SAML';</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">  this.assertion = options.assertion || options.password;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  this.user = undefined;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">  this.sessionCookie = undefined;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">SAML.prototype.initialData = function initialData() {</td></tr><tr class="hit"><td class="line">27</td><td class="hits">2</td><td class="source">  return this.assertion;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">SAML.prototype.initialize = function initialize(buffer) {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  this.user = buffer.toString('utf8');</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">SAML.prototype.finalData = function finalData() {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">2</td><td class="source">  return new Buffer(0);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">SAML.prototype.finalize = function finalize(buffer) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">  this.sessionCookie = buffer;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/auth/SCRAMSHA256.js">protocol/auth/SCRAMSHA256.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">55</div><div class="hits">55</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var crypto = require('crypto');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Fields = require('../data/Fields');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var CLIENT_PROOF_SIZE = 32;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var CLIENT_CHALLENGE_SIZE = 64;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">module.exports = SCRAMSHA256;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function createClientChallenge() {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">4</td><td class="source">  return crypto.randomBytes(CLIENT_CHALLENGE_SIZE);</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">function SCRAMSHA256(options) {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">8</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">31</td><td class="hits">8</td><td class="source">  this.name = 'SCRAMSHA256';</td></tr><tr class="hit"><td class="line">32</td><td class="hits">8</td><td class="source">  this.password = options.password;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">8</td><td class="source">  if (util.isString(this.password)) {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">8</td><td class="source">    this.password = new Buffer(this.password, 'utf8');</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">36</td><td class="hits">8</td><td class="source">  this.clientChallenge = options.clientChallenge || createClientChallenge();</td></tr><tr class="hit"><td class="line">37</td><td class="hits">8</td><td class="source">  this.clientProof = undefined;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">SCRAMSHA256.prototype.initialData = function initialData() {</td></tr><tr class="hit"><td class="line">41</td><td class="hits">8</td><td class="source">  return this.clientChallenge;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">SCRAMSHA256.prototype.initialize = function initialize(buffer) {</td></tr><tr class="hit"><td class="line">45</td><td class="hits">5</td><td class="source">  var serverChallengeData = Fields.read({</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    argumentCount: 1,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    buffer: buffer</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">49</td><td class="hits">5</td><td class="source">  this.clientProof = calculateClientProof([serverChallengeData[0]],</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    serverChallengeData[1], this.clientChallenge, this.password);</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">SCRAMSHA256.prototype.finalData = function finalData() {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">6</td><td class="source">  return this.clientProof;</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">SCRAMSHA256.prototype.finalize = function finalize(buffer) {</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">function calculateClientProof(salts, serverKey, clientKey, password) {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">5</td><td class="source">  var buf = new Buffer(2 + (CLIENT_PROOF_SIZE + 1) * salts.length);</td></tr><tr class="hit"><td class="line">63</td><td class="hits">5</td><td class="source">  buf[0] = 0x00;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">5</td><td class="source">  buf.writeInt8(salts.length, 1);</td></tr><tr class="hit"><td class="line">65</td><td class="hits">5</td><td class="source">  var offset = 2;</td></tr><tr class="hit"><td class="line">66</td><td class="hits">5</td><td class="source">  salts.forEach(function scrambleSalt(salt) {</td></tr><tr class="hit"><td class="line">67</td><td class="hits">5</td><td class="source">    buf.writeInt8(CLIENT_PROOF_SIZE, offset);</td></tr><tr class="hit"><td class="line">68</td><td class="hits">5</td><td class="source">    offset += 1;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">5</td><td class="source">    scramble(salt, serverKey, clientKey, password).copy(buf, offset);</td></tr><tr class="hit"><td class="line">70</td><td class="hits">5</td><td class="source">    offset += CLIENT_PROOF_SIZE;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">72</td><td class="hits">5</td><td class="source">  return buf;</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">function scramble(salt, serverKey, clientKey, password) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">5</td><td class="source">  var length = salt.length + serverKey.length + clientKey.length;</td></tr><tr class="hit"><td class="line">77</td><td class="hits">5</td><td class="source">  var msg = Buffer.concat([salt, serverKey, clientKey], length);</td></tr><tr class="hit"><td class="line">78</td><td class="hits">5</td><td class="source">  var key = sha256(hmac(password, salt));</td></tr><tr class="hit"><td class="line">79</td><td class="hits">5</td><td class="source">  var sig = hmac(sha256(key), msg);</td></tr><tr class="hit"><td class="line">80</td><td class="hits">5</td><td class="source">  return xor(sig, key);</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">function xor(a, b) {</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">85</td><td class="hits">5</td><td class="source">  var result = new Buffer(a.length);</td></tr><tr class="hit"><td class="line">86</td><td class="hits">5</td><td class="source">  for (var i = 0; i &lt; a.length; i++) {</td></tr><tr class="hit"><td class="line">87</td><td class="hits">160</td><td class="source">    result[i] = a[i] ^ b[i];</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">89</td><td class="hits">5</td><td class="source">  return result;</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">92</td><td class="hits">1</td><td class="source">function hmac(key, msg) {</td></tr><tr class="hit"><td class="line">93</td><td class="hits">10</td><td class="source">  var hash = crypto.createHmac('sha256', key);</td></tr><tr class="hit"><td class="line">94</td><td class="hits">10</td><td class="source">  hash.update(msg);</td></tr><tr class="hit"><td class="line">95</td><td class="hits">10</td><td class="source">  return new Buffer(hash.digest(), 'binary');</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">98</td><td class="hits">1</td><td class="source">function sha256(msg) {</td></tr><tr class="hit"><td class="line">99</td><td class="hits">10</td><td class="source">  var hash = crypto.createHash('sha256');</td></tr><tr class="hit"><td class="line">100</td><td class="hits">10</td><td class="source">  hash.update(msg);</td></tr><tr class="hit"><td class="line">101</td><td class="hits">10</td><td class="source">  return new Buffer(hash.digest(), 'binary');</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/auth/SessionCookie.js">protocol/auth/SessionCookie.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">17</div><div class="hits">17</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var os = require('os');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">module.exports = SessionCookie;</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">function SessionCookie(options) {</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">  this.name = 'SessionCookie';</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">  var pid = process.pid || 'nodejs';</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">  var termId = new Buffer(pid + '@' + os.hostname(), 'utf8');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">  var rawSessionCookie = options.sessionCookie;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">  var length = rawSessionCookie.length + termId.length;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">  this.sessionCookie = new Buffer.concat([rawSessionCookie, termId], length);</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">SessionCookie.prototype.initialData = function initialData() {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  return this.sessionCookie;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">SessionCookie.prototype.initialize = function initialize(buffer) {</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">SessionCookie.prototype.finalData = function finalData() {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">  return new Buffer(0);</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">SessionCookie.prototype.finalize = function finalize(buffer) {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/auth/index.js">protocol/auth/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">4</div><div class="hits">4</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var Manager = require('./Manager');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.createManager = function createManager(options) {</td></tr><tr class="hit"><td class="line">19</td><td class="hits">11</td><td class="source">  return new Manager(options);</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ClientDistributionMode.js">protocol/common/ClientDistributionMode.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  OFF: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  CONNECTION: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  STATEMENT_ONLY: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  STATEMENT_CONNECTION: 3</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/CommandOption.js">protocol/common/CommandOption.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  SELFETCH_OFF: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  SCROLLABLE_CURSOR_ON: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  NO_RESULT_SET_CLOSE_NEEDED: 4,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  HOLD_CURSORS_OVER_COMMIT: 8,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  EXECUTE_LOCALLY: 16</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/CommitOption.js">protocol/common/CommitOption.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  HOLD_CURSORS_OVER_COMMIT: 1</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ConnectOption.js">protocol/common/ConnectOption.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  CONNECTION_ID: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  COMPLETE_ARRAY_EXECUTION: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  CLIENT_LOCALE: 3,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  SUPPORTS_LARGE_BULK_OPERATIONS: 4,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  LARGE_NUMBER_OF_PARAMETERS_SUPPORT: 10,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  SYSTEM_ID: 11,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  DATA_FORMAT_VERSION: 12,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  SELECT_FOR_UPDATE_SUPPORTED: 14,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  CLIENT_DISTRIBUTION_MODE: 15,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  ENGINE_DATA_FORMAT_VERSION: 16,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  DISTRIBUTION_PROTOCOL_VERSION: 17,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  SPLIT_BATCH_COMMANDS: 18,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  USE_TRANSACTION_FLAGS_ONLY: 19,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  ROW_AND_COLUMN_OPTIMIZED_FORMAT: 20,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  IGNORE_UNKNOWN_PARTS: 21,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  DATA_FORMAT_VERSION2: 23</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ConnectOptionType.js">protocol/common/ConnectOptionType.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">20</div><div class="hits">20</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var ConnectOption = require('./ConnectOption');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var TypeCode = require('./TypeCode');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var ConnectOptionType = module.exports = {};</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.CONNECTION_ID] = TypeCode.INT;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.COMPLETE_ARRAY_EXECUTION] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.CLIENT_LOCALE] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.SUPPORTS_LARGE_BULK_OPERATIONS] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.LARGE_NUMBER_OF_PARAMETERS_SUPPORT] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.SYSTEM_ID] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.DATA_FORMAT_VERSION] = TypeCode.INT;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.SELECT_FOR_UPDATE_SUPPORTED] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.CLIENT_DISTRIBUTION_MODE] = TypeCode.INT;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.ENGINE_DATA_FORMAT_VERSION] = TypeCode.INT;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.DISTRIBUTION_PROTOCOL_VERSION] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.SPLIT_BATCH_COMMANDS] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.USE_TRANSACTION_FLAGS_ONLY] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.ROW_AND_COLUMN_OPTIMIZED_FORMAT] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.IGNORE_UNKNOWN_PARTS] = TypeCode.BOOLEAN;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">ConnectOptionType[ConnectOption.DATA_FORMAT_VERSION2] = TypeCode.INT;</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/Constants.js">protocol/common/Constants.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">7</div><div class="hits">7</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var ConnectOption = require('./ConnectOption');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var TypeCode = require('./TypeCode');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var ClientDistributionMode = require('./ClientDistributionMode');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var DataFormatVersion = require('./DataFormatVersion');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var DistributionProtocolVersion = require('./DistributionProtocolVersion');</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  PACKET_HEADER_LENGTH: 32,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  SEGMENT_HEADER_LENGTH: 24,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  PART_HEADER_LENGTH: 16,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  MAX_PACKET_SIZE: Math.pow(2, 17),</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  MAX_RESULT_SET_SIZE: Math.pow(2, 20),</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  DEFAULT_CONNECT_OPTIONS: [{</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">    name: ConnectOption.CLIENT_LOCALE,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">    value: 'en_US',</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">    type: TypeCode.STRING</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    name: ConnectOption.COMPLETE_ARRAY_EXECUTION,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">    value: true,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    type: TypeCode.BOOLEAN</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    name: ConnectOption.DATA_FORMAT_VERSION2,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">    value: DataFormatVersion.COMPLETE_DATATYPE_SUPPORT,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">    type: TypeCode.INT</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    name: ConnectOption.DATA_FORMAT_VERSION,</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    value: DataFormatVersion.COMPLETE_DATATYPE_SUPPORT,</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    type: TypeCode.INT</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    name: ConnectOption.DISTRIBUTION_ENABLED,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">    value: false,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    type: TypeCode.BOOLEAN</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    name: ConnectOption.DISTRIBUTION_MODE,</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    value: ClientDistributionMode.OFF,</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    type: TypeCode.INT</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">    name: ConnectOption.DISTRIBUTION_PROTOCOL_VERSION,</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">    value: DistributionProtocolVersion.BASE,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    type: TypeCode.INT</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    name: ConnectOption.SELECT_FOR_UPDATE_SUPPORTED,</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    value: false,</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    type: TypeCode.BOOLEAN</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  }, {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    name: ConnectOption.ROW_AND_COLUMN_OPTIMIZED_FORMAT,</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    value: true,</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">    type: TypeCode.BOOLEAN</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  }]</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/DataFormatVersion.js">protocol/common/DataFormatVersion.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  BASE_FORMAT: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  COMPLETE_DATATYPE_SUPPORT: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  // deprecated</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  EXTENDED_DATE_TIME_SUPPORT: 3,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  LEVEL4: 4</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/DistributionProtocolVersion.js">protocol/common/DistributionProtocolVersion.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  BASE: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  STATEMENT_SEQUENCE_NUMBER_SUPPORTED: 1</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ErrorLevel.js">protocol/common/ErrorLevel.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  WARNING: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  ERROR: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  FATAL: 2</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/FunctionCode.js">protocol/common/FunctionCode.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  NIL: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  DDL: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  INSERT: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  UPDATE: 3,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  DELETE: 4,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  SELECT: 5,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  SELECT_FOR_UPDATE: 6,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  EXPLAIN: 7,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  DB_PROCEDURE_CALL: 8,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  DB_PROCEDURE_CALL_WITH_RESULT: 9,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  FETCH: 10,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  COMMIT: 11,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  ROLLBACK: 12,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  SAVEPOINT: 13,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  CONNECT: 14,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  WRITE_LOB: 15,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  READ_LOB: 16,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  PING: 17,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  DISCONNECT: 18,</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  CLOSE_CURSOR: 19,</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  FIND_LOB: 20,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  ABAP_STREAM: 21,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  XA_START: 22,</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  XA_JOIN: 23</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/IoType.js">protocol/common/IoType.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  INPUT: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  IN_OUT: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  OUTPUT: 4</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/LobOptions.js">protocol/common/LobOptions.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  NULL_INDICATOR: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  DATA_INCLUDED: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  LAST_DATA: 4</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/LobSourceType.js">protocol/common/LobSourceType.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  UNKNOWN: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  BLOB: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  CLOB: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  NCLOB: 3</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/MessageType.js">protocol/common/MessageType.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  NIL: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  EXECUTE_DIRECT: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  PREPARE: 3,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  ABAP_STREAM: 4,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  XA_START: 5,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  XA_JOIN: 6,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  EXECUTE: 13,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  READ_LOB: 16,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  WRITE_LOB: 17,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  FIND_LOB: 18,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  PING: 25,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  AUTHENTICATE: 65,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  CONNECT: 66,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  COMMIT: 67,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  ROLLBACK: 68,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  CLOSE_RESULT_SET: 69,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  DROP_STATEMENT_ID: 70,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  FETCH_NEXT: 71,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  DISCONNECT: 77,</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  EXECUTE_ITAB: 78,</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  FETCH_NEXT_ITAB: 79,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  INSERT_NEXT_ITAB: 80,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  BATCH_PREPARE: 81</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/NormalizedTypeCode.js">protocol/common/NormalizedTypeCode.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">35</div><div class="hits">35</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var TypeCode = require('./TypeCode');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var NormalizedTypeCode = module.exports = {};</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">// TinyInt</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.TINYINT] = TypeCode.TINYINT;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">// SmallInt</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.SMALLINT] = TypeCode.SMALLINT;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">// Int</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.INT] = TypeCode.INT;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">// BigInt</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.BIGINT] = TypeCode.BIGINT;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">// Double</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.DOUBLE] = TypeCode.DOUBLE;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">// Real</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.REAL] = TypeCode.REAL;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">// Decimal</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.DECIMAL] = TypeCode.DECIMAL;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">// String</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.STRING] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.VARCHAR1] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.VARCHAR2] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.CHAR] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.SHORTTEXT] = TypeCode.STRING;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.ALPHANUM] = TypeCode.STRING;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">// NString</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.NCHAR] = TypeCode.NSTRING;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.NVARCHAR] = TypeCode.NSTRING;</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.NSTRING] = TypeCode.NSTRING;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">// Binary</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.BINARY] = TypeCode.BINARY;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.VARBINARY] = TypeCode.BINARY;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.BSTRING] = TypeCode.BINARY;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">// BLob</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.BLOB] = TypeCode.BLOB;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.LOCATOR] = TypeCode.BLOB;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">// Clob</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.CLOB] = TypeCode.CLOB;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">// NCLob</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.NCLOB] = TypeCode.NCLOB;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.NLOCATOR] = TypeCode.NCLOB;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.TEXT] = TypeCode.NCLOB;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">// Date</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.DATE] = TypeCode.DATE;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">// Time</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.TIME] = TypeCode.TIME;</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">// Timestamp</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.TIMESTAMP] = TypeCode.TIMESTAMP;</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">// DayDate</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.DAYDATE] = TypeCode.DAYDATE;</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">// SecondTime</td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.SECONDTIME] = TypeCode.SECONDTIME;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">// LongDate</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.LONGDATE] = TypeCode.LONGDATE;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">// SecondDate</td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">NormalizedTypeCode[TypeCode.SECONDDATE] = TypeCode.SECONDDATE;</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ParameterMode.js">protocol/common/ParameterMode.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  MANDATORY: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  OPTIONAL: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  DEFAULT: 4,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  ESCAPE_CHAR: 8,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  READONLY: 16,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  AUTO_INCREMENT: 32</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/PartKind.js">protocol/common/PartKind.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  NIL: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  COMMAND: 3,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  RESULT_SET: 5,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  ERROR: 6,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  STATEMENT_ID: 10,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  TRANSACTION_ID: 11,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  ROWS_AFFECTED: 12,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  RESULT_SET_ID: 13,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  TOPOLOGY_INFORMATION: 15,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  TABLE_LOCATION: 16,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  READ_LOB_REQUEST: 17,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  READ_LOB_REPLY: 18,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  TABLE_NAME: 19,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  /*</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  ABAP_ISTREAM: 25,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  ABAP_OSTREAM: 26,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  */</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  COMMAND_INFO: 27,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  WRITE_LOB_REQUEST: 28,</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  WRITE_LOB_REPLY: 30,</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  PARAMETERS: 32,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  AUTHENTICATION: 33,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  SESSION_CONTEXT: 34,</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  CLIENT_ID: 35,</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  STATEMENT_CONTEXT: 39,</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  PARTITION_INFORMATION: 40,</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  OUTPUT_PARAMETERS: 41,</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  CONNECT_OPTIONS: 42,</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  COMMIT_OPTIONS: 43,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  FETCH_OPTIONS: 44,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  FETCH_SIZE: 45,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  PARAMETER_METADATA: 47,</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  RESULT_SET_METADATA: 48,</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  FIND_LOB_REQUEST: 49,</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  FIND_LOB_REPLY: 50,</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  /*</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  ITAB_SHM: 51,</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  ITAB_CHUNK_METADATA: 53,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  ITAB_METADATA: 55,</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  ITAB_RESULT_CHUNK: 56,</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  */</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  CLIENT_INFO: 57,</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  /*</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  STREAM_DATA: 58,</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  OSTREAM_RESULT: 59,</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  FDA_REQUEST_METADATA: 60,</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  FDA_REPLY_METADATA: 61,</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  BATCH_PREPARE: 62,</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  BATCH_EXECUTE: 63,</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  */</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  TRANSACTION_FLAGS: 64</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ReadFunction.js">protocol/common/ReadFunction.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">54</div><div class="hits">54</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var TypeCode = require('./TypeCode');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var ReadFunction = module.exports = {};</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var READ_TINYINT = 'readTinyInt';</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var READ_SMALLINT = 'readSmallInt';</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var READ_INT = 'readInt';</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var READ_BIGINT = 'readBigInt';</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var READ_STRING = 'readString';</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var READ_BINARY = 'readBinary';</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">var READ_DATE = 'readDate';</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">var READ_DAYDATE = 'readDayDate';</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">var READ_TIME = 'readTime';</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">var READ_SECONDTIME = 'readSecondTime';</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">var READ_TIMESTAMP = 'readTimestamp';</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">var READ_LONGDATE = 'readLongDate';</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">var READ_SECONDDATE = 'readSecondDate';</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">var READ_BLOB = 'readBLob';</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">var READ_CLOB = 'readCLob';</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">var READ_NCLOB = 'readNCLob';</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">var READ_DOUBLE = 'readDouble';</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">var READ_FLOAT = 'readFloat';</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">var READ_DECIMAL = 'readDecimal';</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.TINYINT] = READ_TINYINT;</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.SMALLINT] = READ_SMALLINT;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.INT] = READ_INT;</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.BIGINT] = READ_BIGINT;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.STRING] = READ_STRING;</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.VARCHAR1] = READ_STRING;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.VARCHAR2] = READ_STRING;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.CHAR] = READ_STRING;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.NCHAR] = READ_STRING;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.NVARCHAR] = READ_STRING;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.NSTRING] = READ_STRING;</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.SHORTTEXT] = READ_STRING;</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.ALPHANUM] = READ_STRING;</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.BINARY] = READ_BINARY;</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.VARBINARY] = READ_BINARY;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.BSTRING] = READ_BINARY;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.DATE] = READ_DATE;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.TIME] = READ_TIME;</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.TIMESTAMP] = READ_TIMESTAMP;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.DAYDATE] = READ_DAYDATE;</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.SECONDTIME] = READ_SECONDTIME;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.LONGDATE] = READ_LONGDATE;</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.SECONDDATE] = READ_SECONDDATE;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.BLOB] = READ_BLOB;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.LOCATOR] = READ_BLOB;</td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.CLOB] = READ_CLOB;</td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.NCLOB] = READ_NCLOB;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.NLOCATOR] = READ_NCLOB;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.TEXT] = READ_NCLOB;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.DOUBLE] = READ_DOUBLE;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.REAL] = READ_FLOAT;</td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">ReadFunction[TypeCode.DECIMAL] = READ_DECIMAL;</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/ResultSetAttributes.js">protocol/common/ResultSetAttributes.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  LAST: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  NEXT: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  FIRST: 4,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  ROW_NOT_FOUND: 8,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  CLOSED: 16</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/SegmentKind.js">protocol/common/SegmentKind.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  INVALID: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  REQUEST: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  REPLY: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  ERROR: 5</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/SessionContext.js">protocol/common/SessionContext.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  PRIMARY_CONNECTION_ID: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  PRIMARY_HOST: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  PRIMARY_PORT: 3,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  MASTER_CONNECTION_ID: 4,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  MASTER_HOST: 5,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  MASTER_PORT: 6</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/StatementContext.js">protocol/common/StatementContext.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  STATEMENT_SEQUENCE_INFO: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  SERVER_EXECUTION_TIME: 2</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/StatementContextType.js">protocol/common/StatementContextType.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">6</div><div class="hits">6</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var StatementContext = require('./StatementContext');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var TypeCode = require('./TypeCode');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var StatementContextType = module.exports = {};</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">StatementContextType[StatementContext.STATEMENT_SEQUENCE_INFO] = TypeCode.BSTRING;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">StatementContextType[StatementContext.SERVER_EXECUTION_TIME] = TypeCode.INT;</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/TopologyInformation.js">protocol/common/TopologyInformation.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  HOST_NAME: 1,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  HOST_PORT_NUMBER: 2,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  TENAT_NAME: 3,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  LOAD_FACTOR: 4,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  VOLUME_ID: 5,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  IS_MASTER: 6,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  IS_CURRENT_SESSION: 7,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  SERVICE_TYPE: 8,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  NETWORK_DOMAIN: 9,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  IS_STANDBY: 10,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  ALL_IP_ADRESSES: 11,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  ALL_HOST_NAMES: 12</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/TransactionFlag.js">protocol/common/TransactionFlag.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  ROLLED_BACK: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  COMMITTED: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  NEW_ISOLATION_LEVEL: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  DDL_COMMIT_MODE_CHANGED: 3,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  WRITE_TRANSACTION_STARTED: 4,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  NO_WRITE_TRANSACTION_STARTED: 5,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  SESSION_CLOSING_TRANSACTION_ERRROR: 6</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/TypeCode.js">protocol/common/TypeCode.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">2</div><div class="hits">2</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">module.exports = {</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source">  NULL: 0,</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source">  TINYINT: 1,</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source">  SMALLINT: 2,</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source">  INT: 3,</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  BIGINT: 4,</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source">  DECIMAL: 5,</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">  REAL: 6,</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  DOUBLE: 7,</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  CHAR: 8,</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  VARCHAR1: 9,</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  NCHAR: 10,</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  NVARCHAR: 11,</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  BINARY: 12,</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  VARBINARY: 13,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  DATE: 14,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  TIME: 15,</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  TIMESTAMP: 16,</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  TIME_TZ: 17,</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">  TIME_LTZ: 18,</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  TIMESTAMP_TZ: 19,</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  TIMESTAMP_LTZ: 20,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  INTERVAL_YM: 21,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  INTERVAL_DS: 22,</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  ROWID: 23,</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  UROWID: 24,</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  CLOB: 25,</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  NCLOB: 26,</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  BLOB: 27,</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  BOOLEAN: 28,</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  STRING: 29,</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  NSTRING: 30,</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  LOCATOR: 31,</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  NLOCATOR: 32,</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  BSTRING: 33,</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  DECIMAL_DIGIT_ARRAY: 34,</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  VARCHAR2: 35,</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  UNUSED1: 36,</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  UNUSED2: 37,</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  UNUSED3: 38,</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  UNUSED4: 39,</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  UNUSED5: 40,</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  UNUSED6: 41,</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  UNUSED7: 42,</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  UNUSED8: 43,</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  UNUSED9: 44,</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  TABLE: 45,</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  UNUSED11: 46,</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  UNUSED1F: 47,</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  ABAPSTREAM: 48,</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  ABAPSTRUCT: 49,</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  UNUSED12: 50,</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  TEXT: 51,</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  SHORTTEXT: 52,</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  UNUSED15: 53,</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  UNUSED16: 54,</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  ALPHANUM: 55,</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">  UNUSED18: 56,</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  UNUSED19: 57,</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  UNUSED20: 58,</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  UNUSED21: 59,</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">  UNUSED22: 60,</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  LONGDATE: 61,</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  SECONDDATE: 62,</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  DAYDATE: 63,</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">  SECONDTIME: 64,</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  CSDATE: 65,</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  CSTIME: 66,</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  BLOB_DISK: 71,</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">  CLOB_DISK: 72,</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  NCLOB_DISK: 73</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/common/index.js">protocol/common/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">44</div><div class="hits">44</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.ClientDistributionMode = require('./ClientDistributionMode');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.CommandOption = require('./CommandOption');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.CommitOption = require('./CommitOption');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.ConnectOption = require('./ConnectOption');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.ConnectOptionType = require('./ConnectOptionType');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.DataFormatVersion = require('./DataFormatVersion');</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.DistributionProtocolVersion = require('./DistributionProtocolVersion');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">exports.ErrorLevel = require('./ErrorLevel');</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">exports.FunctionCode = require('./FunctionCode');</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">exports.IoType = require('./IoType');</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">exports.LobOptions = require('./LobOptions');</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">exports.LobSourceType = require('./LobSourceType');</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">exports.MessageType = require('./MessageType');</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">exports.ParameterMode = require('./ParameterMode');</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">exports.PartKind = require('./PartKind');</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">exports.ResultSetAttributes = require('./ResultSetAttributes');</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">exports.SegmentKind = require('./SegmentKind');</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">exports.SessionContext = require('./SessionContext');</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">exports.StatementContext = require('./StatementContext');</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">exports.StatementContextType = require('./StatementContextType');</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">exports.TransactionFlag = require('./TransactionFlag');</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">exports.TopologyInformation = require('./TopologyInformation');</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">exports.TypeCode = require('./TypeCode');</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">exports.NormalizedTypeCode = require('./NormalizedTypeCode');</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">exports.ReadFunction = require('./ReadFunction');</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">invert('ConnectOption');</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">invert('TransactionFlag');</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">invert('TopologyInformation');</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">invert('MessageType');</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">invert('StatementContext');</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">invert('SessionContext');</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">invert('TypeCode');</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">invert('FunctionCode');</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">invert('PartKind');</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">invert('SegmentKind');</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">function invert(name) {</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  /*jshint forin: false */</td></tr><tr class="hit"><td class="line">57</td><td class="hits">10</td><td class="source">  var source = exports[name];</td></tr><tr class="hit"><td class="line">58</td><td class="hits">10</td><td class="source">  var target = {};</td></tr><tr class="hit"><td class="line">59</td><td class="hits">10</td><td class="source">  for (var key in source) {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">197</td><td class="source">    target[source[key]] = key;</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">62</td><td class="hits">10</td><td class="source">  exports[name + 'Name'] = target;</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">util.extend(exports, require('./Constants'));</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Binary.js">protocol/data/Binary.js</h2><div id="stats" class="high"><div class="percentage">94%</div><div class="sloc">17</div><div class="hits">16</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">22</td><td class="hits">17</td><td class="source">  return part.buffer;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function write(part, value) {</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">15</td><td class="source">  value = value || this;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">15</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">30</td><td class="hits">15</td><td class="source">  part.argumentCount = getArgumentCount(value);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">15</td><td class="source">  part.buffer = value;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">15</td><td class="source">  return part;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function getByteLength(value) {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">  return value.length;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">41</td><td class="hits">30</td><td class="source">  return 1;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Default.js">protocol/data/Default.js</h2><div id="stats" class="high"><div class="percentage">93%</div><div class="sloc">16</div><div class="hits">15</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">15</td><td class="source">  return part;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">function write(part, sourcePart) {</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">11</td><td class="source">  sourcePart = sourcePart || this;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">11</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">32</td><td class="hits">11</td><td class="source">  return util.extend(part, sourcePart);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function getByteLength(part) {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">  return part.length;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">function getArgumentCount(part) {</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">41</td><td class="hits">11</td><td class="source">  return part.argumentCount;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Fields.js">protocol/data/Fields.js</h2><div id="stats" class="high"><div class="percentage">89%</div><div class="sloc">68</div><div class="hits">61</div><div class="misses">7</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">21</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">21</td><td class="source">  var buffer = part.buffer;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">21</td><td class="source">  var fields = [];</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">21</td><td class="source">  var numberOfFields = buffer.readUInt16LE(offset);</td></tr><tr class="hit"><td class="line">29</td><td class="hits">21</td><td class="source">  offset += 2;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">21</td><td class="source">  var fieldLength;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">21</td><td class="source">  for (var i = 0; i &lt; numberOfFields; i++) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">50</td><td class="source">    fieldLength = buffer[offset];</td></tr><tr class="hit"><td class="line">33</td><td class="hits">50</td><td class="source">    offset += 1;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">50</td><td class="source">    if (fieldLength &gt; 245) {</td></tr><tr class="miss"><td class="line">35</td><td class="hits">0</td><td class="source">      fieldLength = buffer.readUInt16LE(offset);</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">      offset += 2;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">38</td><td class="hits">50</td><td class="source">    fields.push(buffer.slice(offset, offset + fieldLength));</td></tr><tr class="hit"><td class="line">39</td><td class="hits">50</td><td class="source">    offset += fieldLength;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">41</td><td class="hits">21</td><td class="source">  return fields;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">function write(part, fields) {</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">23</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">23</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">49</td><td class="hits">23</td><td class="source">  fields = fields || this;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">23</td><td class="source">  var byteLength = getByteLength(fields);</td></tr><tr class="hit"><td class="line">52</td><td class="hits">23</td><td class="source">  var buffer = new Buffer(byteLength);</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">23</td><td class="source">  buffer.writeUInt16LE(fields.length, 0);</td></tr><tr class="hit"><td class="line">55</td><td class="hits">23</td><td class="source">  offset += 2;</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">57</td><td class="hits">23</td><td class="source">  var field, fieldLength, data;</td></tr><tr class="hit"><td class="line">58</td><td class="hits">23</td><td class="source">  for (var i = 0; i &lt; fields.length; i++) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">56</td><td class="source">    field = fields[i];</td></tr><tr class="hit"><td class="line">60</td><td class="hits">56</td><td class="source">    if (Buffer.isBuffer(field)) {</td></tr><tr class="hit"><td class="line">61</td><td class="hits">24</td><td class="source">      data = field;</td></tr><tr class="hit"><td class="line">62</td><td class="hits">32</td><td class="source">    } else if (util.isArray(field)) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">      data = write({}, field).buffer;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">65</td><td class="hits">28</td><td class="source">      data = new Buffer(field, 'ascii');</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">67</td><td class="hits">56</td><td class="source">    fieldLength = data.length;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">56</td><td class="source">    if (fieldLength &lt;= 245) {</td></tr><tr class="hit"><td class="line">69</td><td class="hits">56</td><td class="source">      buffer[offset] = fieldLength;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">56</td><td class="source">      offset += 1;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"><td class="line">72</td><td class="hits">0</td><td class="source">      buffer[offset] = 0xf6;</td></tr><tr class="miss"><td class="line">73</td><td class="hits">0</td><td class="source">      offset += 1;</td></tr><tr class="miss"><td class="line">74</td><td class="hits">0</td><td class="source">      buffer.writeUInt16LE(fieldLength, offset);</td></tr><tr class="miss"><td class="line">75</td><td class="hits">0</td><td class="source">      offset += 2;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">77</td><td class="hits">56</td><td class="source">    data.copy(buffer, offset);</td></tr><tr class="hit"><td class="line">78</td><td class="hits">56</td><td class="source">    offset += fieldLength;</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">80</td><td class="hits">23</td><td class="source">  part.argumentCount = getArgumentCount(fields);</td></tr><tr class="hit"><td class="line">81</td><td class="hits">23</td><td class="source">  part.buffer = buffer;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">23</td><td class="source">  return part;</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">85</td><td class="hits">1</td><td class="source">function getByteLength(fields) {</td></tr><tr class="hit"><td class="line">86</td><td class="hits">27</td><td class="source">  var byteLength = 2;</td></tr><tr class="hit"><td class="line">87</td><td class="hits">27</td><td class="source">  var fieldLength;</td></tr><tr class="hit"><td class="line">88</td><td class="hits">27</td><td class="source">  for (var i = 0; i &lt; fields.length; i++) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">64</td><td class="source">    fieldLength = getByteLengthOfField(fields[i]);</td></tr><tr class="hit"><td class="line">90</td><td class="hits">64</td><td class="source">    if (fieldLength &lt;= 245) {</td></tr><tr class="hit"><td class="line">91</td><td class="hits">64</td><td class="source">      byteLength += fieldLength + 1;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="miss"><td class="line">93</td><td class="hits">0</td><td class="source">      byteLength += fieldLength + 3;</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">96</td><td class="hits">27</td><td class="source">  return byteLength;</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">99</td><td class="hits">1</td><td class="source">function getArgumentCount(fields) {</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">101</td><td class="hits">32</td><td class="source">  return 1;</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">104</td><td class="hits">1</td><td class="source">function getByteLengthOfField(field) {</td></tr><tr class="hit"><td class="line">105</td><td class="hits">64</td><td class="source">  if (Buffer.isBuffer(field)) {</td></tr><tr class="hit"><td class="line">106</td><td class="hits">32</td><td class="source">    return field.length;</td></tr><tr class="hit"><td class="line">107</td><td class="hits">32</td><td class="source">  } else if (util.isArray(field)) {</td></tr><tr class="hit"><td class="line">108</td><td class="hits">4</td><td class="source">    return getByteLength(field);</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">110</td><td class="hits">28</td><td class="source">  return Buffer.byteLength(field, 'ascii');</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Int32.js">protocol/data/Int32.js</h2><div id="stats" class="high"><div class="percentage">96%</div><div class="sloc">25</div><div class="hits">24</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">22</td><td class="hits">4</td><td class="source">  if (part.argumentCount === 1) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">3</td><td class="source">    return part.buffer.readInt32LE(0);</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">  var buffer = part.buffer;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">  var args = [];</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  for (var i = 0; i &lt; part.argumentCount; i++) {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">3</td><td class="source">    args.push(buffer.readInt32LE(offset));</td></tr><tr class="hit"><td class="line">30</td><td class="hits">3</td><td class="source">    offset += 4;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">  return args;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function write(part, value) {</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">4</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">39</td><td class="hits">4</td><td class="source">  part.argumentCount = getArgumentCount(value);</td></tr><tr class="hit"><td class="line">40</td><td class="hits">4</td><td class="source">  part.buffer = new Buffer(4);</td></tr><tr class="hit"><td class="line">41</td><td class="hits">4</td><td class="source">  part.buffer.writeInt32LE(value, 0);</td></tr><tr class="hit"><td class="line">42</td><td class="hits">4</td><td class="source">  return part;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">function getByteLength(value) {</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">47</td><td class="hits">0</td><td class="source">  return 4;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">52</td><td class="hits">8</td><td class="source">  return 1;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/MultilineOptions.js">protocol/data/MultilineOptions.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">44</div><div class="hits">44</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var opts = require('./Options');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var getByteLengthOfOptions = opts.getByteLength;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var writeOptions = opts.write;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var readOptions = opts._read;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  var buffer = part.buffer;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">  var lines = [];</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  var numberOfOptions, options;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">  for (var i = 0; i &lt; part.argumentCount; i++) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">2</td><td class="source">    numberOfOptions = buffer.readInt16LE(offset);</td></tr><tr class="hit"><td class="line">33</td><td class="hits">2</td><td class="source">    offset += 2;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">2</td><td class="source">    options = new Array(numberOfOptions);</td></tr><tr class="hit"><td class="line">35</td><td class="hits">2</td><td class="source">    offset = readOptions.call(options, buffer, offset);</td></tr><tr class="hit"><td class="line">36</td><td class="hits">2</td><td class="source">    lines.push(options);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">  return lines;</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">function write(part, lines) {</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  lines = lines || this;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">  var byteLength = getByteLength(lines);</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">  var buffer = new Buffer(byteLength);</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">  var options;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">  for (var i = 0; i &lt; lines.length; i++) {</td></tr><tr class="hit"><td class="line">51</td><td class="hits">2</td><td class="source">    options = writeOptions({}, lines[i]);</td></tr><tr class="hit"><td class="line">52</td><td class="hits">2</td><td class="source">    buffer.writeInt16LE(options.argumentCount, offset);</td></tr><tr class="hit"><td class="line">53</td><td class="hits">2</td><td class="source">    offset += 2;</td></tr><tr class="hit"><td class="line">54</td><td class="hits">2</td><td class="source">    options.buffer.copy(buffer, offset);</td></tr><tr class="hit"><td class="line">55</td><td class="hits">2</td><td class="source">    offset += options.buffer.length;</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">  part.argumentCount = getArgumentCount(lines);</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">  part.buffer = buffer;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">  return part;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">function getByteLength(lines) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">  var byteLength = 0;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">  for (var i = 0; i &lt; lines.length; i++) {</td></tr><tr class="hit"><td class="line">66</td><td class="hits">2</td><td class="source">    byteLength += 2 + getByteLengthOfOptions(lines[i]);</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">  return byteLength;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">function getArgumentCount(lines) {</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">  return lines.length;</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Options.js">protocol/data/Options.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">120</div><div class="hits">115</div><div class="misses">5</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var bignum = util.bignum;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.toObject = toObject;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports._read = _read;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">function read(part, properties) {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">7</td><td class="source">  var options = new Array(part.argumentCount);</td></tr><tr class="hit"><td class="line">30</td><td class="hits">7</td><td class="source">  _read.call(options, part.buffer, 0);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">7</td><td class="source">  if (util.isObject(properties)) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">5</td><td class="source">    return toObject(options, properties);</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">34</td><td class="hits">2</td><td class="source">  return options;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">function toObject(options, properties) {</td></tr><tr class="hit"><td class="line">38</td><td class="hits">5</td><td class="source">  var obj = {};</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">5</td><td class="source">  function setOption(option) {</td></tr><tr class="hit"><td class="line">41</td><td class="hits">5</td><td class="source">    var name = option.name;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">5</td><td class="source">    if (properties.hasOwnProperty(name)) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">5</td><td class="source">      var propertyName = util._2cc(properties[name]);</td></tr><tr class="hit"><td class="line">44</td><td class="hits">5</td><td class="source">      obj[propertyName] = option.value;</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">47</td><td class="hits">5</td><td class="source">  options.forEach(setOption);</td></tr><tr class="hit"><td class="line">48</td><td class="hits">5</td><td class="source">  return obj;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">function _read(buffer, offset) {</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">9</td><td class="source">  offset = offset || 0;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">9</td><td class="source">  var options = this;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">9</td><td class="source">  var option, length;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">9</td><td class="source">  for (var i = 0; i &lt; options.length; i++) {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">38</td><td class="source">    option = {</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">      name: buffer[offset],</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">      type: buffer[offset + 1],</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">      value: undefined</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    };</td></tr><tr class="hit"><td class="line">63</td><td class="hits">38</td><td class="source">    offset += 2;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">38</td><td class="source">    switch (option.type) {</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">    case TypeCode.BOOLEAN:</td></tr><tr class="hit"><td class="line">66</td><td class="hits">11</td><td class="source">      option.value = buffer[offset] ? true : false;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">11</td><td class="source">      offset += 1;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">11</td><td class="source">      break;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">    case TypeCode.INT:</td></tr><tr class="hit"><td class="line">70</td><td class="hits">12</td><td class="source">      option.value = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">71</td><td class="hits">12</td><td class="source">      offset += 4;</td></tr><tr class="hit"><td class="line">72</td><td class="hits">12</td><td class="source">      break;</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    case TypeCode.BIGINT:</td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">      option.value = bignum.readInt64LE(buffer, offset);</td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">      offset += 8;</td></tr><tr class="hit"><td class="line">76</td><td class="hits">1</td><td class="source">      break;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">    case TypeCode.DOUBLE:</td></tr><tr class="hit"><td class="line">78</td><td class="hits">2</td><td class="source">      option.value = buffer.readDoubleLE(offset);</td></tr><tr class="hit"><td class="line">79</td><td class="hits">2</td><td class="source">      offset += 8;</td></tr><tr class="hit"><td class="line">80</td><td class="hits">2</td><td class="source">      break;</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source">    case TypeCode.STRING:</td></tr><tr class="hit"><td class="line">82</td><td class="hits">11</td><td class="source">      length = buffer.readInt16LE(offset);</td></tr><tr class="hit"><td class="line">83</td><td class="hits">11</td><td class="source">      offset += 2;</td></tr><tr class="hit"><td class="line">84</td><td class="hits">11</td><td class="source">      option.value = buffer.toString('utf-8', offset, offset + length);</td></tr><tr class="hit"><td class="line">85</td><td class="hits">11</td><td class="source">      offset += length;</td></tr><tr class="hit"><td class="line">86</td><td class="hits">11</td><td class="source">      break;</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    case TypeCode.BSTRING:</td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">      length = buffer.readInt16LE(offset);</td></tr><tr class="hit"><td class="line">89</td><td class="hits">1</td><td class="source">      offset += 2;</td></tr><tr class="hit"><td class="line">90</td><td class="hits">1</td><td class="source">      option.value = new Buffer(length);</td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">      buffer.copy(option.value, 0, offset, offset + length);</td></tr><tr class="hit"><td class="line">92</td><td class="hits">1</td><td class="source">      offset += length;</td></tr><tr class="hit"><td class="line">93</td><td class="hits">1</td><td class="source">      break;</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">95</td><td class="hits">38</td><td class="source">    options[i] = option;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">97</td><td class="hits">9</td><td class="source">  return offset;</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">100</td><td class="hits">1</td><td class="source">function write(part, options) {</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">103</td><td class="hits">10</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">104</td><td class="hits">10</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">105</td><td class="hits">10</td><td class="source">  options = options || this;</td></tr><tr class="hit"><td class="line">106</td><td class="hits">10</td><td class="source">  var byteLength = getByteLength(options);</td></tr><tr class="hit"><td class="line">107</td><td class="hits">10</td><td class="source">  var buffer = new Buffer(byteLength);</td></tr><tr class="hit"><td class="line">108</td><td class="hits">10</td><td class="source">  var option;</td></tr><tr class="hit"><td class="line">109</td><td class="hits">10</td><td class="source">  for (var i = 0; i &lt; options.length; i++) {</td></tr><tr class="hit"><td class="line">110</td><td class="hits">66</td><td class="source">    option = options[i];</td></tr><tr class="hit"><td class="line">111</td><td class="hits">66</td><td class="source">    buffer[offset] = option.name;</td></tr><tr class="hit"><td class="line">112</td><td class="hits">66</td><td class="source">    buffer[offset + 1] = option.type;</td></tr><tr class="hit"><td class="line">113</td><td class="hits">66</td><td class="source">    offset += 2;</td></tr><tr class="hit"><td class="line">114</td><td class="hits">66</td><td class="source">    switch (option.type) {</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">    case TypeCode.BOOLEAN:</td></tr><tr class="hit"><td class="line">116</td><td class="hits">24</td><td class="source">      buffer[offset] = !!option.value ? 1 : 0;</td></tr><tr class="hit"><td class="line">117</td><td class="hits">24</td><td class="source">      offset += 1;</td></tr><tr class="hit"><td class="line">118</td><td class="hits">24</td><td class="source">      break;</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">    case TypeCode.INT:</td></tr><tr class="hit"><td class="line">120</td><td class="hits">24</td><td class="source">      buffer.writeInt32LE(option.value, offset);</td></tr><tr class="hit"><td class="line">121</td><td class="hits">24</td><td class="source">      offset += 4;</td></tr><tr class="hit"><td class="line">122</td><td class="hits">24</td><td class="source">      break;</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">    case TypeCode.BIGINT:</td></tr><tr class="miss"><td class="line">124</td><td class="hits">0</td><td class="source">      buffer.writeInt64LE(option.value, offset);</td></tr><tr class="miss"><td class="line">125</td><td class="hits">0</td><td class="source">      offset += 8;</td></tr><tr class="miss"><td class="line">126</td><td class="hits">0</td><td class="source">      break;</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">    case TypeCode.DOUBLE:</td></tr><tr class="hit"><td class="line">128</td><td class="hits">2</td><td class="source">      buffer.writeDoubleLE(option.value, offset);</td></tr><tr class="hit"><td class="line">129</td><td class="hits">2</td><td class="source">      offset += 8;</td></tr><tr class="hit"><td class="line">130</td><td class="hits">2</td><td class="source">      break;</td></tr><tr><td class="line">131</td><td class="hits"></td><td class="source">    case TypeCode.STRING:</td></tr><tr class="hit"><td class="line">132</td><td class="hits">15</td><td class="source">      byteLength = Buffer.byteLength(option.value, 'utf-8');</td></tr><tr class="hit"><td class="line">133</td><td class="hits">15</td><td class="source">      buffer.writeInt16LE(byteLength, offset);</td></tr><tr class="hit"><td class="line">134</td><td class="hits">15</td><td class="source">      offset += 2;</td></tr><tr class="hit"><td class="line">135</td><td class="hits">15</td><td class="source">      buffer.write(option.value, offset, byteLength, 'utf-8');</td></tr><tr class="hit"><td class="line">136</td><td class="hits">15</td><td class="source">      offset += byteLength;</td></tr><tr class="hit"><td class="line">137</td><td class="hits">15</td><td class="source">      break;</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">    case TypeCode.BSTRING:</td></tr><tr class="hit"><td class="line">139</td><td class="hits">1</td><td class="source">      byteLength = option.value.length;</td></tr><tr class="hit"><td class="line">140</td><td class="hits">1</td><td class="source">      buffer.writeInt16LE(byteLength, offset);</td></tr><tr class="hit"><td class="line">141</td><td class="hits">1</td><td class="source">      offset += 2;</td></tr><tr class="hit"><td class="line">142</td><td class="hits">1</td><td class="source">      option.value.copy(buffer, offset);</td></tr><tr class="hit"><td class="line">143</td><td class="hits">1</td><td class="source">      offset += byteLength;</td></tr><tr class="hit"><td class="line">144</td><td class="hits">1</td><td class="source">      break;</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">147</td><td class="hits">10</td><td class="source">  part.argumentCount = options.length;</td></tr><tr class="hit"><td class="line">148</td><td class="hits">10</td><td class="source">  part.buffer = buffer;</td></tr><tr class="hit"><td class="line">149</td><td class="hits">10</td><td class="source">  return part;</td></tr><tr><td class="line">150</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">152</td><td class="hits">1</td><td class="source">function getByteLength(options) {</td></tr><tr class="hit"><td class="line">153</td><td class="hits">12</td><td class="source">  var byteLength = 0;</td></tr><tr class="hit"><td class="line">154</td><td class="hits">12</td><td class="source">  var option;</td></tr><tr class="hit"><td class="line">155</td><td class="hits">12</td><td class="source">  for (var i = 0; i &lt; options.length; i++) {</td></tr><tr class="hit"><td class="line">156</td><td class="hits">87</td><td class="source">    option = options[i];</td></tr><tr class="hit"><td class="line">157</td><td class="hits">87</td><td class="source">    switch (option.type) {</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source">    case TypeCode.BOOLEAN:</td></tr><tr class="hit"><td class="line">159</td><td class="hits">27</td><td class="source">      byteLength += 3;</td></tr><tr class="hit"><td class="line">160</td><td class="hits">27</td><td class="source">      break;</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">    case TypeCode.INT:</td></tr><tr class="hit"><td class="line">162</td><td class="hits">30</td><td class="source">      byteLength += 6;</td></tr><tr class="hit"><td class="line">163</td><td class="hits">30</td><td class="source">      break;</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">    case TypeCode.BIGINT:</td></tr><tr class="miss"><td class="line">165</td><td class="hits">0</td><td class="source">      byteLength += 10;</td></tr><tr class="miss"><td class="line">166</td><td class="hits">0</td><td class="source">      break;</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source">    case TypeCode.DOUBLE:</td></tr><tr class="hit"><td class="line">168</td><td class="hits">4</td><td class="source">      byteLength += 10;</td></tr><tr class="hit"><td class="line">169</td><td class="hits">4</td><td class="source">      break;</td></tr><tr><td class="line">170</td><td class="hits"></td><td class="source">    case TypeCode.STRING:</td></tr><tr class="hit"><td class="line">171</td><td class="hits">25</td><td class="source">      byteLength += 4 + Buffer.byteLength(option.value, 'utf-8');</td></tr><tr class="hit"><td class="line">172</td><td class="hits">25</td><td class="source">      break;</td></tr><tr><td class="line">173</td><td class="hits"></td><td class="source">    case TypeCode.BSTRING:</td></tr><tr class="hit"><td class="line">174</td><td class="hits">1</td><td class="source">      byteLength += 4 + option.value.length;</td></tr><tr class="hit"><td class="line">175</td><td class="hits">1</td><td class="source">      break;</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">178</td><td class="hits">12</td><td class="source">  return byteLength;</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">181</td><td class="hits">1</td><td class="source">function getArgumentCount(options) {</td></tr><tr class="hit"><td class="line">182</td><td class="hits">7</td><td class="source">  return options.length;</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/ParameterMetadata.js">protocol/data/ParameterMetadata.js</h2><div id="stats" class="high"><div class="percentage">89%</div><div class="sloc">38</div><div class="hits">34</div><div class="misses">4</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var ParameterMode = common.ParameterMode;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">7</td><td class="source">  var params = new Array(part.argumentCount);</td></tr><tr class="hit"><td class="line">24</td><td class="hits">7</td><td class="source">  _read.call(params, part.buffer, 0);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">7</td><td class="source">  return params;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">function _read(buffer, offset) {</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">7</td><td class="source">  offset = offset || 0;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">7</td><td class="source">  var params = this;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">7</td><td class="source">  var textOffset = offset + params.length * 16;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">7</td><td class="source">  for (var i = 0; i &lt; params.length; i++) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">15</td><td class="source">    params[i] = new Parameter(buffer, offset, textOffset);</td></tr><tr class="hit"><td class="line">36</td><td class="hits">15</td><td class="source">    offset += 16;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">38</td><td class="hits">7</td><td class="source">  return offset;</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">function getArgumentCount(params) {</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">43</td><td class="hits">0</td><td class="source">  return params.length;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">function Parameter(buffer, offset, textOffset) {</td></tr><tr class="hit"><td class="line">47</td><td class="hits">15</td><td class="source">  this.mode = buffer[offset];</td></tr><tr class="hit"><td class="line">48</td><td class="hits">15</td><td class="source">  this.dataType = buffer[offset + 1];</td></tr><tr class="hit"><td class="line">49</td><td class="hits">15</td><td class="source">  this.ioType = buffer[offset + 2];</td></tr><tr class="hit"><td class="line">50</td><td class="hits">15</td><td class="source">  var nameOffset = buffer.readInt32LE(offset + 4);</td></tr><tr class="hit"><td class="line">51</td><td class="hits">15</td><td class="source">  if (nameOffset &lt; 0) {</td></tr><tr class="hit"><td class="line">52</td><td class="hits">9</td><td class="source">    this.name = undefined;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">6</td><td class="source">    var start = textOffset + nameOffset;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">6</td><td class="source">    var length = buffer[start];</td></tr><tr class="hit"><td class="line">56</td><td class="hits">6</td><td class="source">    start += 1;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">6</td><td class="source">    this.name = buffer.toString('utf-8', start, start + length);</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">59</td><td class="hits">15</td><td class="source">  this.length = buffer.readInt16LE(offset + 8);</td></tr><tr class="hit"><td class="line">60</td><td class="hits">15</td><td class="source">  this.fraction = buffer.readInt16LE(offset + 10);</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">Parameter.prototype.isReadOnly = function isReadOnly() {</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">65</td><td class="hits">0</td><td class="source">  return this.mode &amp; ParameterMode.READONLY ? true : false;</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">Parameter.prototype.isMandatory = function isMandatory() {</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">70</td><td class="hits">0</td><td class="source">  return this.mode &amp; ParameterMode.MANDATORY ? true : false;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">Parameter.prototype.isAutoIncrement = function isAutoIncrement() {</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">75</td><td class="hits">0</td><td class="source">  return this.mode &amp; ParameterMode.AUTO_INCREMENT ? true : false;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Parameters.js">protocol/data/Parameters.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">28</div><div class="hits">28</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">function write(part, value) {</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">10</td><td class="source">  value = value || this;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">10</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">25</td><td class="hits">10</td><td class="source">  if (Array.isArray(value)) {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">9</td><td class="source">    part.argumentCount = value.length;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">9</td><td class="source">    part.buffer = Buffer.concat(value);</td></tr><tr class="hit"><td class="line">28</td><td class="hits">9</td><td class="source">    return part;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  if (Buffer.isBuffer(value)) {</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">    part.argumentCount = 1;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">    part.buffer = value;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">    return part;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">function getByteLength(value) {</td></tr><tr class="hit"><td class="line">38</td><td class="hits">2</td><td class="source">  if (Array.isArray(value)) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">    var byteLength = 0;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">    for (var i = 0; i &lt; value.length; i++) {</td></tr><tr class="hit"><td class="line">41</td><td class="hits">2</td><td class="source">      byteLength += value[i].length;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">    return byteLength;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  if (Buffer.isBuffer(value)) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">    return value.length;</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">52</td><td class="hits">10</td><td class="source">  if (Array.isArray(value)) {</td></tr><tr class="hit"><td class="line">53</td><td class="hits">9</td><td class="source">    return value.length;</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">  if (Buffer.isBuffer(value)) {</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">    return 1;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/ReadLobReply.js">protocol/data/ReadLobReply.js</h2><div id="stats" class="high"><div class="percentage">86%</div><div class="sloc">30</div><div class="hits">26</div><div class="misses">4</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var LobOptions = common.LobOptions;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">11</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">11</td><td class="source">  var buffer = part.buffer;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">11</td><td class="source">  var locatorId = buffer.slice(offset, offset + 8);</td></tr><tr class="hit"><td class="line">28</td><td class="hits">11</td><td class="source">  offset += 8;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">11</td><td class="source">  var options = buffer[offset];</td></tr><tr class="hit"><td class="line">30</td><td class="hits">11</td><td class="source">  offset += 1;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">11</td><td class="source">  var length = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">11</td><td class="source">  offset = 16;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">11</td><td class="source">  var chunk = buffer.slice(offset, offset + length);</td></tr><tr class="hit"><td class="line">34</td><td class="hits">11</td><td class="source">  offset += length;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">11</td><td class="source">  return new ReadLobReply(locatorId, options, chunk);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">function getByteLength(chunk) {</td></tr><tr class="miss"><td class="line">39</td><td class="hits">0</td><td class="source">  return 16 + chunk.length;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">44</td><td class="hits">0</td><td class="source">  return 1;</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">function ReadLobReply(locatorId, options, chunk) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">11</td><td class="source">  this.locatorId = locatorId;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">11</td><td class="source">  this.options = options;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">11</td><td class="source">  this.chunk = chunk;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">Object.defineProperties(ReadLobReply.prototype, {</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  isNull: {</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    get: function isNull() {</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">      /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">57</td><td class="hits">0</td><td class="source">      return !!(this.options &amp; LobOptions.NULL_INDICATOR);</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">  isDataIncluded: {</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">    get: function isDataIncluded() {</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">      /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">63</td><td class="hits">0</td><td class="source">      return !!(this.options &amp; LobOptions.DATA_INCLUDED);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  },</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  isLast: {</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">    get: function isLast() {</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">      /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">69</td><td class="hits">10</td><td class="source">      return !!(this.options &amp; LobOptions.LAST_DATA);</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">});</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/ReadLobRequest.js">protocol/data/ReadLobRequest.js</h2><div id="stats" class="high"><div class="percentage">97%</div><div class="sloc">34</div><div class="hits">33</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var bignum = util.bignum;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var READ_LOB_REQUEST_LENGTH = 24;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">function write(part, req) {</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">11</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">11</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">31</td><td class="hits">11</td><td class="source">  req = req || this;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">33</td><td class="hits">11</td><td class="source">  var buffer = new Buffer(READ_LOB_REQUEST_LENGTH);</td></tr><tr class="hit"><td class="line">34</td><td class="hits">11</td><td class="source">  if (Buffer.isBuffer(req.locatorId)) {</td></tr><tr class="hit"><td class="line">35</td><td class="hits">10</td><td class="source">    req.locatorId.copy(buffer, offset, 0, 8);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">    bignum.writeInt64LE(buffer, req.locatorId, offset);</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">39</td><td class="hits">11</td><td class="source">  offset += 8;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">11</td><td class="source">  bignum.writeInt64LE(buffer, req.offset, offset);</td></tr><tr class="hit"><td class="line">41</td><td class="hits">11</td><td class="source">  offset += 8;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">11</td><td class="source">  buffer.writeInt32LE(req.length, offset);</td></tr><tr class="hit"><td class="line">43</td><td class="hits">11</td><td class="source">  offset += 4;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">11</td><td class="source">  buffer.fill(0x00, offset);</td></tr><tr class="hit"><td class="line">45</td><td class="hits">11</td><td class="source">  part.argumentCount = getArgumentCount(req);</td></tr><tr class="hit"><td class="line">46</td><td class="hits">11</td><td class="source">  part.buffer = buffer;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">11</td><td class="source">  return part;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">51</td><td class="hits">10</td><td class="source">  var buffer = part.buffer;</td></tr><tr class="hit"><td class="line">52</td><td class="hits">10</td><td class="source">  var locatorId = new Buffer(8);</td></tr><tr class="hit"><td class="line">53</td><td class="hits">10</td><td class="source">  buffer.copy(locatorId, 0);</td></tr><tr class="hit"><td class="line">54</td><td class="hits">10</td><td class="source">  return {</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">    locatorId: locatorId,</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">    offset: bignum.readInt64LE(buffer, 8),</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">    length: buffer.readInt32LE(16)</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">function getByteLength(req) {</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">63</td><td class="hits">0</td><td class="source">  return 24;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">function getArgumentCount(req) {</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">68</td><td class="hits">21</td><td class="source">  return 1;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/ResultSetMetadata.js">protocol/data/ResultSetMetadata.js</h2><div id="stats" class="high"><div class="percentage">91%</div><div class="sloc">48</div><div class="hits">44</div><div class="misses">4</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var ParameterMode = common.ParameterMode;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var READONLY = ParameterMode.READONLY;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var AUTO_INCREMENT = ParameterMode.AUTO_INCREMENT;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var MANDATORY = ParameterMode.MANDATORY;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">11</td><td class="source">  var columns = new Array(part.argumentCount);</td></tr><tr class="hit"><td class="line">27</td><td class="hits">11</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">11</td><td class="source">  var textOffset = columns.length * 24;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">11</td><td class="source">  for (var i = 0; i &lt; columns.length; i++) {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">21</td><td class="source">    columns[i] = readColumn(part.buffer, offset, textOffset);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">21</td><td class="source">    offset += 24;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">33</td><td class="hits">11</td><td class="source">  return columns;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">function getArgumentCount(columns) {</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">38</td><td class="hits">0</td><td class="source">  return columns.length;</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">var COLUMN_NAME_PROPERTIES = [</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  'tableName', 'schemaName', 'columnName', 'columnDisplayName'</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">];</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">function readColumn(buffer, offset, textOffset) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">21</td><td class="source">  var column = new Column(</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">    buffer.readInt8(offset),</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    buffer.readInt8(offset + 1),</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    buffer.readInt16LE(offset + 2),</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    buffer.readInt16LE(offset + 4)</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  );</td></tr><tr class="hit"><td class="line">52</td><td class="hits">21</td><td class="source">  offset += 8;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">21</td><td class="source">  function readName(name) {</td></tr><tr class="hit"><td class="line">55</td><td class="hits">84</td><td class="source">    var start = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">56</td><td class="hits">84</td><td class="source">    offset += 4;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">84</td><td class="source">    if (start &lt; 0) {</td></tr><tr class="hit"><td class="line">58</td><td class="hits">23</td><td class="source">      column[name] = undefined;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">60</td><td class="hits">61</td><td class="source">      start += textOffset;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">61</td><td class="source">      var length = buffer.readUInt8(start);</td></tr><tr class="hit"><td class="line">62</td><td class="hits">61</td><td class="source">      start += 1;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">61</td><td class="source">      column[name] = buffer.toString('utf-8', start, start + length);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">66</td><td class="hits">21</td><td class="source">  COLUMN_NAME_PROPERTIES.forEach(readName);</td></tr><tr class="hit"><td class="line">67</td><td class="hits">21</td><td class="source">  return column;</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">function Column(mode, dataType, fraction, length) {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">21</td><td class="source">  this.mode = mode;</td></tr><tr class="hit"><td class="line">72</td><td class="hits">21</td><td class="source">  this.dataType = dataType;</td></tr><tr class="hit"><td class="line">73</td><td class="hits">21</td><td class="source">  this.fraction = fraction;</td></tr><tr class="hit"><td class="line">74</td><td class="hits">21</td><td class="source">  this.length = length;</td></tr><tr class="hit"><td class="line">75</td><td class="hits">21</td><td class="source">  this.tableName = undefined;</td></tr><tr class="hit"><td class="line">76</td><td class="hits">21</td><td class="source">  this.schemaName = undefined;</td></tr><tr class="hit"><td class="line">77</td><td class="hits">21</td><td class="source">  this.columnName = undefined;</td></tr><tr class="hit"><td class="line">78</td><td class="hits">21</td><td class="source">  this.columnDisplayName = undefined;</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">81</td><td class="hits">1</td><td class="source">Column.prototype.isReadOnly = function isReadOnly() {</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">83</td><td class="hits">0</td><td class="source">  return this.mode &amp; READONLY ? true : false;</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">1</td><td class="source">Column.prototype.isMandatory = function isMandatory() {</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">88</td><td class="hits">0</td><td class="source">  return this.mode &amp; MANDATORY ? true : false;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">91</td><td class="hits">1</td><td class="source">Column.prototype.isAutoIncrement = function isAutoIncrement() {</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="miss"><td class="line">93</td><td class="hits">0</td><td class="source">  return this.mode &amp; AUTO_INCREMENT ? true : false;</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/SqlError.js">protocol/data/SqlError.js</h2><div id="stats" class="high"><div class="percentage">92%</div><div class="sloc">39</div><div class="hits">36</div><div class="misses">3</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var ErrorLevel = require('../common/ErrorLevel');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">  var err = new SqlError();</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">  _read.call(err, part.buffer, 0);</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">  return err;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">function _read(buffer, offset) {</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">  offset = offset || 0;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">  this.code = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">  offset += 4;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">  this.position = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">  offset += 4;</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">  var length = buffer.readInt32LE(offset);</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">  offset += 4;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">  this.level = buffer.readInt8(offset);</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">  if (this.level === ErrorLevel.FATAL) {</td></tr><tr class="miss"><td class="line">41</td><td class="hits">0</td><td class="source">    this.fatal = true;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">  offset += 1;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">  this.sqlState = buffer.toString('ascii', offset, offset + 5);</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  offset += 5;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">  this.message = buffer.toString('utf-8', offset, offset + length);</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">  offset += util.alignLength(length, 8);</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">  return offset;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">function getByteLength(err) {</td></tr><tr class="miss"><td class="line">52</td><td class="hits">0</td><td class="source">  return 18 + Buffer.byteLength(err.message);</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">function getArgumentCount(err) {</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="miss"><td class="line">57</td><td class="hits">0</td><td class="source">  return 1;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">util.inherits(SqlError, Error);</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">function SqlError() {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">  Error.call(this);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">  this.message = undefined;</td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">  this.code = undefined;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">  this.sqlState = undefined;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">  this.level = undefined;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">  this.position = undefined;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Text.js">protocol/data/Text.js</h2><div id="stats" class="high"><div class="percentage">94%</div><div class="sloc">17</div><div class="hits">16</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">22</td><td class="hits">13</td><td class="source">  return part.buffer.toString('utf-8');</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function write(part, value) {</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">13</td><td class="source">  value = value || this;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">13</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">30</td><td class="hits">13</td><td class="source">  part.argumentCount = getArgumentCount(value);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">13</td><td class="source">  part.buffer = new Buffer(value, 'utf-8');</td></tr><tr class="hit"><td class="line">32</td><td class="hits">13</td><td class="source">  return part;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function getByteLength(value) {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">  return Buffer.byteLength(value);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">41</td><td class="hits">26</td><td class="source">  return 1;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/Text20.js">protocol/data/Text20.js</h2><div id="stats" class="high"><div class="percentage">88%</div><div class="sloc">17</div><div class="hits">15</div><div class="misses">2</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.write = write;</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.getByteLength = getByteLength;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="miss"><td class="line">22</td><td class="hits">0</td><td class="source">  return part.buffer.slice(1).toString('utf-8');</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function write(part, value) {</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">4</td><td class="source">  value = value || this;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">4</td><td class="source">  part = part || {};</td></tr><tr class="hit"><td class="line">30</td><td class="hits">4</td><td class="source">  part.argumentCount = getArgumentCount(value);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">4</td><td class="source">  part.buffer = new Buffer(' ' + value, 'utf-8');</td></tr><tr class="hit"><td class="line">32</td><td class="hits">4</td><td class="source">  return part;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">function getByteLength(value) {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">  return Buffer.byteLength(value) + 1;</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">function getArgumentCount(value) {</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  /* jshint unused:false */</td></tr><tr class="hit"><td class="line">41</td><td class="hits">8</td><td class="source">  return 1;</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/TransactionFlags.js">protocol/data/TransactionFlags.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">8</div><div class="hits">8</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Options = require('./Options');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.getByteLength = Options.getByteLength;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.getArgumentCount = Options.getArgumentCount;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">5</td><td class="source">  return Options.read(part, common.TransactionFlagName);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/WriteLobReply.js">protocol/data/WriteLobReply.js</h2><div id="stats" class="high"><div class="percentage">92%</div><div class="sloc">13</div><div class="hits">12</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.read = read;</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.getArgumentCount = getArgumentCount;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">function read(part) {</td></tr><tr class="hit"><td class="line">20</td><td class="hits">14</td><td class="source">  var offset = 0;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">14</td><td class="source">  var buffer = part.buffer;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">14</td><td class="source">  var args = [];</td></tr><tr class="hit"><td class="line">23</td><td class="hits">14</td><td class="source">  for (var i = 0; i &lt; part.argumentCount; i++) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">11</td><td class="source">    args.push(buffer.slice(offset, offset + 8));</td></tr><tr class="hit"><td class="line">25</td><td class="hits">11</td><td class="source">    offset += 8;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">27</td><td class="hits">14</td><td class="source">  return args;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">function getArgumentCount(args) {</td></tr><tr class="miss"><td class="line">31</td><td class="hits">0</td><td class="source">  return args.length;</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/data/index.js">protocol/data/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">51</div><div class="hits">51</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var PartKind = common.PartKind;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var Binary = require('./Binary');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var Default = require('./Default');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var Fields = require('./Fields');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var Int32 = require('./Int32');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var MultilineOptions = require('./MultilineOptions');</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var Options = require('./Options');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var ParameterMetadata = require('./ParameterMetadata');</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">var Parameters = require('./Parameters');</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">var ReadLobReply = require('./ReadLobReply');</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">var ReadLobRequest = require('./ReadLobRequest');</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">var ResultSetMetadata = require('./ResultSetMetadata');</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">var SqlError = require('./SqlError');</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">var Text = require('./Text');</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">var Text20 = require('./Text20');</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">var TransactionFlags = require('./TransactionFlags');</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">var WriteLobReply = require('./WriteLobReply');</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">var rw = module.exports = {};</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">rw[PartKind.AUTHENTICATION] = Fields;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">rw[PartKind.COMMAND] = Text;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">rw[PartKind.CLIENT_ID] = Text20;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">rw[PartKind.CONNECT_OPTIONS] = Options;</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">rw[PartKind.COMMIT_OPTIONS] = Options;</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">rw[PartKind.ERROR] = SqlError;</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">rw[PartKind.FETCH_OPTIONS] = Options;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">rw[PartKind.FETCH_SIZE] = Int32;</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">rw[PartKind.TRANSACTION_ID] = Binary;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">rw[PartKind.TOPOLOGY_INFORMATION] = MultilineOptions;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">rw[PartKind.PARAMETERS] = Parameters;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">rw[PartKind.PARAMETER_METADATA] = ParameterMetadata;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">rw[PartKind.RESULT_SET_ID] = Binary;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">rw[PartKind.RESULT_SET] = Default;</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">rw[PartKind.OUTPUT_PARAMETERS] = Default;</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">rw[PartKind.RESULT_SET_METADATA] = ResultSetMetadata;</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">rw[PartKind.ROWS_AFFECTED] = Int32;</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">rw[PartKind.READ_LOB_REQUEST] = ReadLobRequest;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">rw[PartKind.READ_LOB_REPLY] = ReadLobReply;</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">rw[PartKind.WRITE_LOB_REQUEST] = Default;</td></tr><tr class="hit"><td class="line">57</td><td class="hits">1</td><td class="source">rw[PartKind.WRITE_LOB_REPLY] = WriteLobReply;</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">rw[PartKind.SESSION_CONTEXT] = Options;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">rw[PartKind.STATEMENT_CONTEXT] = Options;</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">rw[PartKind.STATEMENT_ID] = Binary;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">rw[PartKind.PARTITION_INFORMATION] = Default;</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">rw[PartKind.TRANSACTION_FLAGS] = TransactionFlags;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">rw[PartKind.TABLE_NAME] = Text;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">1</td><td class="source">for (var name in PartKind) {</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  /*jshint forin: false */</td></tr><tr class="hit"><td class="line">67</td><td class="hits">33</td><td class="source">  var kind = PartKind[name];</td></tr><tr class="hit"><td class="line">68</td><td class="hits">33</td><td class="source">  if (!rw[kind]) {</td></tr><tr class="hit"><td class="line">69</td><td class="hits">6</td><td class="source">    rw[kind] = Default;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/index.js">protocol/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">18</div><div class="hits">18</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.Connection = require('./Connection');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.Parser = require('./Parser');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">exports.Result = require('./Result');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.ResultSet = require('./ResultSet');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">exports.Statement = require('./Statement');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">exports.Stringifier = require('./Stringifier');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">exports.Transaction = require('./Transaction');</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">exports.Reader = require('./Reader');</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.Writer = require('./Writer');</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">exports.ExecuteTask = require('./ExecuteTask');</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">exports.Lob = require('./Lob');</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">exports.auth = require('./auth');</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">exports.common = require('./common');</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">exports.data = require('./data');</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">exports.part = require('./part');</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">exports.reply = require('./reply');</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">exports.request = require('./request');</td></tr></tbody></table></div><div class="file"><h2 id="protocol/part/AbstractOptions.js">protocol/part/AbstractOptions.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">22</div><div class="hits">21</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">module.exports = AbstractOptions;</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">function AbstractOptions() {}</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">AbstractOptions.prototype.getOptions = function getOptions() {</td></tr><tr class="hit"><td class="line">23</td><td class="hits">5</td><td class="source">  var self = this;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">5</td><td class="source">  function getOption(name) {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">33</td><td class="source">    var propertyName = util._2cc(self.PROPERTY_NAMES[name]);</td></tr><tr class="hit"><td class="line">27</td><td class="hits">33</td><td class="source">    var value = self[propertyName];</td></tr><tr class="hit"><td class="line">28</td><td class="hits">33</td><td class="source">    var type = self.TYPES[name];</td></tr><tr class="hit"><td class="line">29</td><td class="hits">33</td><td class="source">    return {</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source">      name: name,</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">      value: value,</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">      type: type</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">35</td><td class="hits">5</td><td class="source">  return this.KEYS.map(getOption);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">AbstractOptions.prototype.setOptions = function setOptions(options) {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">  var self = this;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">  if (!util.isArray(options)) {</td></tr><tr class="miss"><td class="line">42</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  function setOption(option) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">2</td><td class="source">    var name = option.name;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">2</td><td class="source">    if (self.PROPERTY_NAMES.hasOwnProperty(name)) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">2</td><td class="source">      var propertyName = util._2cc(self.PROPERTY_NAMES[name]);</td></tr><tr class="hit"><td class="line">49</td><td class="hits">2</td><td class="source">      self[propertyName] = option.value;</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">  options.forEach(setOption);</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/part/ConnectOptions.js">protocol/part/ConnectOptions.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">29</div><div class="hits">29</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var AbstractOptions = require('./AbstractOptions');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var DataFormatVersion = common.DataFormatVersion;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var ClientDistributionMode = common.ClientDistributionMode;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var DistributionProtocolVersion = common.DistributionProtocolVersion;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">module.exports = ConnectOptions;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">util.inherits(ConnectOptions, AbstractOptions);</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">function ConnectOptions() {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">4</td><td class="source">  AbstractOptions.call(this);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  // This field contains the connection ID.</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  // It is filled by the server when the connection is established.</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  // This number can be used in DISCONNECT / KILL commands for command</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  // or session cancellation.</td></tr><tr class="hit"><td class="line">35</td><td class="hits">4</td><td class="source">  this.connectionId = undefined;</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  // This field is set if array commands continue to process</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  // remaining input when detecting an error in an input row.</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  // Always set for current client and server.</td></tr><tr class="hit"><td class="line">40</td><td class="hits">4</td><td class="source">  this.completeArrayExecution = true;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  // The session locale can be set by the client.</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  // The locale is used in language-dependent handling</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  // within the SAP HANA database calculation engine.</td></tr><tr class="hit"><td class="line">45</td><td class="hits">4</td><td class="source">  this.clientLocale = 'en_US';</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  // This field is set by the server to process array commands.</td></tr><tr class="hit"><td class="line">48</td><td class="hits">4</td><td class="source">  this.supportsLargeBulkOperations = undefined;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  // This field is set by the server to indicate</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  // support of a large number of parameters.</td></tr><tr class="hit"><td class="line">52</td><td class="hits">4</td><td class="source">  this.largeNumberOfParametersSupport = undefined;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  // This option is set by the server and filled with the SAPSYSTEMNAME</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  // of the connected instance for tracing and supportability purposes.</td></tr><tr class="hit"><td class="line">56</td><td class="hits">4</td><td class="source">  this.systemId = undefined;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  // This field is set by the client to indicate that the client is able</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  // to handle the special function code for SELECT ... FOR UPDATE commands.</td></tr><tr class="hit"><td class="line">60</td><td class="hits">4</td><td class="source">  this.selectForUpdateSupported = false;</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">  // This field is set by the client to indicate the mode for handling</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source">  // statement routing and client distribution.</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  // The server sets this field to the appropriate support level</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  // depending on the client value and its own configuration.</td></tr><tr><td class="line">66</td><td class="hits"></td><td class="source">  //</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">  // The following values are supported:</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">  // *  `0` OFF, no routing or distributed transaction handling is done.</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  // *  `1` CONNECTION, client can connect to any (master/slave) server</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  //        in the topology, and connections are enabled, such that the</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  //        connection load on the nodes is balanced.</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  // *  `2` STATEMENT, server returns information about which node is preferred</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">  //        for executing the statement, clients execute on that node,</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source">  //        if possible.</td></tr><tr><td class="line">75</td><td class="hits"></td><td class="source">  // *  `3` STATEMENT_CONNECTION, both STATEMENT and CONNECTION level</td></tr><tr class="hit"><td class="line">76</td><td class="hits">4</td><td class="source">  this.clientDistributionMode = ClientDistributionMode.OFF;</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  // The server sets this field to the maximum version it is able to support.</td></tr><tr><td class="line">79</td><td class="hits"></td><td class="source">  // The possible values correspond to the `dataFormatVersion` property.</td></tr><tr class="hit"><td class="line">80</td><td class="hits">4</td><td class="source">  this.engineDataFormatVersion = undefined;</td></tr><tr><td class="line">81</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  // This field is set by the client and indicates</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  // the support level in the protocol for distribution features.</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  // The server may choose to disable distribution if the support level</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">  // is not sufficient for the handling.</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  // *  `0` BASE Baseline version</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  // *  `1` Client handles statement sequence number information</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  //        (statement context part handling).</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  // `clientDistributionMode` is OFF if a value less than one</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">  // is returned by the server.</td></tr><tr class="hit"><td class="line">91</td><td class="hits">4</td><td class="source">  this.distributionProtocolVersion = DistributionProtocolVersion.BASE;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  // This field is sent by the client and returned by the server</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">  // if configuration allows splitting batch (array)</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  // commands for parallel execution.</td></tr><tr class="hit"><td class="line">96</td><td class="hits">4</td><td class="source">  this.splitBatchCommands = true;</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  // This field is sent by the server to indicate the client should gather the</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  // state of the current transaction only from the `TRANSACTIONFLAGS` command,</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">  // not from the nature of the command (DDL, UPDATE, and so on).</td></tr><tr class="hit"><td class="line">101</td><td class="hits">4</td><td class="source">  this.useTransactionFlagsOnly = undefined;</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  // This field is sent by the server to indicate it ignores unknown parts</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">  // of the communication protocol instead of raising a fatal error.</td></tr><tr class="hit"><td class="line">105</td><td class="hits">4</td><td class="source">  this.ignoreUnknownParts = undefined;</td></tr><tr><td class="line">106</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">  // The client indicates this set of understood type codes and field formats.</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">  // The server then defines the value according to its own capabilities,</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  // and sends it back. The following values are supported:</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  // *  `1` Baseline data type support (SAP HANA SPS 02)</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">  // *  `4` Baseline data type support (SAP HANA SPS 06)</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">  //        Support for ALPHANUM, TEXT, SHORTTEXT, LONGDATE, SECONDDATE,</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">  //        DAYDATE, and SECONDTIME.</td></tr><tr class="hit"><td class="line">114</td><td class="hits">4</td><td class="source">  this.dataFormatVersion = DataFormatVersion.COMPLETE_DATATYPE_SUPPORT;</td></tr><tr class="hit"><td class="line">115</td><td class="hits">4</td><td class="source">  this.dataFormatVersion2 = DataFormatVersion.COMPLETE_DATATYPE_SUPPORT;</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">118</td><td class="hits">1</td><td class="source">ConnectOptions.prototype.PROPERTY_NAMES = common.ConnectOptionName;</td></tr><tr class="hit"><td class="line">119</td><td class="hits">1</td><td class="source">ConnectOptions.prototype.TYPES = common.ConnectOptionType;</td></tr><tr class="hit"><td class="line">120</td><td class="hits">1</td><td class="source">ConnectOptions.prototype.KEYS = [</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">  common.ConnectOption.COMPLETE_ARRAY_EXECUTION,</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">  common.ConnectOption.CLIENT_LOCALE,</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">  common.ConnectOption.CLIENT_DISTRIBUTION_MODE,</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source">  common.ConnectOption.DISTRIBUTION_PROTOCOL_VERSION,</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">  common.ConnectOption.SELECT_FOR_UPDATE_SUPPORTED,</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">  common.ConnectOption.SPLIT_BATCH_COMMANDS,</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">  common.ConnectOption.DATA_FORMAT_VERSION,</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">  common.ConnectOption.DATA_FORMAT_VERSION2</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">];</td></tr></tbody></table></div><div class="file"><h2 id="protocol/part/StatementContext.js">protocol/part/StatementContext.js</h2><div id="stats" class="high"><div class="percentage">75%</div><div class="sloc">20</div><div class="hits">15</div><div class="misses">5</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var AbstractOptions = require('./AbstractOptions');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var PART_HEADER_LENGTH = common.PART_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">module.exports = StatementContext;</td></tr><tr><td class="line">21</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">util.inherits(StatementContext, AbstractOptions);</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">function StatementContext() {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">  AbstractOptions.call(this);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  // Information on the statement sequence within the transaction</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  this.statementSequenceInfo = undefined;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">  // Time for statement execution on the server in nano seconds</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">  this.serverExecutionTime = 0;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">Object.defineProperties(StatementContext.prototype, {</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  size: {</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">    get: function getSize() {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">      var statementSequenceInfoLength;</td></tr><tr class="miss"><td class="line">37</td><td class="hits">0</td><td class="source">      if (this.statementSequenceInfo) {</td></tr><tr class="miss"><td class="line">38</td><td class="hits">0</td><td class="source">        statementSequenceInfoLength = this.statementSequenceInfo.length;</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">      } else {</td></tr><tr class="miss"><td class="line">40</td><td class="hits">0</td><td class="source">        statementSequenceInfoLength = 10;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">      }</td></tr><tr class="miss"><td class="line">42</td><td class="hits">0</td><td class="source">      return PART_HEADER_LENGTH + util.alignLength(4 +</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">        statementSequenceInfoLength, 8);</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">StatementContext.prototype.PROPERTY_NAMES = common.StatementContextName;</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">StatementContext.prototype.TYPES = common.StatementContextType;</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">StatementContext.prototype.KEYS = [</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  common.StatementContext.STATEMENT_SEQUENCE_INFO</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">];</td></tr></tbody></table></div><div class="file"><h2 id="protocol/part/index.js">protocol/part/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">3</div><div class="hits">3</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.ConnectOptions = require('./ConnectOptions');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.StatementContext = require('./StatementContext');</td></tr></tbody></table></div><div class="file"><h2 id="protocol/reply/Part.js">protocol/reply/Part.js</h2><div id="stats" class="high"><div class="percentage">98%</div><div class="sloc">78</div><div class="hits">77</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var PartKind = common.PartKind;</td></tr><tr><td class="line">19</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var PART_HEADER_LENGTH = common.PART_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var BIG_ARGUMENT_COUNT_INDICATOR = -1;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">module.exports = Part;</td></tr><tr><td class="line">24</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">function Part(kind, attributes, argumentCount, buffer, encoding) {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">187</td><td class="source">  this.kind = kind || PartKind.NIL;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">187</td><td class="source">  this.attributes = attributes || 0;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">187</td><td class="source">  this.argumentCount = argumentCount || 0;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">187</td><td class="source">  if (util.isString(buffer)) {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">    this.buffer = new Buffer(buffer, encoding || 'hex');</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">186</td><td class="source">    this.buffer = buffer;</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">Object.defineProperty(Part.prototype, 'byteLength', {</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  get: function getByteLength() {</td></tr><tr class="hit"><td class="line">38</td><td class="hits">4</td><td class="source">    var byteLength = PART_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">4</td><td class="source">    if (Buffer.isBuffer(this.buffer)) {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">3</td><td class="source">      byteLength += util.alignLength(this.buffer.length, 8);</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">42</td><td class="hits">4</td><td class="source">    return byteLength;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">Part.create = createPart;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">Part.read = readPart;</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">function createPart(buffer, offset) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">1</td><td class="source">  var part = new Part();</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">  readPart.call(part, buffer, offset);</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">  return part;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">function readPart(buffer, offset) {</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">57</td><td class="hits">92</td><td class="source">  offset = offset || 0;</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">59</td><td class="hits">92</td><td class="source">  this.kind = buffer[offset];</td></tr><tr class="hit"><td class="line">60</td><td class="hits">92</td><td class="source">  this.attributes = buffer[offset + 1];</td></tr><tr class="hit"><td class="line">61</td><td class="hits">92</td><td class="source">  this.argumentCount = buffer.readInt16LE(offset + 2);</td></tr><tr class="hit"><td class="line">62</td><td class="hits">92</td><td class="source">  if (this.argumentCount === BIG_ARGUMENT_COUNT_INDICATOR) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">    this.argumentCount = buffer.readInt32LE(offset + 4);</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">65</td><td class="hits">92</td><td class="source">  var length = buffer.readInt32LE(offset + 8);</td></tr><tr class="hit"><td class="line">66</td><td class="hits">92</td><td class="source">  offset += PART_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">92</td><td class="source">  if (length &gt; 0) {</td></tr><tr class="hit"><td class="line">68</td><td class="hits">88</td><td class="source">    this.buffer = new Buffer(length);</td></tr><tr class="hit"><td class="line">69</td><td class="hits">88</td><td class="source">    buffer.copy(this.buffer, 0, offset, offset + length);</td></tr><tr class="hit"><td class="line">70</td><td class="hits">88</td><td class="source">    offset += util.alignLength(length, 8);</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">72</td><td class="hits">92</td><td class="source">  return offset;</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">Part.prototype.toBuffer = function toBuffer(size) {</td></tr><tr class="hit"><td class="line">76</td><td class="hits">91</td><td class="source">  var byteLength = util.alignLength(this.buffer.length, 8);</td></tr><tr class="hit"><td class="line">77</td><td class="hits">91</td><td class="source">  var buffer = new Buffer(PART_HEADER_LENGTH + byteLength);</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">  // Part kind, specifies nature of part data</td></tr><tr class="hit"><td class="line">79</td><td class="hits">91</td><td class="source">  buffer.writeInt8(this.kind, 0);</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  // Further attributes of part</td></tr><tr class="hit"><td class="line">81</td><td class="hits">91</td><td class="source">  buffer.writeInt8(this.attributes, 1);</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  // Argument count, number of elements in part data.</td></tr><tr class="hit"><td class="line">83</td><td class="hits">91</td><td class="source">  buffer.writeInt16LE(this.argumentCount, 2);</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  // Argument count, number of elements in part data (only for some part kinds).</td></tr><tr class="hit"><td class="line">85</td><td class="hits">91</td><td class="source">  buffer.writeInt32LE(0, 4);</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">  // Length of part buffer in bytes</td></tr><tr class="hit"><td class="line">87</td><td class="hits">91</td><td class="source">  buffer.writeInt32LE(this.buffer.length, 8);</td></tr><tr><td class="line">88</td><td class="hits"></td><td class="source">  // Length in packet remaining without this part.</td></tr><tr class="hit"><td class="line">89</td><td class="hits">91</td><td class="source">  buffer.writeInt32LE(size, 12);</td></tr><tr class="hit"><td class="line">90</td><td class="hits">91</td><td class="source">  this.buffer.copy(buffer, PART_HEADER_LENGTH);</td></tr><tr class="hit"><td class="line">91</td><td class="hits">91</td><td class="source">  if (this.buffer.length &lt; byteLength) {</td></tr><tr class="hit"><td class="line">92</td><td class="hits">43</td><td class="source">    buffer.fill(0x00, PART_HEADER_LENGTH + this.buffer.length);</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">94</td><td class="hits">91</td><td class="source">  return buffer;</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">97</td><td class="hits">1</td><td class="source">Part.prototype.inspect = function inspect(options) {</td></tr><tr class="hit"><td class="line">98</td><td class="hits">1</td><td class="source">  var lines = [];</td></tr><tr class="hit"><td class="line">99</td><td class="hits">1</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">100</td><td class="hits">1</td><td class="source">  var offset = new Buffer(options.indentOffset || 0);</td></tr><tr class="hit"><td class="line">101</td><td class="hits">1</td><td class="source">  offset.fill(0x20);</td></tr><tr class="hit"><td class="line">102</td><td class="hits">1</td><td class="source">  offset = offset.toString('ascii');</td></tr><tr class="hit"><td class="line">103</td><td class="hits">1</td><td class="source">  var kindName = common.PartKindName[this.kind];</td></tr><tr class="hit"><td class="line">104</td><td class="hits">1</td><td class="source">  lines.push(offset + '{\n');</td></tr><tr class="hit"><td class="line">105</td><td class="hits">1</td><td class="source">  lines.push(offset + '  kind: PartKind.' + kindName + ',\n');</td></tr><tr class="hit"><td class="line">106</td><td class="hits">1</td><td class="source">  lines.push(offset + '  argumentCount: ' + this.argumentCount + ',\n');</td></tr><tr class="hit"><td class="line">107</td><td class="hits">1</td><td class="source">  lines.push(offset + '  attributes: ' + this.attributes + ',\n');</td></tr><tr class="hit"><td class="line">108</td><td class="hits">1</td><td class="source">  if (Buffer.isBuffer(this.buffer)) {</td></tr><tr class="hit"><td class="line">109</td><td class="hits">1</td><td class="source">    var length = this.buffer.length;</td></tr><tr class="hit"><td class="line">110</td><td class="hits">1</td><td class="source">    var start, end, chunk;</td></tr><tr class="hit"><td class="line">111</td><td class="hits">1</td><td class="source">    start = 0;</td></tr><tr class="hit"><td class="line">112</td><td class="hits">1</td><td class="source">    var hexstr = [];</td></tr><tr class="hit"><td class="line">113</td><td class="hits">1</td><td class="source">    while (start &lt; length) {</td></tr><tr class="hit"><td class="line">114</td><td class="hits">1</td><td class="source">      end = start + 32 &gt; length ? length : start + 32;</td></tr><tr class="hit"><td class="line">115</td><td class="hits">1</td><td class="source">      chunk = this.buffer.toString('hex', start, end);</td></tr><tr class="hit"><td class="line">116</td><td class="hits">1</td><td class="source">      hexstr.push(offset + '    \'' + chunk + '\'');</td></tr><tr class="hit"><td class="line">117</td><td class="hits">1</td><td class="source">      start = end;</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">119</td><td class="hits">1</td><td class="source">    lines.push(offset + '  buffer: new Buffer(\n');</td></tr><tr class="hit"><td class="line">120</td><td class="hits">1</td><td class="source">    lines.push(hexstr.join(' +\n') + ', \'hex\')\n');</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">122</td><td class="hits">0</td><td class="source">    lines.push(offset + '  buffer: null\n');</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">124</td><td class="hits">1</td><td class="source">  lines.push(offset + '}');</td></tr><tr class="hit"><td class="line">125</td><td class="hits">1</td><td class="source">  return lines.join('');</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/reply/Segment.js">protocol/reply/Segment.js</h2><div id="stats" class="high"><div class="percentage">89%</div><div class="sloc">112</div><div class="hits">100</div><div class="misses">12</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Part = require('./Part');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var data = require('../data');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var FunctionCode = common.FunctionCode;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var SegmentKind = common.SegmentKind;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var PartKindName = common.PartKindName;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var MAX_PACKET_SIZE = common.MAX_PACKET_SIZE;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var PACKET_HEADER_LENGTH = common.PACKET_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var SEGMENT_HEADER_LENGTH = common.SEGMENT_HEADER_LENGTH;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">module.exports = Segment;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">function Segment(kind, functionCode) {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">129</td><td class="source">  this.kind = kind || SegmentKind.INVALID;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">129</td><td class="source">  this.functionCode = functionCode || FunctionCode.NIL;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">129</td><td class="source">  this.parts = [];</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">Segment.prototype.push = function push(part) {</td></tr><tr class="hit"><td class="line">36</td><td class="hits">180</td><td class="source">  this.parts.push(part);</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">Segment.prototype.inspect = function inpsect() {</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">  var lines = [];</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">  var kindName = common.SegmentKindName[this.kind];</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">  var fcodeName = common.FunctionCodeName[this.functionCode];</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">  lines.push('{\n');</td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">  lines.push('  kind: SegmentKind.' + kindName + ',\n');</td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">  lines.push('  functionCode: FunctionCode.' + fcodeName + ',\n');</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">  lines.push('  parts: [\n');</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">  function inspectPart(part) {</td></tr><tr class="miss"><td class="line">49</td><td class="hits">0</td><td class="source">    return part.inspect({</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">      indentOffset: 4</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">  lines.push(this.parts.map(inspectPart).join(',\n') + '\n');</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">  lines.push('  ]\n');</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">  lines.push('}\n');</td></tr><tr class="hit"><td class="line">56</td><td class="hits">1</td><td class="source">  return lines.join('');</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">};</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">Segment.create = createSegment;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">function createSegment(buffer, offset) {</td></tr><tr class="hit"><td class="line">61</td><td class="hits">63</td><td class="source">  var segment = new Segment();</td></tr><tr class="hit"><td class="line">62</td><td class="hits">63</td><td class="source">  readSegment.call(segment, buffer, offset);</td></tr><tr class="hit"><td class="line">63</td><td class="hits">63</td><td class="source">  return segment;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">Segment.read = readSegment;</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">function readSegment(buffer, offset) {</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">  /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">70</td><td class="hits">63</td><td class="source">  offset = offset || 0;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">72</td><td class="hits">63</td><td class="source">  var numberOfParts = buffer.readInt16LE(offset + 8);</td></tr><tr class="hit"><td class="line">73</td><td class="hits">63</td><td class="source">  this.kind = buffer.readInt8(offset + 12);</td></tr><tr class="hit"><td class="line">74</td><td class="hits">63</td><td class="source">  this.functionCode = buffer.readInt16LE(offset + 14);</td></tr><tr class="hit"><td class="line">75</td><td class="hits">63</td><td class="source">  offset += SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">76</td><td class="hits">63</td><td class="source">  for (var i = 0; i &lt; numberOfParts; i++) {</td></tr><tr class="hit"><td class="line">77</td><td class="hits">90</td><td class="source">    var part = new Part();</td></tr><tr class="hit"><td class="line">78</td><td class="hits">90</td><td class="source">    offset = Part.read.call(part, buffer, offset);</td></tr><tr class="hit"><td class="line">79</td><td class="hits">90</td><td class="source">    this.push(part);</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">81</td><td class="hits">63</td><td class="source">  return offset;</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">84</td><td class="hits">1</td><td class="source">Segment.prototype.toBuffer = function toBuffer(size) {</td></tr><tr class="hit"><td class="line">85</td><td class="hits">64</td><td class="source">  size = size || (MAX_PACKET_SIZE - PACKET_HEADER_LENGTH);</td></tr><tr class="hit"><td class="line">86</td><td class="hits">64</td><td class="source">  var remainingSize = size - SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">87</td><td class="hits">64</td><td class="source">  var length = SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">88</td><td class="hits">64</td><td class="source">  var buffers = this.parts.map(function getPartBuffer(part) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">90</td><td class="source">    var buffer = part.toBuffer(remainingSize);</td></tr><tr class="hit"><td class="line">90</td><td class="hits">90</td><td class="source">    remainingSize -= buffer.length;</td></tr><tr class="hit"><td class="line">91</td><td class="hits">90</td><td class="source">    length += buffer.length;</td></tr><tr class="hit"><td class="line">92</td><td class="hits">90</td><td class="source">    return buffer;</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">95</td><td class="hits">64</td><td class="source">  var header = new Buffer(SEGMENT_HEADER_LENGTH);</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">  // Length of the segment, including the header</td></tr><tr class="hit"><td class="line">98</td><td class="hits">64</td><td class="source">  header.writeInt32LE(length, 0);</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  // Offset of the segment within the message buffer</td></tr><tr class="hit"><td class="line">100</td><td class="hits">64</td><td class="source">  header.writeInt32LE(0, 4);</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">  // Number of contained parts</td></tr><tr class="hit"><td class="line">102</td><td class="hits">64</td><td class="source">  header.writeInt16LE(this.parts.length, 8);</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  // Number of segment within packet</td></tr><tr class="hit"><td class="line">104</td><td class="hits">64</td><td class="source">  header.writeInt16LE(1, 10);</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source">  // Segment kind</td></tr><tr class="hit"><td class="line">106</td><td class="hits">64</td><td class="source">  header.writeInt8(this.kind, 12);</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">  // Filler</td></tr><tr class="hit"><td class="line">108</td><td class="hits">64</td><td class="source">  header[13] = 0x00;</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">  // Function code</td></tr><tr class="hit"><td class="line">110</td><td class="hits">64</td><td class="source">  header.writeInt16LE(this.functionCode, 14);</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source">  // Filler</td></tr><tr class="hit"><td class="line">112</td><td class="hits">64</td><td class="source">  header.fill(0x00, 16);</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">114</td><td class="hits">64</td><td class="source">  buffers.unshift(header);</td></tr><tr class="hit"><td class="line">115</td><td class="hits">64</td><td class="source">  return Buffer.concat(buffers, length);</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">117</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">118</td><td class="hits">1</td><td class="source">Segment.prototype.getPart = function (kind) {</td></tr><tr class="miss"><td class="line">119</td><td class="hits">0</td><td class="source">  var parts = this.parts.filter(function isKindOf(part) {</td></tr><tr class="miss"><td class="line">120</td><td class="hits">0</td><td class="source">    return part.kind === kind;</td></tr><tr><td class="line">121</td><td class="hits"></td><td class="source">  });</td></tr><tr class="miss"><td class="line">122</td><td class="hits">0</td><td class="source">  if (parts.length === 1) {</td></tr><tr class="miss"><td class="line">123</td><td class="hits">0</td><td class="source">    return parts[0];</td></tr><tr class="miss"><td class="line">124</td><td class="hits">0</td><td class="source">  } else if (parts.length &gt; 1) {</td></tr><tr class="miss"><td class="line">125</td><td class="hits">0</td><td class="source">    return parts;</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">127</td><td class="hits">0</td><td class="source">  return null;</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">130</td><td class="hits">1</td><td class="source">Segment.prototype.getReply = function getReply() {</td></tr><tr class="hit"><td class="line">131</td><td class="hits">63</td><td class="source">  var reply = new Reply(this.kind, this.functionCode);</td></tr><tr class="hit"><td class="line">132</td><td class="hits">63</td><td class="source">  for (var i = 0; i &lt; this.parts.length; i++) {</td></tr><tr class="hit"><td class="line">133</td><td class="hits">90</td><td class="source">    reply.add(this.parts[i]);</td></tr><tr><td class="line">134</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">135</td><td class="hits">63</td><td class="source">  return reply;</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">138</td><td class="hits">1</td><td class="source">function Reply(kind, functionCode) {</td></tr><tr class="hit"><td class="line">139</td><td class="hits">63</td><td class="source">  this.kind = kind;</td></tr><tr class="hit"><td class="line">140</td><td class="hits">63</td><td class="source">  this.functionCode = functionCode;</td></tr><tr class="hit"><td class="line">141</td><td class="hits">63</td><td class="source">  this.resultSets = [];</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">144</td><td class="hits">1</td><td class="source">Reply.prototype.addResultSetFragment = function addResultSetFragment(name,</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">  value) {</td></tr><tr class="hit"><td class="line">146</td><td class="hits">36</td><td class="source">  var resultSet;</td></tr><tr class="hit"><td class="line">147</td><td class="hits">36</td><td class="source">  if (this.resultSets.length) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">20</td><td class="source">    resultSet = this.resultSets[this.resultSets.length - 1];</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">150</td><td class="hits">36</td><td class="source">  if (name === 'resultSet') {</td></tr><tr class="hit"><td class="line">151</td><td class="hits">15</td><td class="source">    name = 'data';</td></tr><tr class="hit"><td class="line">152</td><td class="hits">21</td><td class="source">  } else if (name === 'resultSetId') {</td></tr><tr class="hit"><td class="line">153</td><td class="hits">11</td><td class="source">    name = 'id';</td></tr><tr class="hit"><td class="line">154</td><td class="hits">10</td><td class="source">  } else if (name === 'resultSetMetadata') {</td></tr><tr class="hit"><td class="line">155</td><td class="hits">10</td><td class="source">    name = 'metadata';</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">157</td><td class="hits">36</td><td class="source">  if (!resultSet || resultSet[name]) {</td></tr><tr class="hit"><td class="line">158</td><td class="hits">16</td><td class="source">    resultSet = {};</td></tr><tr class="hit"><td class="line">159</td><td class="hits">16</td><td class="source">    resultSet[name] = value;</td></tr><tr class="hit"><td class="line">160</td><td class="hits">16</td><td class="source">    this.resultSets.push(resultSet);</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">162</td><td class="hits">20</td><td class="source">    resultSet[name] = value;</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">166</td><td class="hits">1</td><td class="source">Reply.prototype.add = function add(part) {</td></tr><tr class="hit"><td class="line">167</td><td class="hits">90</td><td class="source">  var name = util._2cc(PartKindName[part.kind]);</td></tr><tr class="hit"><td class="line">168</td><td class="hits">90</td><td class="source">  var value = data[part.kind].read(part);</td></tr><tr class="hit"><td class="line">169</td><td class="hits">90</td><td class="source">  if (/^resultSet/.test(name) || name === 'tableName') {</td></tr><tr class="hit"><td class="line">170</td><td class="hits">36</td><td class="source">    this.addResultSetFragment(name, value);</td></tr><tr class="hit"><td class="line">171</td><td class="hits">54</td><td class="source">  } else if (util.isUndefined(this[name])) {</td></tr><tr class="hit"><td class="line">172</td><td class="hits">54</td><td class="source">    this[name] = value;</td></tr><tr class="miss"><td class="line">173</td><td class="hits">0</td><td class="source">  } else if (util.isArray(this[name])) {</td></tr><tr class="miss"><td class="line">174</td><td class="hits">0</td><td class="source">    this[name].push(value);</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">176</td><td class="hits">0</td><td class="source">    var existingValue = this[name];</td></tr><tr class="miss"><td class="line">177</td><td class="hits">0</td><td class="source">    this[name] = [existingValue, value];</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/reply/index.js">protocol/reply/index.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">3</div><div class="hits">3</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">exports.Part = require('./Part');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">exports.Segment = require('./Segment');</td></tr></tbody></table></div><div class="file"><h2 id="protocol/request/Part.js">protocol/request/Part.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">23</div><div class="hits">23</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var PartKind = require('../common/PartKind');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var PART_HEADER_LENGTH = 16;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">module.exports = Part;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function Part(options) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">81</td><td class="source">  this.kind = options.kind || PartKind.NIL;</td></tr><tr class="hit"><td class="line">25</td><td class="hits">81</td><td class="source">  this.attributes = options.attributes || 0;</td></tr><tr class="hit"><td class="line">26</td><td class="hits">81</td><td class="source">  this.argumentCount = options.argumentCount || 0;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">81</td><td class="source">  this.buffer = undefined;</td></tr><tr><td class="line">28</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">Part.prototype.toBuffer = function toBuffer(size) {</td></tr><tr class="hit"><td class="line">32</td><td class="hits">81</td><td class="source">  var byteLength = util.alignLength(this.buffer.length, 8);</td></tr><tr class="hit"><td class="line">33</td><td class="hits">81</td><td class="source">  var buffer = new Buffer(PART_HEADER_LENGTH + byteLength);</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  // Part kind, specifies nature of part data</td></tr><tr class="hit"><td class="line">35</td><td class="hits">81</td><td class="source">  buffer.writeInt8(this.kind, 0);</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  // Further attributes of part</td></tr><tr class="hit"><td class="line">37</td><td class="hits">81</td><td class="source">  buffer.writeInt8(this.attributes, 1);</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  // Argument count, number of elements in part data.</td></tr><tr class="hit"><td class="line">39</td><td class="hits">81</td><td class="source">  buffer.writeInt16LE(this.argumentCount, 2);</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  // Argument count, number of elements in part data (only for some part kinds).</td></tr><tr class="hit"><td class="line">41</td><td class="hits">81</td><td class="source">  buffer.writeInt32LE(0, 4);</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">  // Length of part buffer in bytes</td></tr><tr class="hit"><td class="line">43</td><td class="hits">81</td><td class="source">  buffer.writeInt32LE(this.buffer.length, 8);</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  // Length in packet remaining without this part.</td></tr><tr class="hit"><td class="line">45</td><td class="hits">81</td><td class="source">  buffer.writeInt32LE(size, 12);</td></tr><tr class="hit"><td class="line">46</td><td class="hits">81</td><td class="source">  this.buffer.copy(buffer, PART_HEADER_LENGTH);</td></tr><tr class="hit"><td class="line">47</td><td class="hits">81</td><td class="source">  if (this.buffer.length &lt; byteLength) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">38</td><td class="source">    buffer.fill(0x00, PART_HEADER_LENGTH + this.buffer.length);</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">50</td><td class="hits">81</td><td class="source">  return buffer;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="protocol/request/Segment.js">protocol/request/Segment.js</h2><div id="stats" class="high"><div class="percentage">89%</div><div class="sloc">58</div><div class="hits">52</div><div class="misses">6</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var data = require('../data');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var Part = require('./Part');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var MessageType = common.MessageType;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var SegmentKind = common.SegmentKind;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var MAX_SEGMENT_SIZE = common.MAX_PACKET_SIZE - common.PACKET_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var SEGMENT_HEADER_LENGTH = common.SEGMENT_HEADER_LENGTH;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">module.exports = Segment;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">function Segment(type, commitImmediateley, commandOptions) {</td></tr><tr class="hit"><td class="line">29</td><td class="hits">75</td><td class="source">  this.type = type || MessageType.NIL;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">75</td><td class="source">  this.commitImmediateley = !!commitImmediateley ? 1 : 0;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">75</td><td class="source">  this.commandOptions = commandOptions || 0;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">75</td><td class="source">  this.parts = [];</td></tr><tr><td class="line">33</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">Segment.prototype.addPart = function addPart(part) {</td></tr><tr class="miss"><td class="line">36</td><td class="hits">0</td><td class="source">  this.parts.push(part);</td></tr><tr class="miss"><td class="line">37</td><td class="hits">0</td><td class="source">  return part;</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">Segment.prototype.push = function push(kind, args) {</td></tr><tr class="miss"><td class="line">41</td><td class="hits">0</td><td class="source">  this.parts.push({</td></tr><tr><td class="line">42</td><td class="hits"></td><td class="source">    kind: kind,</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">    args: args</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">Segment.prototype.unshift = function unshift(kind, args) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">  this.parts.unshift({</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    kind: kind,</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">    args: args</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">Segment.prototype.add = function add(kind, args) {</td></tr><tr class="hit"><td class="line">55</td><td class="hits">97</td><td class="source">  if (!args) {</td></tr><tr class="miss"><td class="line">56</td><td class="hits">0</td><td class="source">    return;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">58</td><td class="hits">97</td><td class="source">  if (util.isNumber(kind)) {</td></tr><tr class="hit"><td class="line">59</td><td class="hits">97</td><td class="source">    this.parts.push({</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">      kind: kind,</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source">      args: args</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">    });</td></tr><tr class="hit"><td class="line">63</td><td class="hits">97</td><td class="source">    return;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">65</td><td class="hits">0</td><td class="source">  if (util.isObject(kind)) {</td></tr><tr class="miss"><td class="line">66</td><td class="hits">0</td><td class="source">    this.parts.push({</td></tr><tr><td class="line">67</td><td class="hits"></td><td class="source">      kind: kind.kind,</td></tr><tr><td class="line">68</td><td class="hits"></td><td class="source">      module: kind.module,</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">      args: args</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">Segment.prototype.toBuffer = function toBuffer(size) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">64</td><td class="source">  size = size || MAX_SEGMENT_SIZE;</td></tr><tr class="hit"><td class="line">76</td><td class="hits">64</td><td class="source">  var remainingSize = size - SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">77</td><td class="hits">64</td><td class="source">  var length = SEGMENT_HEADER_LENGTH;</td></tr><tr class="hit"><td class="line">78</td><td class="hits">64</td><td class="source">  var buffers = [];</td></tr><tr class="hit"><td class="line">79</td><td class="hits">64</td><td class="source">  for (var i = 0; i &lt; this.parts.length; i++) {</td></tr><tr class="hit"><td class="line">80</td><td class="hits">81</td><td class="source">    var buffer = partToBuffer(this.parts[i], remainingSize);</td></tr><tr class="hit"><td class="line">81</td><td class="hits">81</td><td class="source">    remainingSize -= buffer.length;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">81</td><td class="source">    length += buffer.length;</td></tr><tr class="hit"><td class="line">83</td><td class="hits">81</td><td class="source">    buffers.push(buffer);</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">86</td><td class="hits">64</td><td class="source">  var header = new Buffer(SEGMENT_HEADER_LENGTH);</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  // Length of the segment, including the header</td></tr><tr class="hit"><td class="line">88</td><td class="hits">64</td><td class="source">  header.writeInt32LE(length, 0);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  // Offset of the segment within the message buffer</td></tr><tr class="hit"><td class="line">90</td><td class="hits">64</td><td class="source">  header.writeInt32LE(0, 4);</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">  // Number of contained parts</td></tr><tr class="hit"><td class="line">92</td><td class="hits">64</td><td class="source">  header.writeInt16LE(this.parts.length, 8);</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  // Number of segment within packet</td></tr><tr class="hit"><td class="line">94</td><td class="hits">64</td><td class="source">  header.writeInt16LE(1, 10);</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">  // Segment kind</td></tr><tr class="hit"><td class="line">96</td><td class="hits">64</td><td class="source">  header.writeInt8(SegmentKind.REQUEST, 12);</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">  // Message type</td></tr><tr class="hit"><td class="line">98</td><td class="hits">64</td><td class="source">  header.writeInt8(this.type, 13);</td></tr><tr><td class="line">99</td><td class="hits"></td><td class="source">  // Whether the command shall be committed</td></tr><tr class="hit"><td class="line">100</td><td class="hits">64</td><td class="source">  header.writeInt8(this.commitImmediateley, 14);</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">  // Command options</td></tr><tr class="hit"><td class="line">102</td><td class="hits">64</td><td class="source">  header.writeInt8(this.commandOptions, 15);</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">  // Filler</td></tr><tr class="hit"><td class="line">104</td><td class="hits">64</td><td class="source">  header.fill(0x00, 16, SEGMENT_HEADER_LENGTH);</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">106</td><td class="hits">64</td><td class="source">  buffers.unshift(header);</td></tr><tr class="hit"><td class="line">107</td><td class="hits">64</td><td class="source">  return Buffer.concat(buffers, length);</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">110</td><td class="hits">1</td><td class="source">function partToBuffer(pd, remainingSize) {</td></tr><tr class="hit"><td class="line">111</td><td class="hits">81</td><td class="source">  var m = pd.module || data[pd.kind];</td></tr><tr class="hit"><td class="line">112</td><td class="hits">81</td><td class="source">  var part = new Part({</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">    kind: pd.kind</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source">  });</td></tr><tr class="hit"><td class="line">115</td><td class="hits">81</td><td class="source">  part.argumentCount = m.getArgumentCount(pd.args);</td></tr><tr class="hit"><td class="line">116</td><td class="hits">81</td><td class="source">  m.write(part, pd.args, remainingSize);</td></tr><tr class="hit"><td class="line">117</td><td class="hits">81</td><td class="source">  return part.toBuffer(remainingSize);</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/request/index.js">protocol/request/index.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">113</div><div class="hits">108</div><div class="misses">5</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('../../util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var Segment = require('./Segment');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var Part = require('./Part');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var common = require('../common');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var MessageType = common.MessageType;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var PartKind = common.PartKind;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var TypeCode = common.TypeCode;</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var CommandOption = common.CommandOption;</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var CommitOption = common.CommitOption;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">exports.Segment = Segment;</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">exports.Part = Part;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">exports.authenticate = authenticate;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">exports.connect = connect;</td></tr><tr class="hit"><td class="line">30</td><td class="hits">1</td><td class="source">exports.disconnect = disconnect;</td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">exports.executeDirect = executeDirect;</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">exports.prepare = prepare;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">exports.execute = execute;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">exports.fetchNext = fetchNext;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">exports.closeResultSet = closeResultSet;</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">exports.dropStatementId = dropStatementId;</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">exports.readLob = readLob;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">exports.writeLob = writeLob;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">exports.commit = commit;</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">exports.rollback = rollback;</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">function createSegment(type, options) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">75</td><td class="source">  options = options || {};</td></tr><tr class="hit"><td class="line">44</td><td class="hits">75</td><td class="source">  var commitImmediateley = 0;</td></tr><tr class="hit"><td class="line">45</td><td class="hits">75</td><td class="source">  var commandOptions = 0;</td></tr><tr class="hit"><td class="line">46</td><td class="hits">75</td><td class="source">  switch (type) {</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  case MessageType.EXECUTE:</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  case MessageType.EXECUTE_DIRECT:</td></tr><tr class="hit"><td class="line">49</td><td class="hits">21</td><td class="source">    commitImmediateley = getCommitImmediateley(options, 1);</td></tr><tr class="hit"><td class="line">50</td><td class="hits">21</td><td class="source">    commandOptions = getCommandOptions(options);</td></tr><tr class="hit"><td class="line">51</td><td class="hits">21</td><td class="source">    break;</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  case MessageType.FETCH_NEXT:</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  case MessageType.READ_LOB:</td></tr><tr class="hit"><td class="line">54</td><td class="hits">14</td><td class="source">    commitImmediateley = getCommitImmediateley(options, 1);</td></tr><tr class="hit"><td class="line">55</td><td class="hits">14</td><td class="source">    break;</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  case MessageType.PREPARE:</td></tr><tr class="hit"><td class="line">57</td><td class="hits">6</td><td class="source">    commandOptions = getCommandOptions(options);</td></tr><tr class="hit"><td class="line">58</td><td class="hits">6</td><td class="source">    break;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">60</td><td class="hits">75</td><td class="source">  var segment = new Segment(type, commitImmediateley, commandOptions);</td></tr><tr class="hit"><td class="line">61</td><td class="hits">75</td><td class="source">  return segment;</td></tr><tr><td class="line">62</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">63</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">function getCommitImmediateley(options, defaultValue) {</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">66</td><td class="hits">35</td><td class="source">  var commitImmediateley = defaultValue;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">35</td><td class="source">  if (!util.isUndefined(options.autoCommit)) {</td></tr><tr class="hit"><td class="line">68</td><td class="hits">35</td><td class="source">    commitImmediateley = ~~options.autoCommit;</td></tr><tr class="miss"><td class="line">69</td><td class="hits">0</td><td class="source">  } else if (!util.isUndefined(options.commitImmediateley)) {</td></tr><tr class="miss"><td class="line">70</td><td class="hits">0</td><td class="source">    commitImmediateley = ~~options.commitImmediateley;</td></tr><tr><td class="line">71</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">72</td><td class="hits">35</td><td class="source">  return commitImmediateley;</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">function getCommandOptions(options) {</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">  /* jshint bitwise:false */</td></tr><tr class="hit"><td class="line">77</td><td class="hits">27</td><td class="source">  var commandOptions = 0;</td></tr><tr class="hit"><td class="line">78</td><td class="hits">27</td><td class="source">  if (options.scrollableCursor) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">27</td><td class="source">    commandOptions |= CommandOption.SCROLLABLE_CURSOR_ON;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">81</td><td class="hits">27</td><td class="source">  if (options.holdCursorsOverCommit) {</td></tr><tr class="hit"><td class="line">82</td><td class="hits">27</td><td class="source">    commandOptions |= CommandOption.HOLD_CURSORS_OVER_COMMIT;</td></tr><tr><td class="line">83</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">84</td><td class="hits">27</td><td class="source">  return commandOptions;</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">87</td><td class="hits">1</td><td class="source">function authenticate(options) {</td></tr><tr class="hit"><td class="line">88</td><td class="hits">5</td><td class="source">  var segment = createSegment(MessageType.AUTHENTICATE, options);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">  // authentication</td></tr><tr class="hit"><td class="line">90</td><td class="hits">5</td><td class="source">  segment.add(PartKind.AUTHENTICATION, options.authentication);</td></tr><tr class="hit"><td class="line">91</td><td class="hits">5</td><td class="source">  return segment;</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">94</td><td class="hits">1</td><td class="source">function connect(options) {</td></tr><tr class="hit"><td class="line">95</td><td class="hits">4</td><td class="source">  var segment = createSegment(MessageType.CONNECT, options);</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">  // authentication</td></tr><tr class="hit"><td class="line">97</td><td class="hits">4</td><td class="source">  segment.add(PartKind.AUTHENTICATION, options.authentication);</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  // clientId</td></tr><tr class="hit"><td class="line">99</td><td class="hits">4</td><td class="source">  segment.add(PartKind.CLIENT_ID, options.clientId);</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">  // connectOptions</td></tr><tr class="hit"><td class="line">101</td><td class="hits">4</td><td class="source">  segment.add(PartKind.CONNECT_OPTIONS, options.connectOptions);</td></tr><tr class="hit"><td class="line">102</td><td class="hits">4</td><td class="source">  return segment;</td></tr><tr><td class="line">103</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">105</td><td class="hits">1</td><td class="source">function disconnect(options) {</td></tr><tr class="hit"><td class="line">106</td><td class="hits">4</td><td class="source">  var segment = createSegment(MessageType.DISCONNECT, options);</td></tr><tr class="hit"><td class="line">107</td><td class="hits">4</td><td class="source">  return segment;</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">110</td><td class="hits">1</td><td class="source">function closeResultSet(options) {</td></tr><tr class="miss"><td class="line">111</td><td class="hits">0</td><td class="source">  var segment = createSegment(MessageType.CLOSE_RESULT_SET, options);</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">  // resultSetId</td></tr><tr class="miss"><td class="line">113</td><td class="hits">0</td><td class="source">  segment.add(PartKind.RESULT_SET_ID, options.resultSetId);</td></tr><tr class="miss"><td class="line">114</td><td class="hits">0</td><td class="source">  return segment;</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">117</td><td class="hits">1</td><td class="source">function dropStatementId(options) {</td></tr><tr class="hit"><td class="line">118</td><td class="hits">3</td><td class="source">  var segment = createSegment(MessageType.DROP_STATEMENT_ID, options);</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  // statementId</td></tr><tr class="hit"><td class="line">120</td><td class="hits">3</td><td class="source">  segment.add(PartKind.STATEMENT_ID, options.statementId);</td></tr><tr class="hit"><td class="line">121</td><td class="hits">3</td><td class="source">  return segment;</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">124</td><td class="hits">1</td><td class="source">function commit(options) {</td></tr><tr class="hit"><td class="line">125</td><td class="hits">4</td><td class="source">  var segment = createSegment(MessageType.COMMIT, options);</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">  // commitOptions</td></tr><tr class="hit"><td class="line">127</td><td class="hits">4</td><td class="source">  addCommitOptions(segment, options);</td></tr><tr class="hit"><td class="line">128</td><td class="hits">4</td><td class="source">  return segment;</td></tr><tr><td class="line">129</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">131</td><td class="hits">1</td><td class="source">function rollback(options) {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">1</td><td class="source">  var segment = createSegment(MessageType.ROLLBACK, options);</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">  // commitOptions</td></tr><tr class="hit"><td class="line">134</td><td class="hits">1</td><td class="source">  addCommitOptions(segment, options);</td></tr><tr class="hit"><td class="line">135</td><td class="hits">1</td><td class="source">  return segment;</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">138</td><td class="hits">1</td><td class="source">function fetchNext(options) {</td></tr><tr class="hit"><td class="line">139</td><td class="hits">4</td><td class="source">  var segment = createSegment(MessageType.FETCH_NEXT, options);</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">  // resultSetId</td></tr><tr class="hit"><td class="line">141</td><td class="hits">4</td><td class="source">  segment.add(PartKind.RESULT_SET_ID, options.resultSetId);</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source">  // fetchSize</td></tr><tr class="hit"><td class="line">143</td><td class="hits">4</td><td class="source">  segment.add(PartKind.FETCH_SIZE, options.fetchSize);</td></tr><tr class="hit"><td class="line">144</td><td class="hits">4</td><td class="source">  return segment;</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">146</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">147</td><td class="hits">1</td><td class="source">function readLob(options) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">10</td><td class="source">  var segment = createSegment(MessageType.READ_LOB, options);</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">  // readLobRequest</td></tr><tr class="hit"><td class="line">150</td><td class="hits">10</td><td class="source">  segment.add(PartKind.READ_LOB_REQUEST, options.readLobRequest);</td></tr><tr class="hit"><td class="line">151</td><td class="hits">10</td><td class="source">  return segment;</td></tr><tr><td class="line">152</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">154</td><td class="hits">1</td><td class="source">function writeLob(options) {</td></tr><tr class="hit"><td class="line">155</td><td class="hits">13</td><td class="source">  var segment = createSegment(MessageType.WRITE_LOB);</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">  // writeLobRequest</td></tr><tr class="hit"><td class="line">157</td><td class="hits">13</td><td class="source">  segment.add(PartKind.WRITE_LOB_REQUEST, options.writeLobRequest);</td></tr><tr class="hit"><td class="line">158</td><td class="hits">13</td><td class="source">  return segment;</td></tr><tr><td class="line">159</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">160</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">161</td><td class="hits">1</td><td class="source">function execute(options) {</td></tr><tr class="hit"><td class="line">162</td><td class="hits">14</td><td class="source">  var segment = createSegment(MessageType.EXECUTE, options);</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">  // statementId</td></tr><tr class="hit"><td class="line">164</td><td class="hits">14</td><td class="source">  segment.add(PartKind.STATEMENT_ID, options.statementId);</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source">  // parameters</td></tr><tr class="hit"><td class="line">166</td><td class="hits">14</td><td class="source">  segment.add(PartKind.PARAMETERS, options.parameters);</td></tr><tr class="hit"><td class="line">167</td><td class="hits">14</td><td class="source">  return segment;</td></tr><tr><td class="line">168</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">1</td><td class="source">function executeDirect(options) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">7</td><td class="source">  var segment = createSegment(MessageType.EXECUTE_DIRECT, options);</td></tr><tr><td class="line">172</td><td class="hits"></td><td class="source">  // command</td></tr><tr class="hit"><td class="line">173</td><td class="hits">7</td><td class="source">  segment.add(PartKind.COMMAND, options.command);</td></tr><tr class="hit"><td class="line">174</td><td class="hits">7</td><td class="source">  return segment;</td></tr><tr><td class="line">175</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">176</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">177</td><td class="hits">1</td><td class="source">function prepare(options) {</td></tr><tr class="hit"><td class="line">178</td><td class="hits">6</td><td class="source">  var segment = createSegment(MessageType.PREPARE, options);</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">  // command</td></tr><tr class="hit"><td class="line">180</td><td class="hits">6</td><td class="source">  segment.add(PartKind.COMMAND, options.command);</td></tr><tr class="hit"><td class="line">181</td><td class="hits">6</td><td class="source">  return segment;</td></tr><tr><td class="line">182</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">184</td><td class="hits">1</td><td class="source">function addCommitOptions(segment, options) {</td></tr><tr class="hit"><td class="line">185</td><td class="hits">5</td><td class="source">  if (options.holdCursorsOverCommit) {</td></tr><tr class="hit"><td class="line">186</td><td class="hits">5</td><td class="source">    var commitOptions = [{</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source">      name: CommitOption.HOLD_CURSORS_OVER_COMMIT,</td></tr><tr><td class="line">188</td><td class="hits"></td><td class="source">      type: TypeCode.BOOLEAN,</td></tr><tr><td class="line">189</td><td class="hits"></td><td class="source">      value: 1</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">    }];</td></tr><tr class="hit"><td class="line">191</td><td class="hits">5</td><td class="source">    segment.add(PartKind.COMMIT_OPTIONS, commitOptions);</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">193</td><td class="hits">5</td><td class="source">  return segment;</td></tr><tr><td class="line">194</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="protocol/tcp.js">protocol/tcp.js</h2><div id="stats" class="high"><div class="percentage">91%</div><div class="sloc">12</div><div class="hits">11</div><div class="misses">1</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var net = require('net');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var tls = require('tls');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">exports.connect = function connect(options, cb) {</td></tr><tr class="hit"><td class="line">20</td><td class="hits">4</td><td class="source">  options.allowHalfOpen = false;</td></tr><tr class="hit"><td class="line">21</td><td class="hits">4</td><td class="source">  var createConnection;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">4</td><td class="source">  if ('key' in options || 'cert' in options || 'ca' in options || 'pfx' in</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source">    options) {</td></tr><tr class="miss"><td class="line">24</td><td class="hits">0</td><td class="source">    createConnection = tls.connect;</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">26</td><td class="hits">4</td><td class="source">    createConnection = net.connect;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">28</td><td class="hits">4</td><td class="source">  var socket = createConnection(options, cb);</td></tr><tr class="hit"><td class="line">29</td><td class="hits">4</td><td class="source">  socket.setNoDelay(true);</td></tr><tr class="hit"><td class="line">30</td><td class="hits">4</td><td class="source">  return socket;</td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="util/Queue.js">util/Queue.js</h2><div id="stats" class="high"><div class="percentage">86%</div><div class="sloc">67</div><div class="hits">58</div><div class="misses">9</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">16</td><td class="hits">1</td><td class="source">var util = require('util');</td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var EventEmitter = require('events').EventEmitter;</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">module.exports = Queue;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">util.inherits(Queue, EventEmitter);</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">function Queue(immediate) {</td></tr><tr class="hit"><td class="line">24</td><td class="hits">4</td><td class="source">  EventEmitter.call(this);</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">26</td><td class="hits">4</td><td class="source">  this.queue = [];</td></tr><tr class="hit"><td class="line">27</td><td class="hits">4</td><td class="source">  this.busy = false;</td></tr><tr class="hit"><td class="line">28</td><td class="hits">4</td><td class="source">  this.running = !!immediate;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">Object.defineProperty(Queue.prototype, 'empty', {</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  get: function isEmpty() {</td></tr><tr class="hit"><td class="line">33</td><td class="hits">8</td><td class="source">    return this.queue.length === 0;</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source">});</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">Queue.prototype.unshift = function unshift(task) {</td></tr><tr class="miss"><td class="line">38</td><td class="hits">0</td><td class="source">  this.queue.unshift(task);</td></tr><tr class="miss"><td class="line">39</td><td class="hits">0</td><td class="source">  if (this.running) {</td></tr><tr class="miss"><td class="line">40</td><td class="hits">0</td><td class="source">    this.dequeue();</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">42</td><td class="hits">0</td><td class="source">  return this;</td></tr><tr><td class="line">43</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">45</td><td class="hits">1</td><td class="source">Queue.prototype.push = function push(task) {</td></tr><tr class="hit"><td class="line">46</td><td class="hits">42</td><td class="source">  this.queue.push(task);</td></tr><tr class="hit"><td class="line">47</td><td class="hits">42</td><td class="source">  if (this.running) {</td></tr><tr class="hit"><td class="line">48</td><td class="hits">42</td><td class="source">    this.dequeue();</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">50</td><td class="hits">42</td><td class="source">  return this;</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">Queue.prototype.resume = function resume() {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">4</td><td class="source">  this.running = true;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">4</td><td class="source">  if (this.queue.length) {</td></tr><tr class="miss"><td class="line">56</td><td class="hits">0</td><td class="source">    this.dequeue();</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">58</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">Queue.prototype.pause = function pause() {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">4</td><td class="source">  this.running = false;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">Queue.prototype.abort = function abort() {</td></tr><tr class="hit"><td class="line">67</td><td class="hits">4</td><td class="source">  this.queue = [];</td></tr><tr class="hit"><td class="line">68</td><td class="hits">4</td><td class="source">  this.busy = false;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">4</td><td class="source">  this.running = false;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">4</td><td class="source">  this.removeAllListeners();</td></tr><tr class="hit"><td class="line">71</td><td class="hits">4</td><td class="source">  return this;</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">74</td><td class="hits">1</td><td class="source">Queue.prototype.createTask = function createTask(send, receive, name) {</td></tr><tr class="hit"><td class="line">75</td><td class="hits">34</td><td class="source">  return new Task(send, receive, name);</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">78</td><td class="hits">1</td><td class="source">Queue.prototype.dequeue = function dequeue() {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">42</td><td class="source">  var self = this;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">81</td><td class="hits">42</td><td class="source">  function next(err, name) {</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">    /* jshint unused:false */</td></tr><tr class="hit"><td class="line">83</td><td class="hits">42</td><td class="source">    self.busy = false;</td></tr><tr class="hit"><td class="line">84</td><td class="hits">42</td><td class="source">    if (err instanceof Error) {</td></tr><tr class="miss"><td class="line">85</td><td class="hits">0</td><td class="source">      self.pause();</td></tr><tr class="miss"><td class="line">86</td><td class="hits">0</td><td class="source">      self.emit('error', err);</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">88</td><td class="hits">42</td><td class="source">    if (self.queue.length) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">4</td><td class="source">      run();</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">91</td><td class="hits">38</td><td class="source">      self.emit('drain');</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">95</td><td class="hits">42</td><td class="source">  function run() {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">46</td><td class="source">    if (self.running &amp;&amp; !self.busy) {</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">      // Queue is running and not busy</td></tr><tr class="hit"><td class="line">98</td><td class="hits">42</td><td class="source">      self.busy = true;</td></tr><tr class="hit"><td class="line">99</td><td class="hits">42</td><td class="source">      var task = self.queue.shift();</td></tr><tr class="hit"><td class="line">100</td><td class="hits">42</td><td class="source">      task.run(next);</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">102</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">103</td><td class="hits">42</td><td class="source">  run();</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">105</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">106</td><td class="hits">1</td><td class="source">function Task(send, receive, name) {</td></tr><tr class="hit"><td class="line">107</td><td class="hits">34</td><td class="source">  this.send = send;</td></tr><tr class="hit"><td class="line">108</td><td class="hits">34</td><td class="source">  this.receive = receive;</td></tr><tr class="hit"><td class="line">109</td><td class="hits">34</td><td class="source">  this.name = name;</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">111</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">112</td><td class="hits">1</td><td class="source">Task.prototype.run = function run(next) {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">34</td><td class="source">  var self = this;</td></tr><tr><td class="line">114</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">115</td><td class="hits">34</td><td class="source">  function receive() {</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source">    /* jshint validthis:true */</td></tr><tr class="hit"><td class="line">117</td><td class="hits">34</td><td class="source">    self.receive.apply(null, arguments);</td></tr><tr class="hit"><td class="line">118</td><td class="hits">34</td><td class="source">    next(null, self.name);</td></tr><tr><td class="line">119</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">120</td><td class="hits">34</td><td class="source">  try {</td></tr><tr class="hit"><td class="line">121</td><td class="hits">34</td><td class="source">    this.send(receive);</td></tr><tr><td class="line">122</td><td class="hits"></td><td class="source">  } catch (err) {</td></tr><tr class="miss"><td class="line">123</td><td class="hits">0</td><td class="source">    process.nextTick(function () {</td></tr><tr class="miss"><td class="line">124</td><td class="hits">0</td><td class="source">      receive(err);</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source">    });</td></tr><tr><td class="line">126</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">127</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="util/bignum.js">util/bignum.js</h2><div id="stats" class="high"><div class="percentage">95%</div><div class="sloc">532</div><div class="hits">506</div><div class="misses">26</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">/* jshint bitwise:false */</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var zeropad = require('./zeropad');</td></tr><tr><td class="line">18</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var BASE = Math.pow(10, 7);</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var EXP_BIAS = 6176;</td></tr><tr><td class="line">22</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var INT_2_16 = Math.pow(2, 16);</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var INT_2_21 = Math.pow(2, 21);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var INT_2_32 = Math.pow(2, 32);</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">/* 2^32 = 429 4967296 */</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">var INT_2_32_0 = 4967296;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">var INT_2_32_1 = 429;</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">31</td><td class="hits"></td><td class="source">/* 2^53 = 90 0719925 4740992 */</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">var INT_2_53_0 = 4740992;</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">var INT_2_53_1 = 719925;</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">var INT_2_53_2 = 90;</td></tr><tr><td class="line">35</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">/* 2^64 = 184467 4407370 9551616 */</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">var INT_2_64_0 = 9551616;</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">var INT_2_64_1 = 4407370;</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">var INT_2_64_2 = 184467;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source">/* 10^7 for base 2^16 */</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">var BIN_10_7_0 = 38528;</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">var BIN_10_7_1 = 152;</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">/* 10^14 for base 2^16 */</td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">var BIN_10_14_0 = 16384;</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">var BIN_10_14_1 = 4218;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">var BIN_10_14_2 = 23283;</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">/* 10^21 for base 2^16 */</td></tr><tr class="hit"><td class="line">51</td><td class="hits">1</td><td class="source">var BIN_10_21_0 = 0;</td></tr><tr class="hit"><td class="line">52</td><td class="hits">1</td><td class="source">var BIN_10_21_1 = 56992;</td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">var BIN_10_21_2 = 44485;</td></tr><tr class="hit"><td class="line">54</td><td class="hits">1</td><td class="source">var BIN_10_21_3 = 13769;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">1</td><td class="source">var BIN_10_21_4 = 54;</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">/* 10^28 for base 2^16 */</td></tr><tr class="hit"><td class="line">58</td><td class="hits">1</td><td class="source">var BIN_10_28_0 = 0;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">1</td><td class="source">var BIN_10_28_1 = 4096;</td></tr><tr class="hit"><td class="line">60</td><td class="hits">1</td><td class="source">var BIN_10_28_2 = 609;</td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">var BIN_10_28_3 = 15909;</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">var BIN_10_28_4 = 52830;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">var BIN_10_28_5 = 8271;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source">/* 10^35 for base 2^16 */</td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">var BIN_10_35_0 = 0;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">var BIN_10_35_1 = 0;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">1</td><td class="source">var BIN_10_35_2 = 36840;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">1</td><td class="source">var BIN_10_35_3 = 11143;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">var BIN_10_35_4 = 19842;</td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">var BIN_10_35_5 = 29383;</td></tr><tr class="hit"><td class="line">72</td><td class="hits">1</td><td class="source">var BIN_10_35_6 = 16993;</td></tr><tr class="hit"><td class="line">73</td><td class="hits">1</td><td class="source">var BIN_10_35_7 = 19;</td></tr><tr><td class="line">74</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">function _readInt64(buffer, offset, unsigned) {</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">77</td><td class="hits">220</td><td class="source">  var x, y, s, y0, y1, x0, x1, x2;</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">79</td><td class="hits">220</td><td class="source">  x = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">80</td><td class="hits">220</td><td class="source">  x |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">81</td><td class="hits">220</td><td class="source">  x |= buffer[offset];</td></tr><tr class="hit"><td class="line">82</td><td class="hits">220</td><td class="source">  x += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">83</td><td class="hits">220</td><td class="source">  offset += 4;</td></tr><tr><td class="line">84</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">85</td><td class="hits">220</td><td class="source">  y = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">86</td><td class="hits">220</td><td class="source">  y |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">87</td><td class="hits">220</td><td class="source">  y |= buffer[offset];</td></tr><tr class="hit"><td class="line">88</td><td class="hits">220</td><td class="source">  y += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">90</td><td class="hits">220</td><td class="source">  if (!unsigned &amp;&amp; (y &amp; 0x80000000)) {</td></tr><tr class="hit"><td class="line">91</td><td class="hits">9</td><td class="source">    y = 0xffffffff - y;</td></tr><tr class="hit"><td class="line">92</td><td class="hits">9</td><td class="source">    if (x === 0) {</td></tr><tr class="hit"><td class="line">93</td><td class="hits">4</td><td class="source">      y += 1;</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">95</td><td class="hits">5</td><td class="source">      x = 0xffffffff - x + 1;</td></tr><tr><td class="line">96</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">97</td><td class="hits">9</td><td class="source">    s = -1;</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">99</td><td class="hits">211</td><td class="source">    s = 1;</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">102</td><td class="hits">220</td><td class="source">  if (y === 0) {</td></tr><tr class="hit"><td class="line">103</td><td class="hits">74</td><td class="source">    return s * x;</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">105</td><td class="hits">146</td><td class="source">  if (y &lt; INT_2_21 || (y === INT_2_21 &amp;&amp; x === 0)) {</td></tr><tr class="hit"><td class="line">106</td><td class="hits">13</td><td class="source">    return s * (y * INT_2_32 + x);</td></tr><tr><td class="line">107</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">109</td><td class="hits">133</td><td class="source">  if (x &lt; BASE) {</td></tr><tr class="hit"><td class="line">110</td><td class="hits">2</td><td class="source">    x0 = x % BASE;</td></tr><tr class="hit"><td class="line">111</td><td class="hits">2</td><td class="source">    x1 = 0;</td></tr><tr><td class="line">112</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">113</td><td class="hits">131</td><td class="source">    x0 = x % BASE;</td></tr><tr class="hit"><td class="line">114</td><td class="hits">131</td><td class="source">    x1 = Math.floor(x / BASE);</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">116</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">117</td><td class="hits">133</td><td class="source">  if (y &lt; BASE) {</td></tr><tr class="hit"><td class="line">118</td><td class="hits">2</td><td class="source">    y0 = y % BASE;</td></tr><tr class="hit"><td class="line">119</td><td class="hits">2</td><td class="source">    y1 = 0;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">121</td><td class="hits">131</td><td class="source">    y0 = y % BASE;</td></tr><tr class="hit"><td class="line">122</td><td class="hits">131</td><td class="source">    y1 = Math.floor(y / BASE);</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">124</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">125</td><td class="hits">133</td><td class="source">  x0 += y0 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">126</td><td class="hits">133</td><td class="source">  x1 += y0 * INT_2_32_1 + y1 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">127</td><td class="hits">133</td><td class="source">  x2 = y1 * INT_2_32_1;</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">129</td><td class="hits">133</td><td class="source">  if (x0 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">130</td><td class="hits">133</td><td class="source">    x1 += Math.floor(x0 / BASE);</td></tr><tr class="hit"><td class="line">131</td><td class="hits">133</td><td class="source">    x0 %= BASE;</td></tr><tr><td class="line">132</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">133</td><td class="hits">133</td><td class="source">  if (x1 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">134</td><td class="hits">133</td><td class="source">    x2 += Math.floor(x1 / BASE);</td></tr><tr class="hit"><td class="line">135</td><td class="hits">133</td><td class="source">    x1 %= BASE;</td></tr><tr><td class="line">136</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">137</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">138</td><td class="hits">133</td><td class="source">  if (s === 1) {</td></tr><tr class="hit"><td class="line">139</td><td class="hits">132</td><td class="source">    return '' + x2 + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">141</td><td class="hits">1</td><td class="source">  return '-' + x2 + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr><td class="line">142</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">144</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">145</td><td class="hits">1</td><td class="source">function isUInt64(value) {</td></tr><tr class="hit"><td class="line">146</td><td class="hits">9</td><td class="source">  if (typeof value === 'number') {</td></tr><tr class="hit"><td class="line">147</td><td class="hits">5</td><td class="source">    return true;</td></tr><tr><td class="line">148</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">149</td><td class="hits">4</td><td class="source">  if (value.length &lt; 20) {</td></tr><tr class="hit"><td class="line">150</td><td class="hits">2</td><td class="source">    return true;</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">152</td><td class="hits">2</td><td class="source">  if (value.length === 20 &amp;&amp; value &lt;= '18446744073709551616') {</td></tr><tr class="miss"><td class="line">153</td><td class="hits">0</td><td class="source">    return true;</td></tr><tr><td class="line">154</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">155</td><td class="hits">2</td><td class="source">  return false;</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">157</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">158</td><td class="hits">1</td><td class="source">function writeDec128(buffer, value, offset) {</td></tr><tr class="hit"><td class="line">159</td><td class="hits">9</td><td class="source">  offset = offset || 0;</td></tr><tr class="hit"><td class="line">160</td><td class="hits">9</td><td class="source">  buffer.fill(0x00, offset, offset + 16);</td></tr><tr><td class="line">161</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">162</td><td class="hits">9</td><td class="source">  if (isUInt64(value.m)) {</td></tr><tr class="hit"><td class="line">163</td><td class="hits">7</td><td class="source">    writeUInt64(buffer, value.m, offset);</td></tr><tr><td class="line">164</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">165</td><td class="hits">2</td><td class="source">    writeUInt128(buffer, value.m, offset);</td></tr><tr><td class="line">166</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">167</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">168</td><td class="hits">9</td><td class="source">  var e = EXP_BIAS + value.e;</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">9</td><td class="source">  var e0 = e &lt;&lt; 1;</td></tr><tr class="hit"><td class="line">171</td><td class="hits">9</td><td class="source">  e0 &amp;= 0xfe;</td></tr><tr class="hit"><td class="line">172</td><td class="hits">9</td><td class="source">  e0 |= buffer[offset + 14] &amp; 0x01;</td></tr><tr class="hit"><td class="line">173</td><td class="hits">9</td><td class="source">  buffer[offset + 14] = e0;</td></tr><tr><td class="line">174</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">175</td><td class="hits">9</td><td class="source">  var e1 = e &gt;&gt; 7;</td></tr><tr class="hit"><td class="line">176</td><td class="hits">9</td><td class="source">  if (value.s &lt; 0) {</td></tr><tr class="hit"><td class="line">177</td><td class="hits">2</td><td class="source">    e1 |= 0x80;</td></tr><tr><td class="line">178</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">179</td><td class="hits">9</td><td class="source">  buffer[offset + 15] = e1;</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">182</td><td class="hits">1</td><td class="source">function readDec128(buffer, offset) {</td></tr><tr><td class="line">183</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">184</td><td class="hits">39</td><td class="source">  var i, j, k, l, z0, z1, y0, y1, y2, x0, x1, x2, x3, x4;</td></tr><tr><td class="line">185</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">186</td><td class="hits">39</td><td class="source">  offset = offset || 0;</td></tr><tr><td class="line">187</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">188</td><td class="hits">39</td><td class="source">  if ((buffer[offset + 15] &amp; 0x70) === 0x70) {</td></tr><tr class="hit"><td class="line">189</td><td class="hits">5</td><td class="source">    return null;</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">191</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">192</td><td class="hits">34</td><td class="source">  i = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">193</td><td class="hits">34</td><td class="source">  i |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">194</td><td class="hits">34</td><td class="source">  i |= buffer[offset];</td></tr><tr class="hit"><td class="line">195</td><td class="hits">34</td><td class="source">  i += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">196</td><td class="hits">34</td><td class="source">  offset += 4;</td></tr><tr><td class="line">197</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">198</td><td class="hits">34</td><td class="source">  j = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">199</td><td class="hits">34</td><td class="source">  j |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">200</td><td class="hits">34</td><td class="source">  j |= buffer[offset];</td></tr><tr class="hit"><td class="line">201</td><td class="hits">34</td><td class="source">  j += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">202</td><td class="hits">34</td><td class="source">  offset += 4;</td></tr><tr><td class="line">203</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">204</td><td class="hits">34</td><td class="source">  k = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">205</td><td class="hits">34</td><td class="source">  k |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">206</td><td class="hits">34</td><td class="source">  k |= buffer[offset];</td></tr><tr class="hit"><td class="line">207</td><td class="hits">34</td><td class="source">  k += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">208</td><td class="hits">34</td><td class="source">  offset += 4;</td></tr><tr><td class="line">209</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">210</td><td class="hits">34</td><td class="source">  l = (buffer[offset + 2] &amp; 0x01) &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">211</td><td class="hits">34</td><td class="source">  l |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">212</td><td class="hits">34</td><td class="source">  l |= buffer[offset];</td></tr><tr class="hit"><td class="line">213</td><td class="hits">34</td><td class="source">  offset += 2;</td></tr><tr><td class="line">214</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">215</td><td class="hits">34</td><td class="source">  var dec = {</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source">    s: (buffer[offset + 1] &amp; 0x80) ? -1 : 1,</td></tr><tr><td class="line">217</td><td class="hits"></td><td class="source">    m: undefined,</td></tr><tr><td class="line">218</td><td class="hits"></td><td class="source">    e: ((((buffer[offset + 1] &lt;&lt; 8) | buffer[offset]) &amp; 0x7ffe) &gt;&gt; 1) -</td></tr><tr><td class="line">219</td><td class="hits"></td><td class="source">      EXP_BIAS</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">222</td><td class="hits">34</td><td class="source">  if (k === 0 &amp;&amp; l === 0) {</td></tr><tr class="hit"><td class="line">223</td><td class="hits">28</td><td class="source">    if (j === 0) {</td></tr><tr class="hit"><td class="line">224</td><td class="hits">25</td><td class="source">      dec.m = i;</td></tr><tr class="hit"><td class="line">225</td><td class="hits">25</td><td class="source">      return dec;</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">227</td><td class="hits">3</td><td class="source">    if (j &lt; INT_2_21 || (j === INT_2_21 &amp;&amp; i === 0)) {</td></tr><tr class="hit"><td class="line">228</td><td class="hits">2</td><td class="source">      dec.m = j * INT_2_32 + i;</td></tr><tr class="hit"><td class="line">229</td><td class="hits">2</td><td class="source">      return dec;</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">232</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">233</td><td class="hits">7</td><td class="source">  if (i &lt; BASE) {</td></tr><tr class="hit"><td class="line">234</td><td class="hits">1</td><td class="source">    x0 = i;</td></tr><tr class="hit"><td class="line">235</td><td class="hits">1</td><td class="source">    x1 = 0;</td></tr><tr><td class="line">236</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">237</td><td class="hits">6</td><td class="source">    x0 = i % BASE;</td></tr><tr class="hit"><td class="line">238</td><td class="hits">6</td><td class="source">    x1 = Math.floor(i / BASE);</td></tr><tr><td class="line">239</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">241</td><td class="hits">7</td><td class="source">  if (j &lt; BASE) {</td></tr><tr class="hit"><td class="line">242</td><td class="hits">1</td><td class="source">    x0 += j * INT_2_32_0;</td></tr><tr class="hit"><td class="line">243</td><td class="hits">1</td><td class="source">    x1 += j * INT_2_32_1;</td></tr><tr class="hit"><td class="line">244</td><td class="hits">1</td><td class="source">    x2 = 0;</td></tr><tr><td class="line">245</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">246</td><td class="hits">6</td><td class="source">    z0 = j % BASE;</td></tr><tr class="hit"><td class="line">247</td><td class="hits">6</td><td class="source">    z1 = Math.floor(j / BASE);</td></tr><tr class="hit"><td class="line">248</td><td class="hits">6</td><td class="source">    x0 += z0 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">249</td><td class="hits">6</td><td class="source">    x1 += z0 * INT_2_32_1 + z1 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">250</td><td class="hits">6</td><td class="source">    x2 = z1 * INT_2_32_1;</td></tr><tr><td class="line">251</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">252</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">253</td><td class="hits">7</td><td class="source">  if (k &lt; BASE) {</td></tr><tr class="hit"><td class="line">254</td><td class="hits">1</td><td class="source">    y0 = k;</td></tr><tr class="hit"><td class="line">255</td><td class="hits">1</td><td class="source">    y1 = 0;</td></tr><tr><td class="line">256</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">257</td><td class="hits">6</td><td class="source">    y0 = k % BASE;</td></tr><tr class="hit"><td class="line">258</td><td class="hits">6</td><td class="source">    y1 = Math.floor(k / BASE);</td></tr><tr><td class="line">259</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">260</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">261</td><td class="hits">7</td><td class="source">  if (l &lt; BASE) {</td></tr><tr class="hit"><td class="line">262</td><td class="hits">7</td><td class="source">    y0 += l * INT_2_32_0;</td></tr><tr class="hit"><td class="line">263</td><td class="hits">7</td><td class="source">    y1 += l * INT_2_32_1;</td></tr><tr class="hit"><td class="line">264</td><td class="hits">7</td><td class="source">    y2 = 0;</td></tr><tr><td class="line">265</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">266</td><td class="hits">0</td><td class="source">    z0 = l % BASE;</td></tr><tr class="miss"><td class="line">267</td><td class="hits">0</td><td class="source">    z1 = Math.floor(l / BASE);</td></tr><tr class="miss"><td class="line">268</td><td class="hits">0</td><td class="source">    y0 += z0 * INT_2_32_0;</td></tr><tr class="miss"><td class="line">269</td><td class="hits">0</td><td class="source">    y1 += z0 * INT_2_32_1 + z1 * INT_2_32_0;</td></tr><tr class="miss"><td class="line">270</td><td class="hits">0</td><td class="source">    y2 = z1 * INT_2_32_1;</td></tr><tr><td class="line">271</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">272</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">273</td><td class="hits">7</td><td class="source">  if (y0 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">274</td><td class="hits">6</td><td class="source">    y1 += Math.floor(y0 / BASE);</td></tr><tr class="hit"><td class="line">275</td><td class="hits">6</td><td class="source">    y0 %= BASE;</td></tr><tr><td class="line">276</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">277</td><td class="hits">7</td><td class="source">  if (y1 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">278</td><td class="hits">6</td><td class="source">    y2 += Math.floor(y1 / BASE);</td></tr><tr class="hit"><td class="line">279</td><td class="hits">6</td><td class="source">    y1 %= BASE;</td></tr><tr><td class="line">280</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">281</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">282</td><td class="hits">7</td><td class="source">  x0 += y0 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">283</td><td class="hits">7</td><td class="source">  x1 += y0 * INT_2_64_1 + y1 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">284</td><td class="hits">7</td><td class="source">  x2 += y0 * INT_2_64_2 + y1 * INT_2_64_1 + y2 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">285</td><td class="hits">7</td><td class="source">  x3 = y1 * INT_2_64_2 + y2 * INT_2_64_1;</td></tr><tr class="hit"><td class="line">286</td><td class="hits">7</td><td class="source">  x4 = y2 * INT_2_64_2;</td></tr><tr><td class="line">287</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">288</td><td class="hits">7</td><td class="source">  if (x0 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">289</td><td class="hits">7</td><td class="source">    x1 += Math.floor(x0 / BASE);</td></tr><tr class="hit"><td class="line">290</td><td class="hits">7</td><td class="source">    x0 %= BASE;</td></tr><tr><td class="line">291</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">292</td><td class="hits">7</td><td class="source">  if (x1 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">293</td><td class="hits">7</td><td class="source">    x2 += Math.floor(x1 / BASE);</td></tr><tr class="hit"><td class="line">294</td><td class="hits">7</td><td class="source">    x1 %= BASE;</td></tr><tr><td class="line">295</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">296</td><td class="hits">7</td><td class="source">  if (x2 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">297</td><td class="hits">6</td><td class="source">    x3 += Math.floor(x2 / BASE);</td></tr><tr class="hit"><td class="line">298</td><td class="hits">6</td><td class="source">    x2 %= BASE;</td></tr><tr><td class="line">299</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">300</td><td class="hits">7</td><td class="source">  if (x3 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">301</td><td class="hits">6</td><td class="source">    x4 += Math.floor(x3 / BASE);</td></tr><tr class="hit"><td class="line">302</td><td class="hits">6</td><td class="source">    x3 %= BASE;</td></tr><tr><td class="line">303</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">304</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">305</td><td class="hits">7</td><td class="source">  if (x4) {</td></tr><tr class="hit"><td class="line">306</td><td class="hits">6</td><td class="source">    dec.m = '' + x4 + zeropad.lpad14(x3 * BASE + x2) + zeropad.lpad14(x1 * BASE +</td></tr><tr><td class="line">307</td><td class="hits"></td><td class="source">      x0);</td></tr><tr class="hit"><td class="line">308</td><td class="hits">6</td><td class="source">    return dec;</td></tr><tr><td class="line">309</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">310</td><td class="hits">1</td><td class="source">  if (x3) {</td></tr><tr class="miss"><td class="line">311</td><td class="hits">0</td><td class="source">    dec.m = '' + (x3 * BASE + x2) + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr class="miss"><td class="line">312</td><td class="hits">0</td><td class="source">    return dec;</td></tr><tr><td class="line">313</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">314</td><td class="hits">1</td><td class="source">  if (x2) {</td></tr><tr class="hit"><td class="line">315</td><td class="hits">1</td><td class="source">    if (x2 &lt; INT_2_53_2 || (x2 === INT_2_53_2 &amp;&amp; (x1 &lt; INT_2_53_1 || (x1 ===</td></tr><tr><td class="line">316</td><td class="hits"></td><td class="source">      INT_2_53_1 &amp;&amp; x0 &lt;= INT_2_53_0)))) {</td></tr><tr class="miss"><td class="line">317</td><td class="hits">0</td><td class="source">      dec.m = (x2 * BASE + x1) * BASE + x0;</td></tr><tr class="miss"><td class="line">318</td><td class="hits">0</td><td class="source">      return dec;</td></tr><tr><td class="line">319</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">320</td><td class="hits">1</td><td class="source">    dec.m = '' + x2 + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr class="hit"><td class="line">321</td><td class="hits">1</td><td class="source">    return dec;</td></tr><tr><td class="line">322</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">323</td><td class="hits">0</td><td class="source">  dec.m = x1 * BASE + x0;</td></tr><tr class="miss"><td class="line">324</td><td class="hits">0</td><td class="source">  return dec;</td></tr><tr><td class="line">325</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">326</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">327</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">328</td><td class="hits">1</td><td class="source">function readDecFloat(buffer, offset) {</td></tr><tr class="hit"><td class="line">329</td><td class="hits">7</td><td class="source">  var value = readDec128(buffer, offset);</td></tr><tr class="hit"><td class="line">330</td><td class="hits">7</td><td class="source">  if (value === null) {</td></tr><tr class="hit"><td class="line">331</td><td class="hits">1</td><td class="source">    return null;</td></tr><tr><td class="line">332</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">333</td><td class="hits">6</td><td class="source">  var d, l, e;</td></tr><tr class="hit"><td class="line">334</td><td class="hits">6</td><td class="source">  d = '' + value.m;</td></tr><tr class="hit"><td class="line">335</td><td class="hits">6</td><td class="source">  l = d.length;</td></tr><tr class="hit"><td class="line">336</td><td class="hits">6</td><td class="source">  e = value.e + l - 1;</td></tr><tr class="hit"><td class="line">337</td><td class="hits">6</td><td class="source">  if (e &lt; 0) {</td></tr><tr class="hit"><td class="line">338</td><td class="hits">1</td><td class="source">    e = 'e' + e;</td></tr><tr><td class="line">339</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">340</td><td class="hits">5</td><td class="source">    e = 'e+' + e;</td></tr><tr><td class="line">341</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">342</td><td class="hits">6</td><td class="source">  while (d.charCodeAt(l - 1) === 48) {</td></tr><tr class="hit"><td class="line">343</td><td class="hits">5</td><td class="source">    l -= 1;</td></tr><tr><td class="line">344</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">345</td><td class="hits">6</td><td class="source">  if (l &gt; 1) {</td></tr><tr class="hit"><td class="line">346</td><td class="hits">2</td><td class="source">    d = d.substring(0, 1) + '.' + d.substring(1, l);</td></tr><tr><td class="line">347</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">348</td><td class="hits">6</td><td class="source">  if (value.s &lt; 0) {</td></tr><tr class="hit"><td class="line">349</td><td class="hits">2</td><td class="source">    return '-' + d + e;</td></tr><tr><td class="line">350</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">351</td><td class="hits">4</td><td class="source">  return d + e;</td></tr><tr><td class="line">352</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">353</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">354</td><td class="hits">1</td><td class="source">function readDecFixed(buffer, offset, frac) {</td></tr><tr class="hit"><td class="line">355</td><td class="hits">12</td><td class="source">  var value = readDec128(buffer, offset);</td></tr><tr class="hit"><td class="line">356</td><td class="hits">12</td><td class="source">  if (value === null) {</td></tr><tr class="hit"><td class="line">357</td><td class="hits">2</td><td class="source">    return null;</td></tr><tr><td class="line">358</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">359</td><td class="hits">10</td><td class="source">  frac = frac || 0;</td></tr><tr class="hit"><td class="line">360</td><td class="hits">10</td><td class="source">  var d, e, l, k, i, f;</td></tr><tr class="hit"><td class="line">361</td><td class="hits">10</td><td class="source">  d = '' + value.m;</td></tr><tr class="hit"><td class="line">362</td><td class="hits">10</td><td class="source">  e = value.e;</td></tr><tr class="hit"><td class="line">363</td><td class="hits">10</td><td class="source">  if (e &lt; 0) {</td></tr><tr class="hit"><td class="line">364</td><td class="hits">7</td><td class="source">    l = d.length;</td></tr><tr class="hit"><td class="line">365</td><td class="hits">7</td><td class="source">    k = l + e;</td></tr><tr class="hit"><td class="line">366</td><td class="hits">7</td><td class="source">    if (k &gt; 0) {</td></tr><tr class="hit"><td class="line">367</td><td class="hits">5</td><td class="source">      i = d.substring(0, k);</td></tr><tr class="hit"><td class="line">368</td><td class="hits">5</td><td class="source">      f = d.substring(k);</td></tr><tr class="hit"><td class="line">369</td><td class="hits">2</td><td class="source">    } else if (k &lt; 0) {</td></tr><tr class="hit"><td class="line">370</td><td class="hits">1</td><td class="source">      i = '0';</td></tr><tr class="hit"><td class="line">371</td><td class="hits">1</td><td class="source">      f = zeropad.ZEROS[-k] + d;</td></tr><tr><td class="line">372</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">373</td><td class="hits">1</td><td class="source">      i = '0';</td></tr><tr class="hit"><td class="line">374</td><td class="hits">1</td><td class="source">      f = d;</td></tr><tr><td class="line">375</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">376</td><td class="hits">3</td><td class="source">  } else if (e &gt; 0) {</td></tr><tr class="hit"><td class="line">377</td><td class="hits">1</td><td class="source">    i = d + zeropad.ZEROS[e];</td></tr><tr class="hit"><td class="line">378</td><td class="hits">1</td><td class="source">    f = '';</td></tr><tr><td class="line">379</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">380</td><td class="hits">2</td><td class="source">    i = d;</td></tr><tr class="hit"><td class="line">381</td><td class="hits">2</td><td class="source">    f = '';</td></tr><tr><td class="line">382</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">383</td><td class="hits">10</td><td class="source">  if (value.s &lt; 0) {</td></tr><tr class="hit"><td class="line">384</td><td class="hits">2</td><td class="source">    i = '-' + i;</td></tr><tr><td class="line">385</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">386</td><td class="hits">10</td><td class="source">  if (frac === 0) {</td></tr><tr class="hit"><td class="line">387</td><td class="hits">1</td><td class="source">    return i;</td></tr><tr><td class="line">388</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">389</td><td class="hits">9</td><td class="source">  l = f.length;</td></tr><tr class="hit"><td class="line">390</td><td class="hits">9</td><td class="source">  if (l &gt; frac) {</td></tr><tr class="hit"><td class="line">391</td><td class="hits">2</td><td class="source">    f = f.substring(0, frac);</td></tr><tr class="hit"><td class="line">392</td><td class="hits">7</td><td class="source">  } else if (l &lt; frac) {</td></tr><tr class="hit"><td class="line">393</td><td class="hits">5</td><td class="source">    f += zeropad.ZEROS[frac - l];</td></tr><tr><td class="line">394</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">395</td><td class="hits">9</td><td class="source">  return i + '.' + f;</td></tr><tr><td class="line">396</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">397</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">398</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">399</td><td class="hits">1</td><td class="source">function _writeInt64(buffer, value, offset, unsigned) {</td></tr><tr><td class="line">400</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">401</td><td class="hits">194</td><td class="source">  var l, x, a, b, c, x0, x1, y0, y1, z0, z1, z2, z3;</td></tr><tr><td class="line">402</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">403</td><td class="hits">194</td><td class="source">  var negative = false;</td></tr><tr><td class="line">404</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">405</td><td class="hits">194</td><td class="source">  if (typeof value === 'string') {</td></tr><tr><td class="line">406</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">407</td><td class="hits">131</td><td class="source">    l = value.length;</td></tr><tr><td class="line">408</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">409</td><td class="hits">131</td><td class="source">    if (l &gt; 15) {</td></tr><tr><td class="line">410</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">411</td><td class="hits">128</td><td class="source">      a = +value.substring(l - 7);</td></tr><tr class="hit"><td class="line">412</td><td class="hits">128</td><td class="source">      b = +value.substring(l - 14, l - 7);</td></tr><tr class="hit"><td class="line">413</td><td class="hits">128</td><td class="source">      c = +value.substring(0, l - 14);</td></tr><tr><td class="line">414</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">415</td><td class="hits">128</td><td class="source">      if (!unsigned &amp;&amp; c &lt; 0) {</td></tr><tr class="hit"><td class="line">416</td><td class="hits">1</td><td class="source">        c *= -1;</td></tr><tr class="hit"><td class="line">417</td><td class="hits">1</td><td class="source">        negative = true;</td></tr><tr><td class="line">418</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">419</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">420</td><td class="hits">128</td><td class="source">      z0 = a % INT_2_16;</td></tr><tr class="hit"><td class="line">421</td><td class="hits">128</td><td class="source">      z1 = Math.floor(a / INT_2_16);</td></tr><tr class="hit"><td class="line">422</td><td class="hits">128</td><td class="source">      z2 = z3 = 0;</td></tr><tr><td class="line">423</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">424</td><td class="hits">128</td><td class="source">      y0 = b % INT_2_16;</td></tr><tr class="hit"><td class="line">425</td><td class="hits">128</td><td class="source">      y1 = Math.floor(b / INT_2_16);</td></tr><tr><td class="line">426</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">427</td><td class="hits">128</td><td class="source">      z0 += y0 * BIN_10_7_0;</td></tr><tr class="hit"><td class="line">428</td><td class="hits">128</td><td class="source">      z1 += y0 * BIN_10_7_1 + y1 * BIN_10_7_0;</td></tr><tr class="hit"><td class="line">429</td><td class="hits">128</td><td class="source">      z2 += y1 * BIN_10_7_1;</td></tr><tr><td class="line">430</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">431</td><td class="hits">128</td><td class="source">      y0 = c % INT_2_16;</td></tr><tr class="hit"><td class="line">432</td><td class="hits">128</td><td class="source">      y1 = Math.floor(c / INT_2_16);</td></tr><tr><td class="line">433</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">434</td><td class="hits">128</td><td class="source">      z0 += y0 * BIN_10_14_0;</td></tr><tr class="hit"><td class="line">435</td><td class="hits">128</td><td class="source">      z1 += y0 * BIN_10_14_1 + y1 * BIN_10_14_0;</td></tr><tr class="hit"><td class="line">436</td><td class="hits">128</td><td class="source">      z2 += y0 * BIN_10_14_2 + y1 * BIN_10_14_1;</td></tr><tr class="hit"><td class="line">437</td><td class="hits">128</td><td class="source">      z3 += y1 * BIN_10_14_2;</td></tr><tr><td class="line">438</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">439</td><td class="hits">128</td><td class="source">      if (z0 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">440</td><td class="hits">128</td><td class="source">        z1 += Math.floor(z0 / INT_2_16);</td></tr><tr class="hit"><td class="line">441</td><td class="hits">128</td><td class="source">        z0 %= INT_2_16;</td></tr><tr><td class="line">442</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">443</td><td class="hits">128</td><td class="source">      if (z1 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">444</td><td class="hits">128</td><td class="source">        z2 += Math.floor(z1 / INT_2_16);</td></tr><tr class="hit"><td class="line">445</td><td class="hits">128</td><td class="source">        z1 %= INT_2_16;</td></tr><tr><td class="line">446</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">447</td><td class="hits">128</td><td class="source">      if (z2 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">448</td><td class="hits">128</td><td class="source">        z3 += Math.floor(z2 / INT_2_16);</td></tr><tr class="hit"><td class="line">449</td><td class="hits">128</td><td class="source">        z2 %= INT_2_16;</td></tr><tr><td class="line">450</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">451</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">452</td><td class="hits">128</td><td class="source">      x0 = z1 * INT_2_16 + z0;</td></tr><tr class="hit"><td class="line">453</td><td class="hits">128</td><td class="source">      x1 = z3 * INT_2_16 + z2;</td></tr><tr><td class="line">454</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">455</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">456</td><td class="hits">3</td><td class="source">      x = +value;</td></tr><tr><td class="line">457</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">458</td><td class="hits">3</td><td class="source">      if (!unsigned &amp;&amp; x &lt; 0) {</td></tr><tr class="miss"><td class="line">459</td><td class="hits">0</td><td class="source">        x *= -1;</td></tr><tr class="miss"><td class="line">460</td><td class="hits">0</td><td class="source">        negative = true;</td></tr><tr><td class="line">461</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">462</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">463</td><td class="hits">3</td><td class="source">      x0 = x % INT_2_32;</td></tr><tr class="hit"><td class="line">464</td><td class="hits">3</td><td class="source">      x1 = Math.floor(x / INT_2_32);</td></tr><tr><td class="line">465</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">466</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">467</td><td class="hits">63</td><td class="source">    x = value;</td></tr><tr><td class="line">468</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">469</td><td class="hits">63</td><td class="source">    if (!unsigned &amp;&amp; x &lt; 0) {</td></tr><tr class="hit"><td class="line">470</td><td class="hits">6</td><td class="source">      x *= -1;</td></tr><tr class="hit"><td class="line">471</td><td class="hits">6</td><td class="source">      negative = true;</td></tr><tr><td class="line">472</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">473</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">474</td><td class="hits">63</td><td class="source">    x0 = x % INT_2_32;</td></tr><tr class="hit"><td class="line">475</td><td class="hits">63</td><td class="source">    x1 = Math.floor(x / INT_2_32);</td></tr><tr><td class="line">476</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">477</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">478</td><td class="hits">194</td><td class="source">  if (negative) {</td></tr><tr class="hit"><td class="line">479</td><td class="hits">7</td><td class="source">    x1 = 0xffffffff - x1;</td></tr><tr class="hit"><td class="line">480</td><td class="hits">7</td><td class="source">    if (x0 === 0) {</td></tr><tr class="hit"><td class="line">481</td><td class="hits">3</td><td class="source">      x1 += 1;</td></tr><tr><td class="line">482</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">483</td><td class="hits">4</td><td class="source">      x0 = 0xffffffff - x0 + 1;</td></tr><tr><td class="line">484</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">485</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">486</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">487</td><td class="hits">194</td><td class="source">  buffer[offset + 3] = (x0 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">488</td><td class="hits">194</td><td class="source">  buffer[offset + 2] = (x0 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">489</td><td class="hits">194</td><td class="source">  buffer[offset + 1] = (x0 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">490</td><td class="hits">194</td><td class="source">  buffer[offset] = x0 &amp; 0xff;</td></tr><tr class="hit"><td class="line">491</td><td class="hits">194</td><td class="source">  offset += 4;</td></tr><tr><td class="line">492</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">493</td><td class="hits">194</td><td class="source">  buffer[offset + 3] = (x1 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">494</td><td class="hits">194</td><td class="source">  buffer[offset + 2] = (x1 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">495</td><td class="hits">194</td><td class="source">  buffer[offset + 1] = (x1 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">496</td><td class="hits">194</td><td class="source">  buffer[offset] = x1 &amp; 0xff;</td></tr><tr><td class="line">497</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">498</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">499</td><td class="hits">1</td><td class="source">function readUInt128(buffer, offset) {</td></tr><tr><td class="line">500</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">501</td><td class="hits">2</td><td class="source">  var i, j, k, l, z0, z1, y0, y1, y2, x0, x1, x2, x3, x4;</td></tr><tr><td class="line">502</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">503</td><td class="hits">2</td><td class="source">  offset = offset || 0;</td></tr><tr><td class="line">504</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">505</td><td class="hits">2</td><td class="source">  i = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">506</td><td class="hits">2</td><td class="source">  i |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">507</td><td class="hits">2</td><td class="source">  i |= buffer[offset];</td></tr><tr class="hit"><td class="line">508</td><td class="hits">2</td><td class="source">  i += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">509</td><td class="hits">2</td><td class="source">  offset += 4;</td></tr><tr><td class="line">510</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">511</td><td class="hits">2</td><td class="source">  j = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">512</td><td class="hits">2</td><td class="source">  j |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">513</td><td class="hits">2</td><td class="source">  j |= buffer[offset];</td></tr><tr class="hit"><td class="line">514</td><td class="hits">2</td><td class="source">  j += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">515</td><td class="hits">2</td><td class="source">  offset += 4;</td></tr><tr><td class="line">516</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">517</td><td class="hits">2</td><td class="source">  k = buffer[offset + 2] &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">518</td><td class="hits">2</td><td class="source">  k |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">519</td><td class="hits">2</td><td class="source">  k |= buffer[offset];</td></tr><tr class="hit"><td class="line">520</td><td class="hits">2</td><td class="source">  k += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr class="hit"><td class="line">521</td><td class="hits">2</td><td class="source">  offset += 4;</td></tr><tr><td class="line">522</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">523</td><td class="hits">2</td><td class="source">  l = (buffer[offset + 2]) &lt;&lt; 16;</td></tr><tr class="hit"><td class="line">524</td><td class="hits">2</td><td class="source">  l |= buffer[offset + 1] &lt;&lt; 8;</td></tr><tr class="hit"><td class="line">525</td><td class="hits">2</td><td class="source">  l |= buffer[offset];</td></tr><tr class="hit"><td class="line">526</td><td class="hits">2</td><td class="source">  l += buffer[offset + 3] &lt;&lt; 24 &gt;&gt;&gt; 0;</td></tr><tr><td class="line">527</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">528</td><td class="hits">2</td><td class="source">  if (k === 0 &amp;&amp; l === 0) {</td></tr><tr class="hit"><td class="line">529</td><td class="hits">1</td><td class="source">    if (j === 0) {</td></tr><tr class="miss"><td class="line">530</td><td class="hits">0</td><td class="source">      return i;</td></tr><tr><td class="line">531</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">532</td><td class="hits">1</td><td class="source">    if (j &lt; INT_2_21 || (j === INT_2_21 &amp;&amp; i === 0)) {</td></tr><tr class="miss"><td class="line">533</td><td class="hits">0</td><td class="source">      return j * INT_2_32 + i;</td></tr><tr><td class="line">534</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">535</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">536</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">537</td><td class="hits">2</td><td class="source">  if (i &lt; BASE) {</td></tr><tr class="miss"><td class="line">538</td><td class="hits">0</td><td class="source">    x0 = i;</td></tr><tr class="miss"><td class="line">539</td><td class="hits">0</td><td class="source">    x1 = 0;</td></tr><tr><td class="line">540</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">541</td><td class="hits">2</td><td class="source">    x0 = i % BASE;</td></tr><tr class="hit"><td class="line">542</td><td class="hits">2</td><td class="source">    x1 = Math.floor(i / BASE);</td></tr><tr><td class="line">543</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">544</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">545</td><td class="hits">2</td><td class="source">  if (j &lt; BASE) {</td></tr><tr class="miss"><td class="line">546</td><td class="hits">0</td><td class="source">    x0 += j * INT_2_32_0;</td></tr><tr class="miss"><td class="line">547</td><td class="hits">0</td><td class="source">    x1 += j * INT_2_32_1;</td></tr><tr class="miss"><td class="line">548</td><td class="hits">0</td><td class="source">    x2 = 0;</td></tr><tr><td class="line">549</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">550</td><td class="hits">2</td><td class="source">    z0 = j % BASE;</td></tr><tr class="hit"><td class="line">551</td><td class="hits">2</td><td class="source">    z1 = Math.floor(j / BASE);</td></tr><tr class="hit"><td class="line">552</td><td class="hits">2</td><td class="source">    x0 += z0 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">553</td><td class="hits">2</td><td class="source">    x1 += z0 * INT_2_32_1 + z1 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">554</td><td class="hits">2</td><td class="source">    x2 = z1 * INT_2_32_1;</td></tr><tr><td class="line">555</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">556</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">557</td><td class="hits">2</td><td class="source">  if (k &lt; BASE) {</td></tr><tr class="hit"><td class="line">558</td><td class="hits">1</td><td class="source">    y0 = k;</td></tr><tr class="hit"><td class="line">559</td><td class="hits">1</td><td class="source">    y1 = 0;</td></tr><tr><td class="line">560</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">561</td><td class="hits">1</td><td class="source">    y0 = k % BASE;</td></tr><tr class="hit"><td class="line">562</td><td class="hits">1</td><td class="source">    y1 = Math.floor(k / BASE);</td></tr><tr><td class="line">563</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">564</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">565</td><td class="hits">2</td><td class="source">  if (l &lt; BASE) {</td></tr><tr class="hit"><td class="line">566</td><td class="hits">1</td><td class="source">    y0 += l * INT_2_32_0;</td></tr><tr class="hit"><td class="line">567</td><td class="hits">1</td><td class="source">    y1 += l * INT_2_32_1;</td></tr><tr class="hit"><td class="line">568</td><td class="hits">1</td><td class="source">    y2 = 0;</td></tr><tr><td class="line">569</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">570</td><td class="hits">1</td><td class="source">    z0 = l % BASE;</td></tr><tr class="hit"><td class="line">571</td><td class="hits">1</td><td class="source">    z1 = Math.floor(l / BASE);</td></tr><tr class="hit"><td class="line">572</td><td class="hits">1</td><td class="source">    y0 += z0 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">573</td><td class="hits">1</td><td class="source">    y1 += z0 * INT_2_32_1 + z1 * INT_2_32_0;</td></tr><tr class="hit"><td class="line">574</td><td class="hits">1</td><td class="source">    y2 = z1 * INT_2_32_1;</td></tr><tr><td class="line">575</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">576</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">577</td><td class="hits">2</td><td class="source">  if (y0 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">578</td><td class="hits">1</td><td class="source">    y1 += Math.floor(y0 / BASE);</td></tr><tr class="hit"><td class="line">579</td><td class="hits">1</td><td class="source">    y0 %= BASE;</td></tr><tr><td class="line">580</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">581</td><td class="hits">2</td><td class="source">  if (y1 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">582</td><td class="hits">1</td><td class="source">    y2 += Math.floor(y1 / BASE);</td></tr><tr class="hit"><td class="line">583</td><td class="hits">1</td><td class="source">    y1 %= BASE;</td></tr><tr><td class="line">584</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">585</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">586</td><td class="hits">2</td><td class="source">  x0 += y0 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">587</td><td class="hits">2</td><td class="source">  x1 += y0 * INT_2_64_1 + y1 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">588</td><td class="hits">2</td><td class="source">  x2 += y0 * INT_2_64_2 + y1 * INT_2_64_1 + y2 * INT_2_64_0;</td></tr><tr class="hit"><td class="line">589</td><td class="hits">2</td><td class="source">  x3 = y1 * INT_2_64_2 + y2 * INT_2_64_1;</td></tr><tr class="hit"><td class="line">590</td><td class="hits">2</td><td class="source">  x4 = y2 * INT_2_64_2;</td></tr><tr><td class="line">591</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">592</td><td class="hits">2</td><td class="source">  if (x0 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">593</td><td class="hits">2</td><td class="source">    x1 += Math.floor(x0 / BASE);</td></tr><tr class="hit"><td class="line">594</td><td class="hits">2</td><td class="source">    x0 %= BASE;</td></tr><tr><td class="line">595</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">596</td><td class="hits">2</td><td class="source">  if (x1 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">597</td><td class="hits">2</td><td class="source">    x2 += Math.floor(x1 / BASE);</td></tr><tr class="hit"><td class="line">598</td><td class="hits">2</td><td class="source">    x1 %= BASE;</td></tr><tr><td class="line">599</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">600</td><td class="hits">2</td><td class="source">  if (x2 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">601</td><td class="hits">1</td><td class="source">    x3 += Math.floor(x2 / BASE);</td></tr><tr class="hit"><td class="line">602</td><td class="hits">1</td><td class="source">    x2 %= BASE;</td></tr><tr><td class="line">603</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">604</td><td class="hits">2</td><td class="source">  if (x3 &gt;= BASE) {</td></tr><tr class="hit"><td class="line">605</td><td class="hits">1</td><td class="source">    x4 += Math.floor(x3 / BASE);</td></tr><tr class="hit"><td class="line">606</td><td class="hits">1</td><td class="source">    x3 %= BASE;</td></tr><tr><td class="line">607</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">608</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">609</td><td class="hits">2</td><td class="source">  if (x4) {</td></tr><tr class="hit"><td class="line">610</td><td class="hits">1</td><td class="source">    return '' + x4 + zeropad.lpad14(x3 * BASE + x2) + zeropad.lpad14(x1 * BASE +</td></tr><tr><td class="line">611</td><td class="hits"></td><td class="source">      x0);</td></tr><tr><td class="line">612</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">613</td><td class="hits">1</td><td class="source">  if (x3) {</td></tr><tr class="miss"><td class="line">614</td><td class="hits">0</td><td class="source">    return '' + (x3 * BASE + x2) + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr><td class="line">615</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">616</td><td class="hits">1</td><td class="source">  if (x2) {</td></tr><tr class="hit"><td class="line">617</td><td class="hits">1</td><td class="source">    if (x2 &lt; INT_2_53_2 || (x2 === INT_2_53_2 &amp;&amp;</td></tr><tr><td class="line">618</td><td class="hits"></td><td class="source">      (x1 &lt; INT_2_53_1 || (x1 === INT_2_53_1 &amp;&amp; x0 &lt;= INT_2_53_0)))) {</td></tr><tr class="miss"><td class="line">619</td><td class="hits">0</td><td class="source">      return (x2 * BASE + x1) * BASE + x0;</td></tr><tr><td class="line">620</td><td class="hits"></td><td class="source">    }</td></tr><tr class="hit"><td class="line">621</td><td class="hits">1</td><td class="source">    return '' + x2 + zeropad.lpad14(x1 * BASE + x0);</td></tr><tr><td class="line">622</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">623</td><td class="hits"></td><td class="source">  }</td></tr><tr class="miss"><td class="line">624</td><td class="hits">0</td><td class="source">  return x1 * BASE + x0;</td></tr><tr><td class="line">625</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">626</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">627</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">628</td><td class="hits">1</td><td class="source">function writeUInt128(buffer, value, offset) {</td></tr><tr><td class="line">629</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">630</td><td class="hits">4</td><td class="source">  var l, a, b, c, d, e, f,</td></tr><tr><td class="line">631</td><td class="hits"></td><td class="source">    x0, x1, x2, x3, y0, y1, z0, z1, z2, z3, z4, z5, z6, z7;</td></tr><tr><td class="line">632</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">633</td><td class="hits">4</td><td class="source">  l = value.length;</td></tr><tr><td class="line">634</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">635</td><td class="hits">4</td><td class="source">  a = +value.substring(l - 7);</td></tr><tr class="hit"><td class="line">636</td><td class="hits">4</td><td class="source">  if (l &gt; 7) {</td></tr><tr class="hit"><td class="line">637</td><td class="hits">4</td><td class="source">    b = +value.substring(l - 14, l - 7);</td></tr><tr><td class="line">638</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">639</td><td class="hits">0</td><td class="source">    b = 0;</td></tr><tr><td class="line">640</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">641</td><td class="hits">4</td><td class="source">  if (l &gt; 14) {</td></tr><tr class="hit"><td class="line">642</td><td class="hits">4</td><td class="source">    c = +value.substring(l - 21, l - 14);</td></tr><tr><td class="line">643</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="miss"><td class="line">644</td><td class="hits">0</td><td class="source">    c = 0;</td></tr><tr><td class="line">645</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">646</td><td class="hits">4</td><td class="source">  if (l &gt; 21) {</td></tr><tr class="hit"><td class="line">647</td><td class="hits">3</td><td class="source">    d = +value.substring(l - 28, l - 21);</td></tr><tr><td class="line">648</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">649</td><td class="hits">1</td><td class="source">    d = 0;</td></tr><tr><td class="line">650</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">651</td><td class="hits">4</td><td class="source">  if (l &gt; 28) {</td></tr><tr class="hit"><td class="line">652</td><td class="hits">3</td><td class="source">    e = +value.substring(l - 35, l - 28);</td></tr><tr><td class="line">653</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">654</td><td class="hits">1</td><td class="source">    e = 0;</td></tr><tr><td class="line">655</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">656</td><td class="hits">4</td><td class="source">  if (l &gt; 35) {</td></tr><tr class="hit"><td class="line">657</td><td class="hits">1</td><td class="source">    f = +value.substring(0, l - 35);</td></tr><tr><td class="line">658</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">659</td><td class="hits">3</td><td class="source">    f = 0;</td></tr><tr><td class="line">660</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">661</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">662</td><td class="hits">4</td><td class="source">  z0 = z1 = z2 = z3 = z4 = z5 = z6 = z7 = 0;</td></tr><tr><td class="line">663</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">664</td><td class="hits"></td><td class="source">  // set a * 10^0</td></tr><tr class="hit"><td class="line">665</td><td class="hits">4</td><td class="source">  if (a) {</td></tr><tr class="hit"><td class="line">666</td><td class="hits">4</td><td class="source">    z0 = a % INT_2_16;</td></tr><tr class="hit"><td class="line">667</td><td class="hits">4</td><td class="source">    z1 = Math.floor(a / INT_2_16);</td></tr><tr><td class="line">668</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">669</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">670</td><td class="hits"></td><td class="source">  // add b * 10^7</td></tr><tr class="hit"><td class="line">671</td><td class="hits">4</td><td class="source">  if (b) {</td></tr><tr class="hit"><td class="line">672</td><td class="hits">4</td><td class="source">    y0 = b % INT_2_16;</td></tr><tr class="hit"><td class="line">673</td><td class="hits">4</td><td class="source">    y1 = Math.floor(b / INT_2_16);</td></tr><tr class="hit"><td class="line">674</td><td class="hits">4</td><td class="source">    z0 += y0 * BIN_10_7_0;</td></tr><tr class="hit"><td class="line">675</td><td class="hits">4</td><td class="source">    z1 += y0 * BIN_10_7_1 + y1 * BIN_10_7_0;</td></tr><tr class="hit"><td class="line">676</td><td class="hits">4</td><td class="source">    z2 += y1 * BIN_10_7_1;</td></tr><tr><td class="line">677</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">678</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">679</td><td class="hits"></td><td class="source">  // add c * 10^14</td></tr><tr class="hit"><td class="line">680</td><td class="hits">4</td><td class="source">  if (c) {</td></tr><tr class="hit"><td class="line">681</td><td class="hits">4</td><td class="source">    y0 = c % INT_2_16;</td></tr><tr class="hit"><td class="line">682</td><td class="hits">4</td><td class="source">    y1 = Math.floor(c / INT_2_16);</td></tr><tr class="hit"><td class="line">683</td><td class="hits">4</td><td class="source">    z0 += y0 * BIN_10_14_0;</td></tr><tr class="hit"><td class="line">684</td><td class="hits">4</td><td class="source">    z1 += y0 * BIN_10_14_1 + y1 * BIN_10_14_0;</td></tr><tr class="hit"><td class="line">685</td><td class="hits">4</td><td class="source">    z2 += y0 * BIN_10_14_2 + y1 * BIN_10_14_1;</td></tr><tr class="hit"><td class="line">686</td><td class="hits">4</td><td class="source">    z3 += y1 * BIN_10_14_2;</td></tr><tr><td class="line">687</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">688</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">689</td><td class="hits"></td><td class="source">  // add d * 10^21</td></tr><tr class="hit"><td class="line">690</td><td class="hits">4</td><td class="source">  if (d) {</td></tr><tr class="hit"><td class="line">691</td><td class="hits">3</td><td class="source">    y0 = d % INT_2_16;</td></tr><tr class="hit"><td class="line">692</td><td class="hits">3</td><td class="source">    y1 = Math.floor(d / INT_2_16);</td></tr><tr class="hit"><td class="line">693</td><td class="hits">3</td><td class="source">    z0 += y0 * BIN_10_21_0;</td></tr><tr class="hit"><td class="line">694</td><td class="hits">3</td><td class="source">    z1 += y0 * BIN_10_21_1 + y1 * BIN_10_21_0;</td></tr><tr class="hit"><td class="line">695</td><td class="hits">3</td><td class="source">    z2 += y0 * BIN_10_21_2 + y1 * BIN_10_21_1;</td></tr><tr class="hit"><td class="line">696</td><td class="hits">3</td><td class="source">    z3 += y0 * BIN_10_21_3 + y1 * BIN_10_21_2;</td></tr><tr class="hit"><td class="line">697</td><td class="hits">3</td><td class="source">    z4 += y0 * BIN_10_21_4 + y1 * BIN_10_21_3;</td></tr><tr class="hit"><td class="line">698</td><td class="hits">3</td><td class="source">    z5 += y1 * BIN_10_21_4;</td></tr><tr><td class="line">699</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">700</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">701</td><td class="hits"></td><td class="source">  // add e * 10^28</td></tr><tr class="hit"><td class="line">702</td><td class="hits">4</td><td class="source">  if (e) {</td></tr><tr class="hit"><td class="line">703</td><td class="hits">3</td><td class="source">    y0 = e % INT_2_16;</td></tr><tr class="hit"><td class="line">704</td><td class="hits">3</td><td class="source">    y1 = Math.floor(e / INT_2_16);</td></tr><tr class="hit"><td class="line">705</td><td class="hits">3</td><td class="source">    z0 += y0 * BIN_10_28_0;</td></tr><tr class="hit"><td class="line">706</td><td class="hits">3</td><td class="source">    z1 += y0 * BIN_10_28_1 + y1 * BIN_10_28_0;</td></tr><tr class="hit"><td class="line">707</td><td class="hits">3</td><td class="source">    z2 += y0 * BIN_10_28_2 + y1 * BIN_10_28_1;</td></tr><tr class="hit"><td class="line">708</td><td class="hits">3</td><td class="source">    z3 += y0 * BIN_10_28_3 + y1 * BIN_10_28_2;</td></tr><tr class="hit"><td class="line">709</td><td class="hits">3</td><td class="source">    z4 += y0 * BIN_10_28_4 + y1 * BIN_10_28_3;</td></tr><tr class="hit"><td class="line">710</td><td class="hits">3</td><td class="source">    z5 += y0 * BIN_10_28_5 + y1 * BIN_10_28_4;</td></tr><tr class="hit"><td class="line">711</td><td class="hits">3</td><td class="source">    z6 += y1 * BIN_10_28_5;</td></tr><tr><td class="line">712</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">713</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">714</td><td class="hits"></td><td class="source">  // add f * 10^35</td></tr><tr class="hit"><td class="line">715</td><td class="hits">4</td><td class="source">  if (f) {</td></tr><tr class="hit"><td class="line">716</td><td class="hits">1</td><td class="source">    y0 = f % INT_2_16;</td></tr><tr class="hit"><td class="line">717</td><td class="hits">1</td><td class="source">    z0 += y0 * BIN_10_35_0;</td></tr><tr class="hit"><td class="line">718</td><td class="hits">1</td><td class="source">    z1 += y0 * BIN_10_35_1;</td></tr><tr class="hit"><td class="line">719</td><td class="hits">1</td><td class="source">    z2 += y0 * BIN_10_35_2;</td></tr><tr class="hit"><td class="line">720</td><td class="hits">1</td><td class="source">    z3 += y0 * BIN_10_35_3;</td></tr><tr class="hit"><td class="line">721</td><td class="hits">1</td><td class="source">    z4 += y0 * BIN_10_35_4;</td></tr><tr class="hit"><td class="line">722</td><td class="hits">1</td><td class="source">    z5 += y0 * BIN_10_35_5;</td></tr><tr class="hit"><td class="line">723</td><td class="hits">1</td><td class="source">    z6 += y0 * BIN_10_35_6;</td></tr><tr class="hit"><td class="line">724</td><td class="hits">1</td><td class="source">    z7 += y0 * BIN_10_35_7;</td></tr><tr><td class="line">725</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">726</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">727</td><td class="hits">4</td><td class="source">  if (z0 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">728</td><td class="hits">4</td><td class="source">    z1 += Math.floor(z0 / INT_2_16);</td></tr><tr class="hit"><td class="line">729</td><td class="hits">4</td><td class="source">    z0 %= INT_2_16;</td></tr><tr><td class="line">730</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">731</td><td class="hits">4</td><td class="source">  if (z1 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">732</td><td class="hits">4</td><td class="source">    z2 += Math.floor(z1 / INT_2_16);</td></tr><tr class="hit"><td class="line">733</td><td class="hits">4</td><td class="source">    z1 %= INT_2_16;</td></tr><tr><td class="line">734</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">735</td><td class="hits">4</td><td class="source">  if (z2 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">736</td><td class="hits">4</td><td class="source">    z3 += Math.floor(z2 / INT_2_16);</td></tr><tr class="hit"><td class="line">737</td><td class="hits">4</td><td class="source">    z2 %= INT_2_16;</td></tr><tr><td class="line">738</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">739</td><td class="hits">4</td><td class="source">  if (z3 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">740</td><td class="hits">3</td><td class="source">    z4 += Math.floor(z3 / INT_2_16);</td></tr><tr class="hit"><td class="line">741</td><td class="hits">3</td><td class="source">    z3 %= INT_2_16;</td></tr><tr><td class="line">742</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">743</td><td class="hits">4</td><td class="source">  if (z4 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">744</td><td class="hits">3</td><td class="source">    z5 += Math.floor(z4 / INT_2_16);</td></tr><tr class="hit"><td class="line">745</td><td class="hits">3</td><td class="source">    z4 %= INT_2_16;</td></tr><tr><td class="line">746</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">747</td><td class="hits">4</td><td class="source">  if (z5 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">748</td><td class="hits">3</td><td class="source">    z6 += Math.floor(z5 / INT_2_16);</td></tr><tr class="hit"><td class="line">749</td><td class="hits">3</td><td class="source">    z5 %= INT_2_16;</td></tr><tr><td class="line">750</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">751</td><td class="hits">4</td><td class="source">  if (z6 &gt;= INT_2_16) {</td></tr><tr class="hit"><td class="line">752</td><td class="hits">3</td><td class="source">    z7 += Math.floor(z6 / INT_2_16);</td></tr><tr class="hit"><td class="line">753</td><td class="hits">3</td><td class="source">    z6 %= INT_2_16;</td></tr><tr><td class="line">754</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">755</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">756</td><td class="hits">4</td><td class="source">  x0 = z1 * INT_2_16 + z0;</td></tr><tr class="hit"><td class="line">757</td><td class="hits">4</td><td class="source">  x1 = z3 * INT_2_16 + z2;</td></tr><tr class="hit"><td class="line">758</td><td class="hits">4</td><td class="source">  x2 = z5 * INT_2_16 + z4;</td></tr><tr class="hit"><td class="line">759</td><td class="hits">4</td><td class="source">  x3 = z7 * INT_2_16 + z6;</td></tr><tr><td class="line">760</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">761</td><td class="hits">4</td><td class="source">  buffer[offset + 3] = (x0 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">762</td><td class="hits">4</td><td class="source">  buffer[offset + 2] = (x0 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">763</td><td class="hits">4</td><td class="source">  buffer[offset + 1] = (x0 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">764</td><td class="hits">4</td><td class="source">  buffer[offset] = x0 &amp; 0xff;</td></tr><tr class="hit"><td class="line">765</td><td class="hits">4</td><td class="source">  offset += 4;</td></tr><tr><td class="line">766</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">767</td><td class="hits">4</td><td class="source">  buffer[offset + 3] = (x1 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">768</td><td class="hits">4</td><td class="source">  buffer[offset + 2] = (x1 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">769</td><td class="hits">4</td><td class="source">  buffer[offset + 1] = (x1 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">770</td><td class="hits">4</td><td class="source">  buffer[offset] = x1 &amp; 0xff;</td></tr><tr class="hit"><td class="line">771</td><td class="hits">4</td><td class="source">  offset += 4;</td></tr><tr><td class="line">772</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">773</td><td class="hits">4</td><td class="source">  buffer[offset + 3] = (x2 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">774</td><td class="hits">4</td><td class="source">  buffer[offset + 2] = (x2 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">775</td><td class="hits">4</td><td class="source">  buffer[offset + 1] = (x2 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">776</td><td class="hits">4</td><td class="source">  buffer[offset] = x2 &amp; 0xff;</td></tr><tr class="hit"><td class="line">777</td><td class="hits">4</td><td class="source">  offset += 4;</td></tr><tr><td class="line">778</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">779</td><td class="hits">4</td><td class="source">  buffer[offset + 3] = (x3 &gt;&gt;&gt; 24) &amp; 0xff;</td></tr><tr class="hit"><td class="line">780</td><td class="hits">4</td><td class="source">  buffer[offset + 2] = (x3 &gt;&gt;&gt; 16) &amp; 0xff;</td></tr><tr class="hit"><td class="line">781</td><td class="hits">4</td><td class="source">  buffer[offset + 1] = (x3 &gt;&gt;&gt; 8) &amp; 0xff;</td></tr><tr class="hit"><td class="line">782</td><td class="hits">4</td><td class="source">  buffer[offset] = x3 &amp; 0xff;</td></tr><tr><td class="line">783</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">784</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">785</td><td class="hits">1</td><td class="source">function readInt64(buffer, offset) {</td></tr><tr class="hit"><td class="line">786</td><td class="hits">77</td><td class="source">  return _readInt64(buffer, offset || 0, false);</td></tr><tr><td class="line">787</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">788</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">789</td><td class="hits">1</td><td class="source">function readUInt64(buffer, offset) {</td></tr><tr class="hit"><td class="line">790</td><td class="hits">143</td><td class="source">  return _readInt64(buffer, offset || 0, true);</td></tr><tr><td class="line">791</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">792</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">793</td><td class="hits">1</td><td class="source">function writeInt64(buffer, value, offset) {</td></tr><tr class="hit"><td class="line">794</td><td class="hits">94</td><td class="source">  _writeInt64(buffer, value, offset || 0, false);</td></tr><tr><td class="line">795</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">796</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">797</td><td class="hits">1</td><td class="source">function writeUInt64(buffer, value, offset) {</td></tr><tr class="hit"><td class="line">798</td><td class="hits">100</td><td class="source">  _writeInt64(buffer, value, offset || 0, true);</td></tr><tr><td class="line">799</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">800</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">801</td><td class="hits">1</td><td class="source">exports.readInt64LE = readInt64;</td></tr><tr class="hit"><td class="line">802</td><td class="hits">1</td><td class="source">exports.readUInt64LE = readUInt64;</td></tr><tr class="hit"><td class="line">803</td><td class="hits">1</td><td class="source">exports.writeInt64LE = writeInt64;</td></tr><tr class="hit"><td class="line">804</td><td class="hits">1</td><td class="source">exports.writeUInt64LE = writeUInt64;</td></tr><tr class="hit"><td class="line">805</td><td class="hits">1</td><td class="source">exports.readUInt128LE = readUInt128;</td></tr><tr class="hit"><td class="line">806</td><td class="hits">1</td><td class="source">exports.writeUInt128LE = writeUInt128;</td></tr><tr class="hit"><td class="line">807</td><td class="hits">1</td><td class="source">exports.readDec128 = readDec128;</td></tr><tr class="hit"><td class="line">808</td><td class="hits">1</td><td class="source">exports.writeDec128 = writeDec128;</td></tr><tr class="hit"><td class="line">809</td><td class="hits">1</td><td class="source">exports.readDecFloat = readDecFloat;</td></tr><tr class="hit"><td class="line">810</td><td class="hits">1</td><td class="source">exports.readDecFixed = readDecFixed;</td></tr></tbody></table></div><div class="file"><h2 id="util/calendar.js">util/calendar.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">52</div><div class="hits">52</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">/* jshint bitwise:false */</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var zeropad = require('./zeropad');</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var lpad4 = zeropad.lpad4;</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var lpad2 = zeropad.lpad2;</td></tr><tr><td class="line">20</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var TURN_OF_ERAS = 1721424;</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var GREGORIAN = 2299161;</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">exports.DAYDATE = function DAYDATE(year, month, day) {</td></tr><tr class="hit"><td class="line">25</td><td class="hits">6</td><td class="source">  var A, B, C, E, F, Z;</td></tr><tr><td class="line">26</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">27</td><td class="hits">6</td><td class="source">  if (!month) {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">5</td><td class="source">    var date = year;</td></tr><tr class="hit"><td class="line">29</td><td class="hits">5</td><td class="source">    if (typeof date === 'string') {</td></tr><tr class="hit"><td class="line">30</td><td class="hits">4</td><td class="source">      month = +date.substring(5, 7);</td></tr><tr class="hit"><td class="line">31</td><td class="hits">4</td><td class="source">      day = +date.substring(8, 10);</td></tr><tr class="hit"><td class="line">32</td><td class="hits">4</td><td class="source">      year = +date.substring(0, 4);</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">    } else if (typeof date === 'object') {</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">      month = date.getUTCMonth() + 1;</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">      day = year.getUTCDate();</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">      year = year.getUTCFullYear();</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">    month += 1;</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">6</td><td class="source">  if (month &lt; 3) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">2</td><td class="source">    year -= 1;</td></tr><tr class="hit"><td class="line">44</td><td class="hits">2</td><td class="source">    month += 12;</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">47</td><td class="hits">6</td><td class="source">  if ((year &gt; 1582) ||</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">    (year === 1582 &amp;&amp; month &gt; 10) ||</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">    (year === 1582 &amp;&amp; month === 10 &amp;&amp; day &gt;= 15)) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">2</td><td class="source">    A = ~~ (year / 100);</td></tr><tr class="hit"><td class="line">51</td><td class="hits">2</td><td class="source">    B = ~~ (A / 4);</td></tr><tr class="hit"><td class="line">52</td><td class="hits">2</td><td class="source">    C = 2 - A + B;</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">4</td><td class="source">    C = 0;</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">56</td><td class="hits">6</td><td class="source">  E = ~~ (365.25 * (year + 4716));</td></tr><tr class="hit"><td class="line">57</td><td class="hits">6</td><td class="source">  F = ~~ (30.6001 * (month + 1));</td></tr><tr class="hit"><td class="line">58</td><td class="hits">6</td><td class="source">  Z = C + day + E + F - 1524;</td></tr><tr class="hit"><td class="line">59</td><td class="hits">6</td><td class="source">  return Z + 1 - TURN_OF_ERAS;</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">61</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">exports.DATE = function DATE(daydate) {</td></tr><tr class="hit"><td class="line">63</td><td class="hits">4</td><td class="source">  var Z, W, X, A, B, C, D, E, F, year, month, day;</td></tr><tr><td class="line">64</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">65</td><td class="hits">4</td><td class="source">  Z = ~~ (daydate - 1 + TURN_OF_ERAS);</td></tr><tr class="hit"><td class="line">66</td><td class="hits">4</td><td class="source">  if (Z &gt;= GREGORIAN) {</td></tr><tr class="hit"><td class="line">67</td><td class="hits">2</td><td class="source">    W = ~~ ((Z - 1867216.25) / 36524.25);</td></tr><tr class="hit"><td class="line">68</td><td class="hits">2</td><td class="source">    X = ~~ (W / 4);</td></tr><tr class="hit"><td class="line">69</td><td class="hits">2</td><td class="source">    A = Z + 1 + W - X;</td></tr><tr><td class="line">70</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">2</td><td class="source">    A = Z;</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">73</td><td class="hits">4</td><td class="source">  B = A + 1524;</td></tr><tr class="hit"><td class="line">74</td><td class="hits">4</td><td class="source">  C = ~~ ((B - 122.1) / 365.25);</td></tr><tr class="hit"><td class="line">75</td><td class="hits">4</td><td class="source">  D = ~~ (365.25 * C);</td></tr><tr class="hit"><td class="line">76</td><td class="hits">4</td><td class="source">  E = ~~ ((B - D) / 30.6001);</td></tr><tr class="hit"><td class="line">77</td><td class="hits">4</td><td class="source">  F = ~~ (30.6001 * E);</td></tr><tr class="hit"><td class="line">78</td><td class="hits">4</td><td class="source">  day = B - D - F;</td></tr><tr class="hit"><td class="line">79</td><td class="hits">4</td><td class="source">  month = E - 1;</td></tr><tr class="hit"><td class="line">80</td><td class="hits">4</td><td class="source">  if (month &gt; 12) {</td></tr><tr class="hit"><td class="line">81</td><td class="hits">2</td><td class="source">    month -= 12;</td></tr><tr><td class="line">82</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">83</td><td class="hits">4</td><td class="source">  if (month &lt; 3) {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">2</td><td class="source">    year = C - 4715;</td></tr><tr><td class="line">85</td><td class="hits"></td><td class="source">  } else {</td></tr><tr class="hit"><td class="line">86</td><td class="hits">2</td><td class="source">    year = C - 4716;</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">88</td><td class="hits">4</td><td class="source">  return lpad4(year) + '-' + lpad2(month) + '-' + lpad2(day);</td></tr><tr><td class="line">89</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div><div class="file"><h2 id="util/index.js">util/index.js</h2><div id="stats" class="high"><div class="percentage">83%</div><div class="sloc">134</div><div class="hits">112</div><div class="misses">22</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source">/* jshint camelcase:false */</td></tr><tr><td class="line">17</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var util = require('util');</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var stream = require('stream');</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var path = require('path');</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var os = require('os');</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var fs = require('fs');</td></tr><tr><td class="line">23</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">if (typeof setImmediate === 'undefined') {</td></tr><tr><td class="line">25</td><td class="hits"></td><td class="source">  // inoffical 0.8.x support</td></tr><tr class="miss"><td class="line">26</td><td class="hits">0</td><td class="source">  exports.setImmediate = process.nextTick;</td></tr><tr><td class="line">27</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">  exports.setImmediate = setImmediate;</td></tr><tr><td class="line">29</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">if (!stream.Readable) {</td></tr><tr><td class="line">32</td><td class="hits"></td><td class="source">  // inoffical 0.8.x support</td></tr><tr class="miss"><td class="line">33</td><td class="hits">0</td><td class="source">  stream = require('readable-stream');</td></tr><tr><td class="line">34</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">exports.stream = {</td></tr><tr><td class="line">36</td><td class="hits"></td><td class="source">  Readable: stream.Readable,</td></tr><tr><td class="line">37</td><td class="hits"></td><td class="source">  Writable: stream.Writable,</td></tr><tr><td class="line">38</td><td class="hits"></td><td class="source">  Duplex: stream.Duplex,</td></tr><tr><td class="line">39</td><td class="hits"></td><td class="source">  Transform: stream.Transform</td></tr><tr><td class="line">40</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">41</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">function exportNativeUtil(fn) {</td></tr><tr class="hit"><td class="line">43</td><td class="hits">12</td><td class="source">  exports[fn] = util[fn];</td></tr><tr><td class="line">44</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">46</td><td class="hits">1</td><td class="source">[</td></tr><tr><td class="line">47</td><td class="hits"></td><td class="source">  'format',</td></tr><tr><td class="line">48</td><td class="hits"></td><td class="source">  'debug',</td></tr><tr><td class="line">49</td><td class="hits"></td><td class="source">  'error',</td></tr><tr><td class="line">50</td><td class="hits"></td><td class="source">  'puts',</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">  'print',</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source">  'log',</td></tr><tr><td class="line">53</td><td class="hits"></td><td class="source">  'inspect',</td></tr><tr><td class="line">54</td><td class="hits"></td><td class="source">  'isArray',</td></tr><tr><td class="line">55</td><td class="hits"></td><td class="source">  'isRegExp',</td></tr><tr><td class="line">56</td><td class="hits"></td><td class="source">  'isDate',</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  'isError',</td></tr><tr><td class="line">58</td><td class="hits"></td><td class="source">  'inherits'</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">].forEach(exportNativeUtil);</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">exports.bignum = require('./bignum');</td></tr><tr class="hit"><td class="line">62</td><td class="hits">1</td><td class="source">exports.calendar = require('./calendar');</td></tr><tr class="hit"><td class="line">63</td><td class="hits">1</td><td class="source">exports.Queue = require('./Queue');</td></tr><tr class="hit"><td class="line">64</td><td class="hits">1</td><td class="source">extend(exports, require('./zeropad'));</td></tr><tr><td class="line">65</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">66</td><td class="hits">1</td><td class="source">var debuglog;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">1</td><td class="source">if (util.debuglog) {</td></tr><tr class="miss"><td class="line">68</td><td class="hits">0</td><td class="source">  debuglog = util.debuglog;</td></tr><tr><td class="line">69</td><td class="hits"></td><td class="source">} else {</td></tr><tr class="hit"><td class="line">70</td><td class="hits">1</td><td class="source">  try {</td></tr><tr class="hit"><td class="line">71</td><td class="hits">1</td><td class="source">    debuglog = require('debuglog');</td></tr><tr><td class="line">72</td><td class="hits"></td><td class="source">  } catch (err) {</td></tr><tr><td class="line">73</td><td class="hits"></td><td class="source">    /* jshint unused:false */</td></tr><tr class="miss"><td class="line">74</td><td class="hits">0</td><td class="source">    debuglog = function dbglg(name) {</td></tr><tr class="miss"><td class="line">75</td><td class="hits">0</td><td class="source">      return function () {};</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">    };</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">78</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">79</td><td class="hits">1</td><td class="source">exports.debuglog = debuglog;</td></tr><tr><td class="line">80</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">81</td><td class="hits">1</td><td class="source">var traceFunction;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">1</td><td class="source">exports.tracelog = function tracelog() {</td></tr><tr class="hit"><td class="line">83</td><td class="hits">1</td><td class="source">  if (typeof traceFunction !== 'function') {</td></tr><tr class="hit"><td class="line">84</td><td class="hits">1</td><td class="source">    if (process.env.HDB_TRACE) {</td></tr><tr class="miss"><td class="line">85</td><td class="hits">0</td><td class="source">      var timestamp = Math.floor(Date.now() / 1000);</td></tr><tr class="miss"><td class="line">86</td><td class="hits">0</td><td class="source">      var filename = path.join(os.tmpDir(), 'hdb.trace.' + timestamp + '.log');</td></tr><tr class="miss"><td class="line">87</td><td class="hits">0</td><td class="source">      console.log('Trace to file', filename);</td></tr><tr class="miss"><td class="line">88</td><td class="hits">0</td><td class="source">      traceFunction = function trace(kind, segment) {</td></tr><tr class="miss"><td class="line">89</td><td class="hits">0</td><td class="source">        fs.appendFileSync(filename,</td></tr><tr><td class="line">90</td><td class="hits"></td><td class="source">          kind + '\n' +</td></tr><tr><td class="line">91</td><td class="hits"></td><td class="source">          util.inspect(segment, {</td></tr><tr><td class="line">92</td><td class="hits"></td><td class="source">            depth: 9</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">          }));</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source">      };</td></tr><tr><td class="line">95</td><td class="hits"></td><td class="source">    } else {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">1</td><td class="source">      traceFunction = function trace() {};</td></tr><tr><td class="line">97</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">99</td><td class="hits">1</td><td class="source">  return traceFunction;</td></tr><tr><td class="line">100</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">101</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">102</td><td class="hits">1</td><td class="source">function extend(obj) {</td></tr><tr class="hit"><td class="line">103</td><td class="hits">115</td><td class="source">  function extendOnce(source) {</td></tr><tr><td class="line">104</td><td class="hits"></td><td class="source">    /* jshint forin:false */</td></tr><tr class="hit"><td class="line">105</td><td class="hits">115</td><td class="source">    if (source) {</td></tr><tr class="hit"><td class="line">106</td><td class="hits">71</td><td class="source">      for (var prop in source) {</td></tr><tr class="hit"><td class="line">107</td><td class="hits">177</td><td class="source">        obj[prop] = source[prop];</td></tr><tr><td class="line">108</td><td class="hits"></td><td class="source">      }</td></tr><tr><td class="line">109</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">110</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">111</td><td class="hits">115</td><td class="source">  Array.prototype.slice.call(arguments, 1).forEach(extendOnce);</td></tr><tr class="hit"><td class="line">112</td><td class="hits">115</td><td class="source">  return obj;</td></tr><tr><td class="line">113</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">114</td><td class="hits">1</td><td class="source">exports.extend = extend;</td></tr><tr><td class="line">115</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">116</td><td class="hits">1</td><td class="source">function isBoolean(arg) {</td></tr><tr class="hit"><td class="line">117</td><td class="hits">11</td><td class="source">  return typeof arg === 'boolean';</td></tr><tr><td class="line">118</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">119</td><td class="hits">1</td><td class="source">exports.isBoolean = isBoolean;</td></tr><tr><td class="line">120</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">121</td><td class="hits">1</td><td class="source">function isNumber(arg) {</td></tr><tr class="hit"><td class="line">122</td><td class="hits">110</td><td class="source">  return typeof arg === 'number';</td></tr><tr><td class="line">123</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">124</td><td class="hits">1</td><td class="source">exports.isNumber = isNumber;</td></tr><tr><td class="line">125</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">126</td><td class="hits">1</td><td class="source">function isString(arg) {</td></tr><tr class="hit"><td class="line">127</td><td class="hits">227</td><td class="source">  return typeof arg === 'string';</td></tr><tr><td class="line">128</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">129</td><td class="hits">1</td><td class="source">exports.isString = isString;</td></tr><tr><td class="line">130</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">131</td><td class="hits">1</td><td class="source">function isUndefined(arg) {</td></tr><tr class="hit"><td class="line">132</td><td class="hits">109</td><td class="source">  return arg === void 0;</td></tr><tr><td class="line">133</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">134</td><td class="hits">1</td><td class="source">exports.isUndefined = isUndefined;</td></tr><tr><td class="line">135</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">136</td><td class="hits">1</td><td class="source">function isObject(arg) {</td></tr><tr class="hit"><td class="line">137</td><td class="hits">89</td><td class="source">  return typeof arg === 'object' &amp;&amp; arg !== null;</td></tr><tr><td class="line">138</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">139</td><td class="hits">1</td><td class="source">exports.isObject = isObject;</td></tr><tr><td class="line">140</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">141</td><td class="hits">1</td><td class="source">function isFunction(arg) {</td></tr><tr class="hit"><td class="line">142</td><td class="hits">180</td><td class="source">  return typeof arg === 'function';</td></tr><tr><td class="line">143</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">144</td><td class="hits">1</td><td class="source">exports.isFunction = isFunction;</td></tr><tr><td class="line">145</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">146</td><td class="hits">1</td><td class="source">function alignLength(length, alignment) {</td></tr><tr class="hit"><td class="line">147</td><td class="hits">344</td><td class="source">  if (length % alignment === 0) {</td></tr><tr class="hit"><td class="line">148</td><td class="hits">178</td><td class="source">    return length;</td></tr><tr><td class="line">149</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">150</td><td class="hits">166</td><td class="source">  return length + alignment - length % alignment;</td></tr><tr><td class="line">151</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">152</td><td class="hits">1</td><td class="source">exports.alignLength = alignLength;</td></tr><tr><td class="line">153</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">154</td><td class="hits">1</td><td class="source">function cc2_(str) {</td></tr><tr class="miss"><td class="line">155</td><td class="hits">0</td><td class="source">  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toUpperCase();</td></tr><tr><td class="line">156</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">157</td><td class="hits">1</td><td class="source">exports.cc2_ = cc2_;</td></tr><tr><td class="line">158</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">159</td><td class="hits">1</td><td class="source">function _2cc(str) {</td></tr><tr class="hit"><td class="line">160</td><td class="hits">130</td><td class="source">  return str.toLowerCase().replace(/_([a-z])/g, function toUpperCase(match, str) {</td></tr><tr class="hit"><td class="line">161</td><td class="hits">201</td><td class="source">    return str.toUpperCase();</td></tr><tr><td class="line">162</td><td class="hits"></td><td class="source">  });</td></tr><tr><td class="line">163</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">164</td><td class="hits">1</td><td class="source">exports._2cc = _2cc;</td></tr><tr><td class="line">165</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">166</td><td class="hits">1</td><td class="source">function readData(ds, cb) {</td></tr><tr class="hit"><td class="line">167</td><td class="hits">4</td><td class="source">  var length = 0;</td></tr><tr class="hit"><td class="line">168</td><td class="hits">4</td><td class="source">  var chunks = [];</td></tr><tr><td class="line">169</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">170</td><td class="hits">4</td><td class="source">  function done(err) {</td></tr><tr class="hit"><td class="line">171</td><td class="hits">4</td><td class="source">    ds.removeListener('error', onerror);</td></tr><tr class="hit"><td class="line">172</td><td class="hits">4</td><td class="source">    ds.removeListener('data', ondata);</td></tr><tr class="hit"><td class="line">173</td><td class="hits">4</td><td class="source">    ds.removeListener('end', onend);</td></tr><tr class="hit"><td class="line">174</td><td class="hits">4</td><td class="source">    if (isFunction(cb)) {</td></tr><tr class="hit"><td class="line">175</td><td class="hits">4</td><td class="source">      if (err) {</td></tr><tr class="miss"><td class="line">176</td><td class="hits">0</td><td class="source">        return cb(err);</td></tr><tr><td class="line">177</td><td class="hits"></td><td class="source">      }</td></tr><tr class="hit"><td class="line">178</td><td class="hits">4</td><td class="source">      cb(null, Buffer.concat(chunks, length));</td></tr><tr><td class="line">179</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">180</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">181</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">182</td><td class="hits">4</td><td class="source">  function onerror(err) {</td></tr><tr class="miss"><td class="line">183</td><td class="hits">0</td><td class="source">    done(err);</td></tr><tr><td class="line">184</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">185</td><td class="hits">4</td><td class="source">  ds.on('error', onerror);</td></tr><tr><td class="line">186</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">187</td><td class="hits">4</td><td class="source">  function ondata(chunk) {</td></tr><tr class="hit"><td class="line">188</td><td class="hits">14</td><td class="source">    chunks.push(chunk);</td></tr><tr class="hit"><td class="line">189</td><td class="hits">14</td><td class="source">    length += chunk.length;</td></tr><tr><td class="line">190</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">191</td><td class="hits">4</td><td class="source">  ds.on('data', ondata);</td></tr><tr><td class="line">192</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">193</td><td class="hits">4</td><td class="source">  function onend() {</td></tr><tr class="hit"><td class="line">194</td><td class="hits">4</td><td class="source">    done(null);</td></tr><tr><td class="line">195</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">196</td><td class="hits">4</td><td class="source">  ds.on('end', onend);</td></tr><tr class="hit"><td class="line">197</td><td class="hits">4</td><td class="source">  ds.resume();</td></tr><tr><td class="line">198</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">199</td><td class="hits">1</td><td class="source">exports.readData = readData;</td></tr><tr><td class="line">200</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">201</td><td class="hits">1</td><td class="source">function proxyEvents(source, target, events) {</td></tr><tr><td class="line">202</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">203</td><td class="hits">22</td><td class="source">  function proxyEvent(ev) {</td></tr><tr class="hit"><td class="line">204</td><td class="hits">33</td><td class="source">    source.on(ev, target.emit.bind(target, ev));</td></tr><tr><td class="line">205</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">206</td><td class="hits">22</td><td class="source">  events.forEach(proxyEvent);</td></tr><tr class="hit"><td class="line">207</td><td class="hits">22</td><td class="source">  return target;</td></tr><tr><td class="line">208</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">209</td><td class="hits">1</td><td class="source">exports.proxyEvents = proxyEvents;</td></tr><tr><td class="line">210</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">211</td><td class="hits">1</td><td class="source">function createReadStream(ds, events, options) {</td></tr><tr class="hit"><td class="line">212</td><td class="hits">11</td><td class="source">  if (!util.isArray(events)) {</td></tr><tr class="miss"><td class="line">213</td><td class="hits">0</td><td class="source">    options = events;</td></tr><tr class="miss"><td class="line">214</td><td class="hits">0</td><td class="source">    events = ['error', 'close'];</td></tr><tr><td class="line">215</td><td class="hits"></td><td class="source">  }</td></tr><tr><td class="line">216</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">217</td><td class="hits">11</td><td class="source">  var readable = new stream.Readable(options);</td></tr><tr class="hit"><td class="line">218</td><td class="hits">11</td><td class="source">  readable._read = function _read() {</td></tr><tr class="hit"><td class="line">219</td><td class="hits">19</td><td class="source">    ds.resume();</td></tr><tr><td class="line">220</td><td class="hits"></td><td class="source">  };</td></tr><tr><td class="line">221</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">222</td><td class="hits">11</td><td class="source">  function onend() {</td></tr><tr class="hit"><td class="line">223</td><td class="hits">11</td><td class="source">    readable.push(null);</td></tr><tr><td class="line">224</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">225</td><td class="hits">11</td><td class="source">  ds.once('end', onend);</td></tr><tr><td class="line">226</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">227</td><td class="hits">11</td><td class="source">  function ondata(chunk) {</td></tr><tr class="hit"><td class="line">228</td><td class="hits">14</td><td class="source">    if (!chunk || !chunk.length) {</td></tr><tr class="miss"><td class="line">229</td><td class="hits">0</td><td class="source">      return;</td></tr><tr><td class="line">230</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">231</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">232</td><td class="hits">14</td><td class="source">    if (!readable.push(chunk)) {</td></tr><tr class="miss"><td class="line">233</td><td class="hits">0</td><td class="source">      ds.pause();</td></tr><tr><td class="line">234</td><td class="hits"></td><td class="source">    }</td></tr><tr><td class="line">235</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">236</td><td class="hits">11</td><td class="source">  ds.on('data', ondata);</td></tr><tr><td class="line">237</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">238</td><td class="hits">11</td><td class="source">  proxyEvents(ds, readable, events);</td></tr><tr class="hit"><td class="line">239</td><td class="hits">11</td><td class="source">  return readable;</td></tr><tr><td class="line">240</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">241</td><td class="hits">1</td><td class="source">exports.createReadStream = createReadStream;</td></tr><tr><td class="line">242</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">243</td><td class="hits">1</td><td class="source">function pipe(source, target, events) {</td></tr><tr class="hit"><td class="line">244</td><td class="hits">11</td><td class="source">  proxyEvents(source, target, events || ['error']);</td></tr><tr class="hit"><td class="line">245</td><td class="hits">11</td><td class="source">  return source.pipe(target);</td></tr><tr><td class="line">246</td><td class="hits"></td><td class="source">}</td></tr><tr class="hit"><td class="line">247</td><td class="hits">1</td><td class="source">exports.pipe = pipe;</td></tr><tr><td class="line">248</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">249</td><td class="hits">1</td><td class="source">function createReadableBuffer(buffer, options) {</td></tr><tr class="miss"><td class="line">250</td><td class="hits">0</td><td class="source">  options = options || {};</td></tr><tr class="miss"><td class="line">251</td><td class="hits">0</td><td class="source">  var readable = new stream.Readable(options);</td></tr><tr class="miss"><td class="line">252</td><td class="hits">0</td><td class="source">  readable.push(buffer);</td></tr><tr class="miss"><td class="line">253</td><td class="hits">0</td><td class="source">  readable.push(null);</td></tr><tr class="miss"><td class="line">254</td><td class="hits">0</td><td class="source">  return readable;</td></tr><tr><td class="line">255</td><td class="hits"></td><td class="source">}</td></tr></tbody></table></div><div class="file"><h2 id="util/zeropad.js">util/zeropad.js</h2><div id="stats" class="high"><div class="percentage">100%</div><div class="sloc">68</div><div class="hits">68</div><div class="misses">0</div></div><table id="source"><thead><tr><th>Line</th><th>Hits</th><th>Source</th></tr></thead><tbody><tr><td class="line">1</td><td class="hits"></td><td class="source">// Copyright 2013 SAP AG.</td></tr><tr><td class="line">2</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">3</td><td class="hits"></td><td class="source">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</td></tr><tr><td class="line">4</td><td class="hits"></td><td class="source">// you may not use this file except in compliance with the License.</td></tr><tr><td class="line">5</td><td class="hits"></td><td class="source">// You may obtain a copy of the License at</td></tr><tr><td class="line">6</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">7</td><td class="hits"></td><td class="source">// http: //www.apache.org/licenses/LICENSE-2.0</td></tr><tr><td class="line">8</td><td class="hits"></td><td class="source">//</td></tr><tr><td class="line">9</td><td class="hits"></td><td class="source">// Unless required by applicable law or agreed to in writing,</td></tr><tr><td class="line">10</td><td class="hits"></td><td class="source">// software distributed under the License is distributed on an</td></tr><tr><td class="line">11</td><td class="hits"></td><td class="source">// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,</td></tr><tr><td class="line">12</td><td class="hits"></td><td class="source">// either express or implied. See the License for the specific</td></tr><tr><td class="line">13</td><td class="hits"></td><td class="source">// language governing permissions and limitations under the License.</td></tr><tr class="hit"><td class="line">14</td><td class="hits">1</td><td class="source">'use strict';</td></tr><tr><td class="line">15</td><td class="hits"></td><td class="source">/* jshint curly: false */</td></tr><tr><td class="line">16</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">17</td><td class="hits">1</td><td class="source">var INT_10_1 = Math.pow(10, 1);</td></tr><tr class="hit"><td class="line">18</td><td class="hits">1</td><td class="source">var INT_10_2 = Math.pow(10, 2);</td></tr><tr class="hit"><td class="line">19</td><td class="hits">1</td><td class="source">var INT_10_3 = Math.pow(10, 3);</td></tr><tr class="hit"><td class="line">20</td><td class="hits">1</td><td class="source">var INT_10_4 = Math.pow(10, 4);</td></tr><tr class="hit"><td class="line">21</td><td class="hits">1</td><td class="source">var INT_10_5 = Math.pow(10, 5);</td></tr><tr class="hit"><td class="line">22</td><td class="hits">1</td><td class="source">var INT_10_6 = Math.pow(10, 6);</td></tr><tr class="hit"><td class="line">23</td><td class="hits">1</td><td class="source">var INT_10_7 = Math.pow(10, 7);</td></tr><tr class="hit"><td class="line">24</td><td class="hits">1</td><td class="source">var INT_10_8 = Math.pow(10, 8);</td></tr><tr class="hit"><td class="line">25</td><td class="hits">1</td><td class="source">var INT_10_9 = Math.pow(10, 9);</td></tr><tr class="hit"><td class="line">26</td><td class="hits">1</td><td class="source">var INT_10_10 = Math.pow(10, 10);</td></tr><tr class="hit"><td class="line">27</td><td class="hits">1</td><td class="source">var INT_10_11 = Math.pow(10, 11);</td></tr><tr class="hit"><td class="line">28</td><td class="hits">1</td><td class="source">var INT_10_12 = Math.pow(10, 12);</td></tr><tr class="hit"><td class="line">29</td><td class="hits">1</td><td class="source">var INT_10_13 = Math.pow(10, 13);</td></tr><tr><td class="line">30</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">31</td><td class="hits">1</td><td class="source">var ZERO_0 = '';</td></tr><tr class="hit"><td class="line">32</td><td class="hits">1</td><td class="source">var ZERO_1 = '0';</td></tr><tr class="hit"><td class="line">33</td><td class="hits">1</td><td class="source">var ZERO_2 = '00';</td></tr><tr class="hit"><td class="line">34</td><td class="hits">1</td><td class="source">var ZERO_3 = '000';</td></tr><tr class="hit"><td class="line">35</td><td class="hits">1</td><td class="source">var ZERO_4 = '0000';</td></tr><tr class="hit"><td class="line">36</td><td class="hits">1</td><td class="source">var ZERO_5 = '00000';</td></tr><tr class="hit"><td class="line">37</td><td class="hits">1</td><td class="source">var ZERO_6 = '000000';</td></tr><tr class="hit"><td class="line">38</td><td class="hits">1</td><td class="source">var ZERO_7 = '0000000';</td></tr><tr class="hit"><td class="line">39</td><td class="hits">1</td><td class="source">var ZERO_8 = '00000000';</td></tr><tr class="hit"><td class="line">40</td><td class="hits">1</td><td class="source">var ZERO_9 = '000000000';</td></tr><tr class="hit"><td class="line">41</td><td class="hits">1</td><td class="source">var ZERO_10 = '0000000000';</td></tr><tr class="hit"><td class="line">42</td><td class="hits">1</td><td class="source">var ZERO_11 = '00000000000';</td></tr><tr class="hit"><td class="line">43</td><td class="hits">1</td><td class="source">var ZERO_12 = '000000000000';</td></tr><tr class="hit"><td class="line">44</td><td class="hits">1</td><td class="source">var ZERO_13 = '0000000000000';</td></tr><tr><td class="line">45</td><td class="hits"></td><td class="source"> </td></tr><tr><td class="line">46</td><td class="hits"></td><td class="source">/* Decimal zero padding */</td></tr><tr class="hit"><td class="line">47</td><td class="hits">1</td><td class="source">var MAX_DECIMAL_LENGTH = 35;</td></tr><tr class="hit"><td class="line">48</td><td class="hits">1</td><td class="source">var ZEROS = exports.ZEROS = [''];</td></tr><tr class="hit"><td class="line">49</td><td class="hits">1</td><td class="source">for (var i = 1; i &lt; MAX_DECIMAL_LENGTH; i++) {</td></tr><tr class="hit"><td class="line">50</td><td class="hits">34</td><td class="source">  ZEROS.push(ZEROS[i - 1] + '0');</td></tr><tr><td class="line">51</td><td class="hits"></td><td class="source">}</td></tr><tr><td class="line">52</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">53</td><td class="hits">1</td><td class="source">exports.lpad = function lpad(length, n) {</td></tr><tr class="hit"><td class="line">54</td><td class="hits">5</td><td class="source">  var z = '' + n;</td></tr><tr class="hit"><td class="line">55</td><td class="hits">5</td><td class="source">  while (z.length &lt; length) {</td></tr><tr class="hit"><td class="line">56</td><td class="hits">4</td><td class="source">    z = ZEROS[Math.min(length - z.length, MAX_DECIMAL_LENGTH - 1)] + z;</td></tr><tr><td class="line">57</td><td class="hits"></td><td class="source">  }</td></tr><tr class="hit"><td class="line">58</td><td class="hits">5</td><td class="source">  return z;</td></tr><tr><td class="line">59</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">60</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">61</td><td class="hits">1</td><td class="source">exports.lpad14 = function lpad14(n) {</td></tr><tr class="hit"><td class="line">62</td><td class="hits">308</td><td class="source">  if (n &gt;= INT_10_13) return ZERO_0 + n;</td></tr><tr class="hit"><td class="line">63</td><td class="hits">24</td><td class="source">  if (n &gt;= INT_10_12) return ZERO_1 + n;</td></tr><tr class="hit"><td class="line">64</td><td class="hits">13</td><td class="source">  if (n &gt;= INT_10_11) return ZERO_2 + n;</td></tr><tr class="hit"><td class="line">65</td><td class="hits">12</td><td class="source">  if (n &gt;= INT_10_10) return ZERO_3 + n;</td></tr><tr class="hit"><td class="line">66</td><td class="hits">11</td><td class="source">  if (n &gt;= INT_10_9) return ZERO_4 + n;</td></tr><tr class="hit"><td class="line">67</td><td class="hits">10</td><td class="source">  if (n &gt;= INT_10_8) return ZERO_5 + n;</td></tr><tr class="hit"><td class="line">68</td><td class="hits">9</td><td class="source">  if (n &gt;= INT_10_7) return ZERO_6 + n;</td></tr><tr class="hit"><td class="line">69</td><td class="hits">8</td><td class="source">  if (n &gt;= INT_10_6) return ZERO_7 + n;</td></tr><tr class="hit"><td class="line">70</td><td class="hits">7</td><td class="source">  if (n &gt;= INT_10_5) return ZERO_8 + n;</td></tr><tr class="hit"><td class="line">71</td><td class="hits">6</td><td class="source">  if (n &gt;= INT_10_4) return ZERO_9 + n;</td></tr><tr class="hit"><td class="line">72</td><td class="hits">5</td><td class="source">  if (n &gt;= INT_10_3) return ZERO_10 + n;</td></tr><tr class="hit"><td class="line">73</td><td class="hits">4</td><td class="source">  if (n &gt;= INT_10_2) return ZERO_11 + n;</td></tr><tr class="hit"><td class="line">74</td><td class="hits">3</td><td class="source">  if (n &gt;= INT_10_1) return ZERO_12 + n;</td></tr><tr class="hit"><td class="line">75</td><td class="hits">1</td><td class="source">  return ZERO_13 + n;</td></tr><tr><td class="line">76</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">77</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">78</td><td class="hits">1</td><td class="source">exports.lpad7 = function lpad7(n) {</td></tr><tr class="hit"><td class="line">79</td><td class="hits">8</td><td class="source">  if (n &gt;= INT_10_6) return ZERO_0 + n;</td></tr><tr class="hit"><td class="line">80</td><td class="hits">7</td><td class="source">  if (n &gt;= INT_10_5) return ZERO_1 + n;</td></tr><tr class="hit"><td class="line">81</td><td class="hits">6</td><td class="source">  if (n &gt;= INT_10_4) return ZERO_2 + n;</td></tr><tr class="hit"><td class="line">82</td><td class="hits">5</td><td class="source">  if (n &gt;= INT_10_3) return ZERO_3 + n;</td></tr><tr class="hit"><td class="line">83</td><td class="hits">4</td><td class="source">  if (n &gt;= INT_10_2) return ZERO_4 + n;</td></tr><tr class="hit"><td class="line">84</td><td class="hits">3</td><td class="source">  if (n &gt;= INT_10_1) return ZERO_5 + n;</td></tr><tr class="hit"><td class="line">85</td><td class="hits">1</td><td class="source">  return ZERO_6 + n;</td></tr><tr><td class="line">86</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">87</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">88</td><td class="hits">1</td><td class="source">exports.lpad4 = function lpad4(n) {</td></tr><tr class="hit"><td class="line">89</td><td class="hits">19</td><td class="source">  if (n &gt;= INT_10_3) return ZERO_0 + n;</td></tr><tr class="hit"><td class="line">90</td><td class="hits">6</td><td class="source">  if (n &gt;= INT_10_2) return ZERO_1 + n;</td></tr><tr class="hit"><td class="line">91</td><td class="hits">5</td><td class="source">  if (n &gt;= INT_10_1) return ZERO_2 + n;</td></tr><tr class="hit"><td class="line">92</td><td class="hits">3</td><td class="source">  return ZERO_3 + n;</td></tr><tr><td class="line">93</td><td class="hits"></td><td class="source">};</td></tr><tr><td class="line">94</td><td class="hits"></td><td class="source"> </td></tr><tr class="hit"><td class="line">95</td><td class="hits">1</td><td class="source">exports.lpad2 = function lpad2(n) {</td></tr><tr class="hit"><td class="line">96</td><td class="hits">34</td><td class="source">  if (n &gt;= INT_10_1) return ZERO_0 + n;</td></tr><tr class="hit"><td class="line">97</td><td class="hits">20</td><td class="source">  return ZERO_1 + n;</td></tr><tr><td class="line">98</td><td class="hits"></td><td class="source">};</td></tr></tbody></table></div></div></div></body></html>